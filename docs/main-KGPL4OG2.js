import{a as De,b as It,c as cd,d as x,e as zy,f as Fa,g as Gy,h as Wy,i as Ky,j as ld,k as Qy,l as Zo,m as dd,n as La,o as Yy,p as Zy,q as hd,r as Ne,s as Cr,t as Xt,u as Va,v as Jo,w as Jy,x as Xy,y as zn,z as Et}from"./chunk-4ZHOUZTK.js";var pd=null;var fd=1,ev=Symbol("SIGNAL");function me(n){let e=pd;return pd=n,e}function tv(){return pd}var gd={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function MC(n){if(!(wd(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===fd)){if(!n.producerMustRecompute(n)&&!yd(n)){n.dirty=!1,n.lastCleanEpoch=fd;return}n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=fd}}function md(n){return n&&(n.nextProducerIndex=0),me(n)}function nv(n,e){if(me(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(wd(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)_d(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function yd(n){Id(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(MC(t),r!==t.version))return!0}return!1}function vd(n){if(Id(n),wd(n))for(let e=0;e<n.producerNode.length;e++)_d(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function _d(n,e){if(NC(n),n.liveConsumerNode.length===1&&RC(n))for(let r=0;r<n.producerNode.length;r++)_d(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];Id(i),i.producerIndexOfThis[r]=e}}function wd(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function Id(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function NC(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function RC(n){return n.producerNode!==void 0}function PC(){throw new Error}var kC=PC;function rv(n){kC=n}function re(n){return typeof n=="function"}function vi(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var ja=vi(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function br(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Qe=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(re(r))try{r()}catch(o){e=o instanceof ja?o.errors:[o]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let o of i)try{iv(o)}catch(s){e=e??[],s instanceof ja?e=[...e,...s.errors]:e.push(s)}}if(e)throw new ja(e)}}add(e){var t;if(e&&e!==this)if(this.closed)iv(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&br(t,e)}remove(e){let{_finalizers:t}=this;t&&br(t,e),e instanceof n&&e._removeParent(this)}};Qe.EMPTY=(()=>{let n=new Qe;return n.closed=!0,n})();var Ed=Qe.EMPTY;function Ba(n){return n instanceof Qe||n&&"closed"in n&&re(n.remove)&&re(n.add)&&re(n.unsubscribe)}function iv(n){re(n)?n():n.unsubscribe()}var Vt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var _i={setTimeout(n,e,...t){let{delegate:r}=_i;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=_i;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Ua(n){_i.setTimeout(()=>{let{onUnhandledError:e}=Vt;if(e)e(n);else throw n})}function Dd(){}var ov=Td("C",void 0,void 0);function sv(n){return Td("E",void 0,n)}function av(n){return Td("N",n,void 0)}function Td(n,e,t){return{kind:n,value:e,error:t}}var Sr=null;function wi(n){if(Vt.useDeprecatedSynchronousErrorHandling){let e=!Sr;if(e&&(Sr={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=Sr;if(Sr=null,t)throw r}}else n()}function uv(n){Vt.useDeprecatedSynchronousErrorHandling&&Sr&&(Sr.errorThrown=!0,Sr.error=n)}var Ar=class extends Qe{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Ba(e)&&e.add(this)):this.destination=LC}static create(e,t,r){return new In(e,t,r)}next(e){this.isStopped?bd(av(e),this):this._next(e)}error(e){this.isStopped?bd(sv(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?bd(ov,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},OC=Function.prototype.bind;function Cd(n,e){return OC.call(n,e)}var Sd=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){$a(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){$a(r)}else $a(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){$a(t)}}},In=class extends Ar{constructor(e,t,r){super();let i;if(re(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let o;this&&Vt.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Cd(e.next,o),error:e.error&&Cd(e.error,o),complete:e.complete&&Cd(e.complete,o)}):i=e}this.destination=new Sd(i)}};function $a(n){Vt.useDeprecatedSynchronousErrorHandling?uv(n):Ua(n)}function FC(n){throw n}function bd(n,e){let{onStoppedNotification:t}=Vt;t&&_i.setTimeout(()=>t(n,e))}var LC={closed:!0,next:Dd,error:FC,complete:Dd};var Ii=typeof Symbol=="function"&&Symbol.observable||"@@observable";function en(n){return n}function cv(n){return n.length===0?en:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var Ae=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let o=jC(t)?t:new In(t,r,i);return wi(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=lv(r),new r((i,o)=>{let s=new In({next:a=>{try{t(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[Ii](){return this}pipe(...t){return cv(t)(this)}toPromise(t){return t=lv(t),new t((r,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>r(o))})}}return n.create=e=>new n(e),n})();function lv(n){var e;return(e=n??Vt.Promise)!==null&&e!==void 0?e:Promise}function VC(n){return n&&re(n.next)&&re(n.error)&&re(n.complete)}function jC(n){return n&&n instanceof Ar||VC(n)&&Ba(n)}function BC(n){return re(n?.lift)}function ge(n){return e=>{if(BC(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Te(n,e,t,r,i){return new Ad(n,e,t,r,i)}var Ad=class extends Ar{constructor(e,t,r,i,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};var dv=vi(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var gt=(()=>{class n extends Ae{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new Ha(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new dv}next(t){wi(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){wi(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){wi(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:o}=this;return r||i?Ed:(this.currentObservers=null,o.push(t),new Qe(()=>{this.currentObservers=null,br(o,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:o}=this;r?t.error(i):o&&t.complete()}asObservable(){let t=new Ae;return t.source=this,t}}return n.create=(e,t)=>new Ha(e,t),n})(),Ha=class extends gt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:Ed}};var Xo=class extends gt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var es={now(){return(es.delegate||Date).now()},delegate:void 0};var qa=class extends gt{constructor(e=1/0,t=1/0,r=es){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){let{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:o,_windowTime:s}=this;t||(r.push(e),!i&&r.push(o.now()+s)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,o=i.slice();for(let s=0;s<o.length&&!e.closed;s+=r?1:2)e.next(o[s]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){let{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,o=(i?1:2)*e;if(e<1/0&&o<r.length&&r.splice(0,r.length-o),!i){let s=t.now(),a=0;for(let c=1;c<r.length&&r[c]<=s;c+=2)a=c;a&&r.splice(0,a+1)}}};var za=class extends Qe{constructor(e,t){super()}schedule(e,t=0){return this}};var ts={setInterval(n,e,...t){let{delegate:r}=ts;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=ts;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var Ei=class extends za{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,r=0){return ts.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&ts.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(o){r=!0,i=o||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,br(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var Di=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};Di.now=es.now;var Ti=class extends Di{constructor(e,t=Di.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var ns=new Ti(Ei);var Ga=class extends Ei{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}};var Wa=class extends Ti{};var xd=new Wa(Ga);var Ka=new Ae(n=>n.complete());function hv(n){return n&&re(n.schedule)}function fv(n){return n[n.length-1]}function Gn(n){return hv(fv(n))?n.pop():void 0}function pv(n,e){return typeof fv(n)=="number"?n.pop():e}var Qa=n=>n&&typeof n.length=="number"&&typeof n!="function";function Ya(n){return re(n?.then)}function Za(n){return re(n[Ii])}function Ja(n){return Symbol.asyncIterator&&re(n?.[Symbol.asyncIterator])}function Xa(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function UC(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var eu=UC();function tu(n){return re(n?.[eu])}function nu(n){return Gy(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield Fa(t.read());if(i)return yield Fa(void 0);yield yield Fa(r)}}finally{t.releaseLock()}})}function ru(n){return re(n?.getReader)}function Ye(n){if(n instanceof Ae)return n;if(n!=null){if(Za(n))return $C(n);if(Qa(n))return HC(n);if(Ya(n))return qC(n);if(Ja(n))return gv(n);if(tu(n))return zC(n);if(ru(n))return GC(n)}throw Xa(n)}function $C(n){return new Ae(e=>{let t=n[Ii]();if(re(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function HC(n){return new Ae(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function qC(n){return new Ae(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Ua)})}function zC(n){return new Ae(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function gv(n){return new Ae(e=>{WC(n,e).catch(t=>e.error(t))})}function GC(n){return gv(nu(n))}function WC(n,e){var t,r,i,o;return zy(this,void 0,void 0,function*(){try{for(t=Wy(n);r=yield t.next(),!r.done;){let s=r.value;if(e.next(s),e.closed)return}}catch(s){i={error:s}}finally{try{r&&!r.done&&(o=t.return)&&(yield o.call(t))}finally{if(i)throw i.error}}e.complete()})}function At(n,e,t,r=0,i=!1){let o=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(o),!i)return o}function xt(n,e=0){return ge((t,r)=>{t.subscribe(Te(r,i=>At(r,n,()=>r.next(i),e),()=>At(r,n,()=>r.complete(),e),i=>At(r,n,()=>r.error(i),e)))})}function jt(n,e=0){return ge((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function mv(n,e){return Ye(n).pipe(jt(e),xt(e))}function yv(n,e){return Ye(n).pipe(jt(e),xt(e))}function vv(n,e){return new Ae(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function _v(n,e){return new Ae(t=>{let r;return At(t,e,()=>{r=n[eu](),At(t,e,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(s){t.error(s);return}o?t.complete():t.next(i)},0,!0)}),()=>re(r?.return)&&r.return()})}function iu(n,e){if(!n)throw new Error("Iterable cannot be null");return new Ae(t=>{At(t,e,()=>{let r=n[Symbol.asyncIterator]();At(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function wv(n,e){return iu(nu(n),e)}function Iv(n,e){if(n!=null){if(Za(n))return mv(n,e);if(Qa(n))return vv(n,e);if(Ya(n))return yv(n,e);if(Ja(n))return iu(n,e);if(tu(n))return _v(n,e);if(ru(n))return wv(n,e)}throw Xa(n)}function ct(n,e){return e?Iv(n,e):Ye(n)}function En(...n){let e=Gn(n);return ct(n,e)}var ou=vi(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Ce(n,e){return ge((t,r)=>{let i=0;t.subscribe(Te(r,o=>{r.next(n.call(e,o,i++))}))})}function Ev(n,e,t,r,i,o,s,a){let c=[],l=0,h=0,p=!1,m=()=>{p&&!c.length&&!l&&e.complete()},v=N=>l<r?M(N):c.push(N),M=N=>{o&&e.next(N),l++;let R=!1;Ye(t(N,h++)).subscribe(Te(e,B=>{i?.(B),o?v(B):e.next(B)},()=>{R=!0},void 0,()=>{if(R)try{for(l--;c.length&&l<r;){let B=c.shift();s?At(e,s,()=>M(B)):M(B)}m()}catch(B){e.error(B)}}))};return n.subscribe(Te(e,v,()=>{p=!0,m()})),()=>{a?.()}}function Md(n,e,t=1/0){return re(e)?Md((r,i)=>Ce((o,s)=>e(r,o,i,s))(Ye(n(r,i))),t):(typeof e=="number"&&(t=e),ge((r,i)=>Ev(r,i,n,t)))}function su(n=1/0){return Md(en,n)}function Dv(){return su(1)}function Nd(...n){return Dv()(ct(n,Gn(n)))}function Rd(...n){let e=Gn(n),t=pv(n,1/0),r=n;return r.length?r.length===1?Ye(r[0]):su(t)(ct(r,e)):Ka}function Wn(n,e){return ge((t,r)=>{let i=0;t.subscribe(Te(r,o=>n.call(e,o,i++)&&r.next(o)))})}function Tv(n,e,t,r,i){return(o,s)=>{let a=t,c=e,l=0;o.subscribe(Te(s,h=>{let p=l++;c=a?n(c,h,p):(a=!0,h),r&&s.next(c)},i&&(()=>{a&&s.next(c),s.complete()})))}}function Cv(n){return ge((e,t)=>{let r=!1;e.subscribe(Te(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function bv(n){return n<=0?()=>Ka:ge((e,t)=>{let r=0;e.subscribe(Te(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Pd(n,e=en){return n=n??KC,ge((t,r)=>{let i,o=!0;t.subscribe(Te(r,s=>{let a=e(s);(o||!n(i,a))&&(o=!1,i=a,r.next(s))}))})}function KC(n,e){return n===e}function Sv(n=QC){return ge((e,t)=>{let r=!1;e.subscribe(Te(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function QC(){return new ou}function au(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Wn((i,o)=>n(i,o,r)):en,bv(1),t?Cv(e):Sv(()=>new ou))}function rs(){return ge((n,e)=>{let t,r=!1;n.subscribe(Te(e,i=>{let o=t;t=i,r&&e.next([o,i]),r=!0}))})}function is(n,e){return ge(Tv(n,e,arguments.length>=2,!0))}function Av(n={}){let{connector:e=()=>new gt,resetOnError:t=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=n;return o=>{let s,a,c,l=0,h=!1,p=!1,m=()=>{a?.unsubscribe(),a=void 0},v=()=>{m(),s=c=void 0,h=p=!1},M=()=>{let N=s;v(),N?.unsubscribe()};return ge((N,R)=>{l++,!p&&!h&&m();let B=c=c??e();R.add(()=>{l--,l===0&&!p&&!h&&(a=kd(M,i))}),B.subscribe(R),!s&&l>0&&(s=new In({next:$=>B.next($),error:$=>{p=!0,m(),a=kd(v,t,$),B.error($)},complete:()=>{h=!0,m(),a=kd(v,r),B.complete()}}),Ye(N).subscribe(s))})(o)}}function kd(n,e,...t){if(e===!0){n();return}if(e===!1)return;let r=new In({next:()=>{r.unsubscribe(),n()}});return Ye(e(...t)).subscribe(r)}function uu(n,e,t){let r,i=!1;return n&&typeof n=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n:r=n??1/0,Av({connector:()=>new qa(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function os(...n){let e=Gn(n);return ge((t,r)=>{(e?Nd(n,t,e):Nd(n,t)).subscribe(r)})}function Bt(n,e){return ge((t,r)=>{let i=null,o=0,s=!1,a=()=>s&&!i&&r.complete();t.subscribe(Te(r,c=>{i?.unsubscribe();let l=0,h=o++;Ye(n(c,h)).subscribe(i=Te(r,p=>r.next(e?e(c,p,h,l++):p),()=>{i=null,a()}))},()=>{s=!0,a()}))})}function cu(n,e){return re(e)?Bt(()=>n,e):Bt(()=>n)}function Od(n,e,t){let r=re(n)||e||t?{next:n,error:e,complete:t}:n;return r?ge((i,o)=>{var s;(s=r.subscribe)===null||s===void 0||s.call(r);let a=!0;i.subscribe(Te(o,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),o.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),o.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),o.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):en}var h_="https://g.co/ng/security#xss",te=class extends Error{constructor(e,t){super(bh(e,t)),this.code=e}};function bh(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}function Uu(n){return{toString:n}.toString()}var lu="__parameters__";function YC(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function f_(n,e,t){return Uu(()=>{let r=YC(e);function i(...o){if(this instanceof i)return r.apply(this,o),this;let s=new i(...o);return a.annotation=s,a;function a(c,l,h){let p=c.hasOwnProperty(lu)?c[lu]:Object.defineProperty(c,lu,{value:[]})[lu];for(;p.length<=h;)p.push(null);return(p[h]=p[h]||[]).push(s),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var Sn=globalThis;function Ie(n){for(let e in n)if(n[e]===Ie)return e;throw Error("Could not find renamed property on target object.")}function Dt(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(Dt).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function xv(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var ZC=Ie({__forward_ref__:Ie});function p_(n){return n.__forward_ref__=p_,n.toString=function(){return Dt(this())},n}function $t(n){return JC(n)?n():n}function JC(n){return typeof n=="function"&&n.hasOwnProperty(ZC)&&n.__forward_ref__===p_}function Y(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function qt(n){return{providers:n.providers||[],imports:n.imports||[]}}function Sh(n){return Mv(n,g_)||Mv(n,m_)}function Mv(n,e){return n.hasOwnProperty(e)?n[e]:null}function XC(n){let e=n&&(n[g_]||n[m_]);return e||null}function Nv(n){return n&&(n.hasOwnProperty(Rv)||n.hasOwnProperty(eb))?n[Rv]:null}var g_=Ie({\u0275prov:Ie}),Rv=Ie({\u0275inj:Ie}),m_=Ie({ngInjectableDef:Ie}),eb=Ie({ngInjectorDef:Ie}),K=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=Y({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function y_(n){return n&&!!n.\u0275providers}var tb=Ie({\u0275cmp:Ie}),nb=Ie({\u0275dir:Ie}),rb=Ie({\u0275pipe:Ie}),ib=Ie({\u0275mod:Ie}),Pv=Ie({\u0275fac:Ie}),us=Ie({__NG_ELEMENT_ID__:Ie}),kv=Ie({__NG_ENV_ID__:Ie});function ls(n){return typeof n=="string"?n:n==null?"":String(n)}function ob(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():ls(n)}function sb(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new te(-200,n)}function Ah(n,e){throw new te(-201,!1)}var ie=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(ie||{}),qd;function v_(){return qd}function tn(n){let e=qd;return qd=n,e}function __(n,e,t){let r=Sh(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&ie.Optional)return null;if(e!==void 0)return e;Ah(n,"Injector")}var ab={},ds=ab,zd="__NG_DI_FLAG__",yu="ngTempTokenPath",ub="ngTokenPath",cb=/\n/gm,lb="\u0275",Ov="__source",xi;function db(){return xi}function Ci(n){let e=xi;return xi=n,e}function hb(n,e=ie.Default){if(xi===void 0)throw new te(-203,!1);return xi===null?__(n,void 0,e):xi.get(n,e&ie.Optional?null:void 0,e)}function F(n,e=ie.Default){return(v_()||hb)($t(n),e)}function ye(n,e=ie.Default){return F(n,$u(e))}function $u(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Gd(n){let e=[];for(let t=0;t<n.length;t++){let r=$t(n[t]);if(Array.isArray(r)){if(r.length===0)throw new te(900,!1);let i,o=ie.Default;for(let s=0;s<r.length;s++){let a=r[s],c=fb(a);typeof c=="number"?c===-1?i=a.token:o|=c:i=a}e.push(F(i,o))}else e.push(F(r))}return e}function w_(n,e){return n[zd]=e,n.prototype[zd]=e,n}function fb(n){return n[zd]}function pb(n,e,t,r){let i=n[yu];throw e[Ov]&&i.unshift(e[Ov]),n.message=gb(`
`+n.message,i,t,r),n[ub]=i,n[yu]=null,n}function gb(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==lb?n.slice(2):n;let i=Dt(e);if(Array.isArray(e))i=e.map(Dt).join(" -> ");else if(typeof e=="object"){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];o.push(s+":"+(typeof a=="string"?JSON.stringify(a):Dt(a)))}i=`{${o.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(cb,`
  `)}`}var Hu=w_(f_("Optional"),8);var mb=w_(f_("SkipSelf"),4);function hs(n,e){let t=n.hasOwnProperty(Pv);return t?n[Pv]:null}function xh(n,e){n.forEach(t=>Array.isArray(t)?xh(t,e):e(t))}function I_(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function vu(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}var fs={},nn=[],ps=new K(""),E_=new K("",-1),D_=new K(""),_u=class{get(e,t=ds){if(t===ds){let r=new Error(`NullInjectorError: No provider for ${Dt(e)}!`);throw r.name="NullInjectorError",r}return t}},T_=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(T_||{}),on=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(on||{}),Yn=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(Yn||{});function yb(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let o=e.length;if(i+o===r||n.charCodeAt(i+o)<=32)return i}t=i+1}}function Wd(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let o=t[r++],s=t[r++],a=t[r++];n.setAttribute(e,s,a,o)}else{let o=i,s=t[++r];_b(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),r++}}return r}function vb(n){return n===3||n===4||n===6}function _b(n){return n.charCodeAt(0)===64}function Mh(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?Fv(n,t,i,null,e[++r]):Fv(n,t,i,null,null))}}return n}function Fv(n,e,t,r,i){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[o+1]=i);return}else if(r===n[o+1]){n[o+2]=i;return}}o++,r!==null&&o++,i!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),r!==null&&n.splice(o++,0,r),i!==null&&n.splice(o++,0,i)}var C_="ng-template";function wb(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&yb(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(Nh(n))return!1;if(i=e.indexOf(1,i),i>-1){let o;for(;++i<e.length&&typeof(o=e[i])=="string";)if(o.toLowerCase()===t)return!0}return!1}function Nh(n){return n.type===4&&n.value!==C_}function Ib(n,e,t){let r=n.type===4&&!t?C_:n.value;return e===r}function Eb(n,e,t){let r=4,i=n.attrs,o=i!==null?Cb(i):0,s=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!s&&!Ut(r)&&!Ut(c))return!1;if(s&&Ut(c))continue;s=!1,r=c|r&1;continue}if(!s)if(r&4){if(r=2|r&1,c!==""&&!Ib(n,c,t)||c===""&&e.length===1){if(Ut(r))return!1;s=!0}}else if(r&8){if(i===null||!wb(n,i,c,t)){if(Ut(r))return!1;s=!0}}else{let l=e[++a],h=Db(c,i,Nh(n),t);if(h===-1){if(Ut(r))return!1;s=!0;continue}if(l!==""){let p;if(h>o?p="":p=i[h+1].toLowerCase(),r&2&&l!==p){if(Ut(r))return!1;s=!0}}}}return Ut(r)||s}function Ut(n){return(n&1)===0}function Db(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let o=!1;for(;i<e.length;){let s=e[i];if(s===n)return i;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(s===4)break;if(s===0){i+=4;continue}}i+=o?1:2}return-1}else return bb(e,n)}function Tb(n,e,t=!1){for(let r=0;r<e.length;r++)if(Eb(n,e[r],t))return!0;return!1}function Cb(n){for(let e=0;e<n.length;e++){let t=n[e];if(vb(t))return e}return n.length}function bb(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function Lv(n,e){return n?":not("+e.trim()+")":e}function Sb(n){let e=n[0],t=1,r=2,i="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(r&2){let a=n[++t];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+s:r&4&&(i+=" "+s);else i!==""&&!Ut(s)&&(e+=Lv(o,i),i=""),r=s,o=o||!Ut(r);t++}return i!==""&&(e+=Lv(o,i)),e}function Ab(n){return n.map(Sb).join(",")}function xb(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let o=n[r];if(typeof o=="string")i===2?o!==""&&e.push(o,n[++r]):i===8&&t.push(o);else{if(!Ut(i))break;i=o}r++}return{attrs:e,classes:t}}function it(n){return Uu(()=>{let e=x_(n),t=It(De({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===T_.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||on.Emulated,styles:n.styles||nn,_:null,schemas:n.schemas||null,tView:null,id:""});M_(t);let r=n.dependencies;return t.directiveDefs=jv(r,!1),t.pipeDefs=jv(r,!0),t.id=kb(t),t})}function Mb(n){return Ni(n)||S_(n)}function Nb(n){return n!==null}function zt(n){return Uu(()=>({type:n.type,bootstrap:n.bootstrap||nn,declarations:n.declarations||nn,imports:n.imports||nn,exports:n.exports||nn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function Vv(n,e){if(n==null)return fs;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],o,s,a=Yn.None;Array.isArray(i)?(a=i[0],o=i[1],s=i[2]??o):(o=i,s=i),e?(t[o]=a!==Yn.None?[r,a]:r,e[o]=s):t[o]=r}return t}function b_(n){return Uu(()=>{let e=x_(n);return M_(e),e})}function Ni(n){return n[tb]||null}function S_(n){return n[nb]||null}function A_(n){return n[rb]||null}function Rb(n){let e=Ni(n)||S_(n)||A_(n);return e!==null?e.standalone:!1}function Pb(n,e){let t=n[ib]||null;if(!t&&e===!0)throw new Error(`Type ${Dt(n)} does not have '\u0275mod' property.`);return t}function x_(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||fs,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||nn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Vv(n.inputs,e),outputs:Vv(n.outputs),debugInfo:null}}function M_(n){n.features?.forEach(e=>e(n))}function jv(n,e){if(!n)return null;let t=e?A_:Mb;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(Nb)}function kb(n){let e=0,t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(let i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function Ob(...n){return{\u0275providers:Fb(!0,n),\u0275fromNgModule:!0}}function Fb(n,...e){let t=[],r=new Set,i,o=s=>{t.push(s)};return xh(e,s=>{let a=s;Kd(a,o,[],r)&&(i||=[],i.push(a))}),i!==void 0&&N_(i,o),t}function N_(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];Rh(i,o=>{e(o,r)})}}function Kd(n,e,t,r){if(n=$t(n),!n)return!1;let i=null,o=Nv(n),s=!o&&Ni(n);if(!o&&!s){let c=n.ngModule;if(o=Nv(c),o)i=c;else return!1}else{if(s&&!s.standalone)return!1;i=n}let a=r.has(i);if(s){if(a)return!1;if(r.add(i),s.dependencies){let c=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let l of c)Kd(l,e,t,r)}}else if(o){if(o.imports!=null&&!a){r.add(i);let l;try{xh(o.imports,h=>{Kd(h,e,t,r)&&(l||=[],l.push(h))})}finally{}l!==void 0&&N_(l,e)}if(!a){let l=hs(i)||(()=>new i);e({provide:i,useFactory:l,deps:nn},i),e({provide:D_,useValue:i,multi:!0},i),e({provide:ps,useValue:()=>F(i),multi:!0},i)}let c=o.providers;if(c!=null&&!a){let l=n;Rh(c,h=>{e(h,l)})}}else return!1;return i!==n&&n.providers!==void 0}function Rh(n,e){for(let t of n)y_(t)&&(t=t.\u0275providers),Array.isArray(t)?Rh(t,e):e(t)}var Lb=Ie({provide:String,useValue:Ie});function R_(n){return n!==null&&typeof n=="object"&&Lb in n}function Vb(n){return!!(n&&n.useExisting)}function jb(n){return!!(n&&n.useFactory)}function Qd(n){return typeof n=="function"}var qu=new K(""),fu={},Bb={},Fd;function P_(){return Fd===void 0&&(Fd=new _u),Fd}var Nr=class{},Yd=class extends Nr{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Jd(e,s=>this.processProvider(s)),this.records.set(E_,bi(void 0,this)),i.has("environment")&&this.records.set(Nr,bi(void 0,this));let o=this.records.get(qu);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(D_,nn,ie.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=me(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),me(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=Ci(this),r=tn(void 0),i;try{return e()}finally{Ci(t),tn(r)}}get(e,t=ds,r=ie.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(kv))return e[kv](this);r=$u(r);let i,o=Ci(this),s=tn(void 0);try{if(!(r&ie.SkipSelf)){let c=this.records.get(e);if(c===void 0){let l=Gb(e)&&Sh(e);l&&this.injectableDefInScope(l)?c=bi(Zd(e),fu):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&ie.Self?P_():this.parent;return t=r&ie.Optional&&t===ds?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[yu]=a[yu]||[]).unshift(Dt(e)),o)throw a;return pb(a,e,"R3InjectorError",this.source)}else throw a}finally{tn(s),Ci(o)}}resolveInjectorInitializers(){let e=me(null),t=Ci(this),r=tn(void 0),i;try{let o=this.get(ps,nn,ie.Self);for(let s of o)s()}finally{Ci(t),tn(r),me(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(Dt(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new te(205,!1)}processProvider(e){e=$t(e);let t=Qd(e)?e:$t(e&&e.provide),r=$b(e);if(!Qd(e)&&e.multi===!0){let i=this.records.get(t);i||(i=bi(void 0,fu,!0),i.factory=()=>Gd(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=me(null);try{return t.value===fu&&(t.value=Bb,t.value=t.factory()),typeof t.value=="object"&&t.value&&zb(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{me(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=$t(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Zd(n){let e=Sh(n),t=e!==null?e.factory:hs(n);if(t!==null)return t;if(n instanceof K)throw new te(204,!1);if(n instanceof Function)return Ub(n);throw new te(204,!1)}function Ub(n){if(n.length>0)throw new te(204,!1);let t=XC(n);return t!==null?()=>t.factory(n):()=>new n}function $b(n){if(R_(n))return bi(void 0,n.useValue);{let e=Hb(n);return bi(e,fu)}}function Hb(n,e,t){let r;if(Qd(n)){let i=$t(n);return hs(i)||Zd(i)}else if(R_(n))r=()=>$t(n.useValue);else if(jb(n))r=()=>n.useFactory(...Gd(n.deps||[]));else if(Vb(n))r=()=>F($t(n.useExisting));else{let i=$t(n&&(n.useClass||n.provide));if(qb(n))r=()=>new i(...Gd(n.deps));else return hs(i)||Zd(i)}return r}function bi(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function qb(n){return!!n.deps}function zb(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function Gb(n){return typeof n=="function"||typeof n=="object"&&n instanceof K}function Jd(n,e){for(let t of n)Array.isArray(t)?Jd(t,e):t&&y_(t)?Jd(t.\u0275providers,e):e(t)}function Wb(){return v_()!==void 0||db()!=null}function Kb(n){let e=Sn.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function Qb(n){return typeof n=="function"}var An=0,ae=1,Q=2,lt=3,Ht=4,Gt=5,wu=6,Bv=7,Zn=8,Ri=9,sn=10,Tt=11,gs=12,Uv=13,ws=14,Tn=15,Pi=16,Si=17,ki=18,zu=19,k_=20,Qn=21,Ld=22,Mt=23,Jn=25,O_=1;var Rr=7,Iu=8,Eu=9,Nt=10,Du=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(Du||{});function xr(n){return Array.isArray(n)&&typeof n[O_]=="object"}function xn(n){return Array.isArray(n)&&n[O_]===!0}function F_(n){return(n.flags&4)!==0}function Ph(n){return n.componentOffset>-1}function L_(n){return(n.flags&1)===1}function Is(n){return!!n.template}function Xd(n){return(n[Q]&512)!==0}var eh=class{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function V_(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}function j_(){return B_}function B_(n){return n.type.prototype.ngOnChanges&&(n.setInput=Zb),Yb}j_.ngInherit=!0;function Yb(){let n=$_(this),e=n?.current;if(e){let t=n.previous;if(t===fs)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function Zb(n,e,t,r,i){let o=this.declaredInputs[r],s=$_(n)||Jb(n,{previous:fs,current:null}),a=s.current||(s.current={}),c=s.previous,l=c[o];a[o]=new eh(l&&l.currentValue,t,c===fs),V_(n,e,i,t)}var U_="__ngSimpleChanges__";function $_(n){return n[U_]||null}function Jb(n,e){return n[U_]=e}var $v=null;var Kn=function(n,e,t){$v?.(n,e,t)},Xb="svg",eS="math";function Cn(n){for(;Array.isArray(n);)n=n[An];return n}function tS(n,e){return Cn(e[n])}function an(n,e){return Cn(e[n.index])}function H_(n,e){return n.data[e]}function Es(n,e){let t=e[n];return xr(t)?t:t[An]}function kh(n){return(n[Q]&128)===128}function nS(n){return xn(n[lt])}function Tu(n,e){return e==null?null:n[e]}function q_(n){n[Si]=0}function z_(n){n[Q]&1024||(n[Q]|=1024,kh(n)&&Wu(n))}function Gu(n){return!!(n[Q]&9216||n[Mt]?.dirty)}function th(n){n[sn].changeDetectionScheduler?.notify(8),n[Q]&64&&(n[Q]|=1024),Gu(n)&&Wu(n)}function Wu(n){n[sn].changeDetectionScheduler?.notify(0);let e=Pr(n);for(;e!==null&&!(e[Q]&8192||(e[Q]|=8192,!kh(e)));)e=Pr(e)}function G_(n,e){if((n[Q]&256)===256)throw new te(911,!1);n[Qn]===null&&(n[Qn]=[]),n[Qn].push(e)}function rS(n,e){if(n[Qn]===null)return;let t=n[Qn].indexOf(e);t!==-1&&n[Qn].splice(t,1)}function Pr(n){let e=n[lt];return xn(e)?e[lt]:e}var he={lFrame:nw(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var W_=!1;function iS(){return he.lFrame.elementDepthCount}function oS(){he.lFrame.elementDepthCount++}function sS(){he.lFrame.elementDepthCount--}function K_(){return he.bindingsEnabled}function aS(){return he.skipHydrationRootTNode!==null}function uS(n){return he.skipHydrationRootTNode===n}function cS(){he.skipHydrationRootTNode=null}function Ze(){return he.lFrame.lView}function Vi(){return he.lFrame.tView}function Mn(){let n=Q_();for(;n!==null&&n.type===64;)n=n.parent;return n}function Q_(){return he.lFrame.currentTNode}function lS(){let n=he.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function Ds(n,e){let t=he.lFrame;t.currentTNode=n,t.isParent=e}function Y_(){return he.lFrame.isParent}function dS(){he.lFrame.isParent=!1}function Z_(){return W_}function Hv(n){W_=n}function hS(){return he.lFrame.bindingIndex}function fS(n){return he.lFrame.bindingIndex=n}function J_(){return he.lFrame.bindingIndex++}function pS(n){let e=he.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function gS(){return he.lFrame.inI18n}function mS(n,e){let t=he.lFrame;t.bindingIndex=t.bindingRootIndex=n,nh(e)}function yS(){return he.lFrame.currentDirectiveIndex}function nh(n){he.lFrame.currentDirectiveIndex=n}function X_(n){he.lFrame.currentQueryIndex=n}function vS(n){let e=n[ae];return e.type===2?e.declTNode:e.type===1?n[Gt]:null}function ew(n,e,t){if(t&ie.SkipSelf){let i=e,o=n;for(;i=i.parent,i===null&&!(t&ie.Host);)if(i=vS(o),i===null||(o=o[ws],i.type&10))break;if(i===null)return!1;e=i,n=o}let r=he.lFrame=tw();return r.currentTNode=e,r.lView=n,!0}function Oh(n){let e=tw(),t=n[ae];he.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function tw(){let n=he.lFrame,e=n===null?null:n.child;return e===null?nw(n):e}function nw(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function rw(){let n=he.lFrame;return he.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var iw=rw;function Fh(){let n=rw();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Ku(){return he.lFrame.selectedIndex}function kr(n){he.lFrame.selectedIndex=n}function _S(){let n=he.lFrame;return H_(n.tView,n.selectedIndex)}function wS(){return he.lFrame.currentNamespace}var ow=!0;function Lh(){return ow}function Vh(n){ow=n}function IS(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){let s=B_(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}i&&(t.preOrderHooks??=[]).push(0-n,i),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function jh(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:h}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),h!=null&&(n.destroyHooks??=[]).push(t,h)}}function pu(n,e,t){sw(n,e,3,t)}function gu(n,e,t,r){(n[Q]&3)===t&&sw(n,e,t,r)}function Vd(n,e){let t=n[Q];(t&3)===e&&(t&=16383,t+=1,n[Q]=t)}function sw(n,e,t,r){let i=r!==void 0?n[Si]&65535:0,o=r??-1,s=e.length-1,a=0;for(let c=i;c<s;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[Si]+=65536),(a<o||o==-1)&&(ES(n,t,e,c),n[Si]=(n[Si]&4294901760)+c+2),c++}function qv(n,e){Kn(4,n,e);let t=me(null);try{e.call(n)}finally{me(t),Kn(5,n,e)}}function ES(n,e,t,r){let i=t[r]<0,o=t[r+1],s=i?-t[r]:t[r],a=n[s];i?n[Q]>>14<n[Si]>>16&&(n[Q]&3)===e&&(n[Q]+=16384,qv(a,o)):qv(a,o)}var Mi=-1,ms=class{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function DS(n){return n instanceof ms}function TS(n){return(n.flags&8)!==0}function CS(n){return(n.flags&16)!==0}var jd={},rh=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=$u(r);let i=this.injector.get(e,jd,r);return i!==jd||t===jd?i:this.parentInjector.get(e,t,r)}};function aw(n){return n!==Mi}function Cu(n){return n&32767}function bS(n){return n>>16}function bu(n,e){let t=bS(n),r=e;for(;t>0;)r=r[ws],t--;return r}var ih=!0;function zv(n){let e=ih;return ih=n,e}var SS=256,uw=SS-1,cw=5,AS=0,rn={};function xS(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(us)&&(r=t[us]),r==null&&(r=t[us]=AS++);let i=r&uw,o=1<<i;e.data[n+(i>>cw)]|=o}function lw(n,e){let t=dw(n,e);if(t!==-1)return t;let r=e[ae];r.firstCreatePass&&(n.injectorIndex=e.length,Bd(r.data,n),Bd(e,null),Bd(r.blueprint,null));let i=Bh(n,e),o=n.injectorIndex;if(aw(i)){let s=Cu(i),a=bu(i,e),c=a[ae].data;for(let l=0;l<8;l++)e[o+l]=a[s+l]|c[s+l]}return e[o+8]=i,o}function Bd(n,e){n.push(0,0,0,0,0,0,0,0,e)}function dw(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function Bh(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=mw(i),r===null)return Mi;if(t++,i=i[ws],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return Mi}function MS(n,e,t){xS(n,e,t)}function hw(n,e,t){if(t&ie.Optional||n!==void 0)return n;Ah(e,"NodeInjector")}function fw(n,e,t,r){if(t&ie.Optional&&r===void 0&&(r=null),!(t&(ie.Self|ie.Host))){let i=n[Ri],o=tn(void 0);try{return i?i.get(e,r,t&ie.Optional):__(e,r,t&ie.Optional)}finally{tn(o)}}return hw(r,e,t)}function pw(n,e,t,r=ie.Default,i){if(n!==null){if(e[Q]&2048&&!(r&ie.Self)){let s=OS(n,e,t,r,rn);if(s!==rn)return s}let o=gw(n,e,t,r,rn);if(o!==rn)return o}return fw(e,t,r,i)}function gw(n,e,t,r,i){let o=PS(t);if(typeof o=="function"){if(!ew(e,n,r))return r&ie.Host?hw(i,t,r):fw(e,t,r,i);try{let s;if(s=o(r),s==null&&!(r&ie.Optional))Ah(t);else return s}finally{iw()}}else if(typeof o=="number"){let s=null,a=dw(n,e),c=Mi,l=r&ie.Host?e[Tn][Gt]:null;for((a===-1||r&ie.SkipSelf)&&(c=a===-1?Bh(n,e):e[a+8],c===Mi||!Wv(r,!1)?a=-1:(s=e[ae],a=Cu(c),e=bu(c,e)));a!==-1;){let h=e[ae];if(Gv(o,a,h.data)){let p=NS(a,e,t,s,r,l);if(p!==rn)return p}c=e[a+8],c!==Mi&&Wv(r,e[ae].data[a+8]===l)&&Gv(o,a,e)?(s=h,a=Cu(c),e=bu(c,e)):a=-1}}return i}function NS(n,e,t,r,i,o){let s=e[ae],a=s.data[n+8],c=r==null?Ph(a)&&ih:r!=s&&(a.type&3)!==0,l=i&ie.Host&&o===a,h=RS(a,s,t,c,l);return h!==null?ys(e,s,h,a):rn}function RS(n,e,t,r,i){let o=n.providerIndexes,s=e.data,a=o&1048575,c=n.directiveStart,l=n.directiveEnd,h=o>>20,p=r?a:a+h,m=i?a+h:l;for(let v=p;v<m;v++){let M=s[v];if(v<c&&t===M||v>=c&&M.type===t)return v}if(i){let v=s[c];if(v&&Is(v)&&v.type===t)return c}return null}function ys(n,e,t,r){let i=n[t],o=e.data;if(DS(i)){let s=i;s.resolving&&sb(ob(o[t]));let a=zv(s.canSeeViewProviders);s.resolving=!0;let c,l=s.injectImpl?tn(s.injectImpl):null,h=ew(n,r,ie.Default);try{i=n[t]=s.factory(void 0,o,n,r),e.firstCreatePass&&t>=r.directiveStart&&IS(t,o[t],e)}finally{l!==null&&tn(l),zv(a),s.resolving=!1,iw()}}return i}function PS(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(us)?n[us]:void 0;return typeof e=="number"?e>=0?e&uw:kS:e}function Gv(n,e,t){let r=1<<n;return!!(t[e+(n>>cw)]&r)}function Wv(n,e){return!(n&ie.Self)&&!(n&ie.Host&&e)}var Mr=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return pw(this._tNode,this._lView,e,$u(r),t)}};function kS(){return new Mr(Mn(),Ze())}function OS(n,e,t,r,i){let o=n,s=e;for(;o!==null&&s!==null&&s[Q]&2048&&!(s[Q]&512);){let a=gw(o,s,t,r|ie.Self,rn);if(a!==rn)return a;let c=o.parent;if(!c){let l=s[k_];if(l){let h=l.get(t,rn,r);if(h!==rn)return h}c=mw(s),s=s[ws]}o=c}return i}function mw(n){let e=n[ae],t=e.type;return t===2?e.declTNode:t===1?n[Gt]:null}function Kv(n,e=null,t=null,r){let i=yw(n,e,t,r);return i.resolveInjectorInitializers(),i}function yw(n,e=null,t=null,r,i=new Set){let o=[t||nn,Ob(n)];return r=r||(typeof n=="object"?void 0:Dt(n)),new Yd(o,e||P_(),r||null,i)}var Or=class n{static{this.THROW_IF_NOT_FOUND=ds}static{this.NULL=new _u}static create(e,t){if(Array.isArray(e))return Kv({name:""},t,e,"");{let r=e.name??"";return Kv({name:r},e.parent,e.providers,r)}}static{this.\u0275prov=Y({token:n,providedIn:"any",factory:()=>F(E_)})}static{this.__NG_ELEMENT_ID__=-1}};var FS=new K("");FS.__NG_ELEMENT_ID__=n=>{let e=Mn();if(e===null)throw new te(204,!1);if(e.type&2)return e.value;if(n&ie.Optional)return null;throw new te(204,!1)};var LS="ngOriginalError";function Ud(n){return n[LS]}var vw=!0,_w=(()=>{class n{static{this.__NG_ELEMENT_ID__=VS}static{this.__NG_ENV_ID__=t=>t}}return n})(),oh=class extends _w{constructor(e){super(),this._lView=e}onDestroy(e){return G_(this._lView,e),()=>rS(this._lView,e)}};function VS(){return new oh(Ze())}var Qu=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Xo(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275prov=Y({token:n,providedIn:"root",factory:()=>new n})}}return n})();var sh=class extends gt{constructor(e=!1){super(),this.destroyRef=void 0,this.pendingTasks=void 0,this.__isAsync=e,Wb()&&(this.destroyRef=ye(_w,{optional:!0})??void 0,this.pendingTasks=ye(Qu,{optional:!0})??void 0)}emit(e){let t=me(null);try{super.next(e)}finally{me(t)}}subscribe(e,t,r){let i=e,o=t||(()=>null),s=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),o=c.error?.bind(c),s=c.complete?.bind(c)}this.__isAsync&&(o=this.wrapInTimeout(o),i&&(i=this.wrapInTimeout(i)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:i,error:o,complete:s});return e instanceof Qe&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{e(t),r!==void 0&&this.pendingTasks?.remove(r)})}}},Dn=sh;function Su(...n){}function ww(n){let e,t;function r(){n=Su;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function Qv(n){return queueMicrotask(()=>n()),()=>{n=Su}}var Uh="isAngularZone",Au=Uh+"_ID",jS=0,fe=class n{constructor(e){this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Dn(!1),this.onMicrotaskEmpty=new Dn(!1),this.onStable=new Dn(!1),this.onError=new Dn(!1);let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:o=vw}=e;if(typeof Zone>"u")throw new te(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&r,s.shouldCoalesceRunChangeDetection=i,s.callbackScheduled=!1,s.scheduleInRootZone=o,$S(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(Uh)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new te(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new te(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,BS,Su,Su);try{return o.runTask(s,t,r)}finally{o.cancelTask(s)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},BS={};function $h(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function US(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){ww(()=>{n.callbackScheduled=!1,ah(n),n.isCheckStableRunning=!0,$h(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),ah(n)}function $S(n){let e=()=>{US(n)},t=jS++;n._inner=n._inner.fork({name:"angular",properties:{[Uh]:!0,[Au]:t,[Au+t]:!0},onInvokeTask:(r,i,o,s,a,c)=>{if(HS(c))return r.invokeTask(o,s,a,c);try{return Yv(n),r.invokeTask(o,s,a,c)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),Zv(n)}},onInvoke:(r,i,o,s,a,c,l)=>{try{return Yv(n),r.invoke(o,s,a,c,l)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!qS(c)&&e(),Zv(n)}},onHasTask:(r,i,o,s)=>{r.hasTask(o,s),i===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,ah(n),$h(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(r,i,o,s)=>(r.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function ah(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function Yv(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function Zv(n){n._nesting--,$h(n)}var xu=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Dn,this.onMicrotaskEmpty=new Dn,this.onStable=new Dn,this.onError=new Dn}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function HS(n){return Iw(n,"__ignore_ng_zone__")}function qS(n){return Iw(n,"__scheduler_tick__")}function Iw(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}function zS(n="zone.js",e){return n==="noop"?new xu:n==="zone.js"?new fe(e):n}var bn=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Ud(e);for(;t&&Ud(t);)t=Ud(t);return t||null}},GS=new K("",{providedIn:"root",factory:()=>{let n=ye(fe),e=ye(bn);return t=>n.runOutsideAngular(()=>e.handleError(t))}});function WS(){return Yu(Mn(),Ze())}function Yu(n,e){return new Hh(an(n,e))}var Hh=(()=>{class n{constructor(t){this.nativeElement=t}static{this.__NG_ELEMENT_ID__=WS}}return n})();function Ew(n){return(n.flags&128)===128}var Dw=new Map,KS=0;function QS(){return KS++}function YS(n){Dw.set(n[zu],n)}function uh(n){Dw.delete(n[zu])}var Jv="__ngContext__";function Fr(n,e){xr(e)?(n[Jv]=e[zu],YS(e)):n[Jv]=e}function Tw(n){return bw(n[gs])}function Cw(n){return bw(n[Ht])}function bw(n){for(;n!==null&&!xn(n);)n=n[Ht];return n}var ch;function Sw(n){ch=n}function ZS(){if(ch!==void 0)return ch;if(typeof document<"u")return document;throw new te(210,!1)}var Zu=new K("",{providedIn:"root",factory:()=>JS}),JS="ng",qh=new K(""),Rt=new K("",{providedIn:"platform",factory:()=>"unknown"});var zh=new K("",{providedIn:"root",factory:()=>ZS().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var XS="h",eA="b";var tA=()=>null;function Gh(n,e,t=!1){return tA(n,e,t)}var Aw=!1,nA=new K("",{providedIn:"root",factory:()=>Aw});var Mu=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${h_})`}};function Wh(n){return n instanceof Mu?n.changingThisBreaksApplicationSecurity:n}function xw(n,e){let t=rA(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${h_})`)}return t===e}function rA(n){return n instanceof Mu&&n.getTypeName()||null}var iA=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Mw(n){return n=String(n),n.match(iA)?n:"unsafe:"+n}var Kh=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(Kh||{});function Nw(n){let e=oA();return e?e.sanitize(Kh.URL,n)||"":xw(n,"URL")?Wh(n):Mw(ls(n))}function oA(){let n=Ze();return n&&n[sn].sanitizer}function sA(n){return n instanceof Function?n():n}var Vr=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Vr||{}),aA;function Qh(n,e){return aA(n,e)}function Ai(n,e,t,r,i){if(r!=null){let o,s=!1;xn(r)?o=r:xr(r)&&(s=!0,r=r[An]);let a=Cn(r);n===0&&t!==null?i==null?Fw(e,t,a):Nu(e,t,a,i||null,!0):n===1&&t!==null?Nu(e,t,a,i||null,!0):n===2?EA(e,a,s):n===3&&e.destroyNode(a),o!=null&&TA(e,n,o,t,i)}}function uA(n,e){return n.createText(e)}function cA(n,e,t){n.setValue(e,t)}function Rw(n,e,t){return n.createElement(e,t)}function lA(n,e){Pw(n,e),e[An]=null,e[Gt]=null}function dA(n,e,t,r,i,o){r[An]=i,r[Gt]=e,Ju(n,r,t,1,i,o)}function Pw(n,e){e[sn].changeDetectionScheduler?.notify(9),Ju(n,e,e[Tt],2,null,null)}function hA(n){let e=n[gs];if(!e)return $d(n[ae],n);for(;e;){let t=null;if(xr(e))t=e[gs];else{let r=e[Nt];r&&(t=r)}if(!t){for(;e&&!e[Ht]&&e!==n;)xr(e)&&$d(e[ae],e),e=e[lt];e===null&&(e=n),xr(e)&&$d(e[ae],e),t=e&&e[Ht]}e=t}}function fA(n,e,t,r){let i=Nt+r,o=t.length;r>0&&(t[i-1][Ht]=e),r<o-Nt?(e[Ht]=t[i],I_(t,Nt+r,e)):(t.push(e),e[Ht]=null),e[lt]=t;let s=e[Pi];s!==null&&t!==s&&kw(s,e);let a=e[ki];a!==null&&a.insertView(n),th(e),e[Q]|=128}function kw(n,e){let t=n[Eu],r=e[lt];if(xr(r))n[Q]|=Du.HasTransplantedViews;else{let i=r[lt][Tn];e[Tn]!==i&&(n[Q]|=Du.HasTransplantedViews)}t===null?n[Eu]=[e]:t.push(e)}function Yh(n,e){let t=n[Eu],r=t.indexOf(e);t.splice(r,1)}function lh(n,e){if(n.length<=Nt)return;let t=Nt+e,r=n[t];if(r){let i=r[Pi];i!==null&&i!==n&&Yh(i,r),e>0&&(n[t-1][Ht]=r[Ht]);let o=vu(n,Nt+e);lA(r[ae],r);let s=o[ki];s!==null&&s.detachView(o[ae]),r[lt]=null,r[Ht]=null,r[Q]&=-129}return r}function Ow(n,e){if(!(e[Q]&256)){let t=e[Tt];t.destroyNode&&Ju(n,e,t,3,null,null),hA(e)}}function $d(n,e){if(e[Q]&256)return;let t=me(null);try{e[Q]&=-129,e[Q]|=256,e[Mt]&&vd(e[Mt]),gA(n,e),pA(n,e),e[ae].type===1&&e[Tt].destroy();let r=e[Pi];if(r!==null&&xn(e[lt])){r!==e[lt]&&Yh(r,e);let i=e[ki];i!==null&&i.detachView(n)}uh(e)}finally{me(t)}}function pA(n,e){let t=n.cleanup,r=e[Bv];if(t!==null)for(let o=0;o<t.length-1;o+=2)if(typeof t[o]=="string"){let s=t[o+3];s>=0?r[s]():r[-s].unsubscribe(),o+=2}else{let s=r[t[o+1]];t[o].call(s)}r!==null&&(e[Bv]=null);let i=e[Qn];if(i!==null){e[Qn]=null;for(let o=0;o<i.length;o++){let s=i[o];s()}}}function gA(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof ms)){let o=t[r+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=i[o[s]],c=o[s+1];Kn(4,a,c);try{c.call(a)}finally{Kn(5,a,c)}}else{Kn(4,i,o);try{o.call(i)}finally{Kn(5,i,o)}}}}}function mA(n,e,t){return yA(n,e.parent,t)}function yA(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[An];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:o}=n.data[r.directiveStart+i];if(o===on.None||o===on.Emulated)return null}return an(r,t)}}function Nu(n,e,t,r,i){n.insertBefore(e,t,r,i)}function Fw(n,e,t){n.appendChild(e,t)}function Xv(n,e,t,r,i){r!==null?Nu(n,e,t,r,i):Fw(n,e,t)}function Lw(n,e){return n.parentNode(e)}function vA(n,e){return n.nextSibling(e)}function _A(n,e,t){return IA(n,e,t)}function wA(n,e,t){return n.type&40?an(n,t):null}var IA=wA,e_;function Zh(n,e,t,r){let i=mA(n,r,e),o=e[Tt],s=r.parent||e[Gt],a=_A(s,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)Xv(o,i,t[c],a,!1);else Xv(o,i,t,a,!1);e_!==void 0&&e_(o,r,e,t,i)}function ss(n,e){if(e!==null){let t=e.type;if(t&3)return an(e,n);if(t&4)return dh(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return ss(n,r);{let i=n[e.index];return xn(i)?dh(-1,i):Cn(i)}}else{if(t&128)return ss(n,e.next);if(t&32)return Qh(e,n)()||Cn(n[e.index]);{let r=Vw(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Pr(n[Tn]);return ss(i,r)}else return ss(n,e.next)}}}return null}function Vw(n,e){if(e!==null){let r=n[Tn][Gt],i=e.projection;return r.projection[i]}return null}function dh(n,e){let t=Nt+n+1;if(t<e.length){let r=e[t],i=r[ae].firstChild;if(i!==null)return ss(r,i)}return e[Rr]}function EA(n,e,t){n.removeChild(null,e,t)}function Jh(n,e,t,r,i,o,s){for(;t!=null;){if(t.type===128){t=t.next;continue}let a=r[t.index],c=t.type;if(s&&e===0&&(a&&Fr(Cn(a),r),t.flags|=2),(t.flags&32)!==32)if(c&8)Jh(n,e,t.child,r,i,o,!1),Ai(e,n,i,a,o);else if(c&32){let l=Qh(t,r),h;for(;h=l();)Ai(e,n,i,h,o);Ai(e,n,i,a,o)}else c&16?DA(n,e,r,t,i,o):Ai(e,n,i,a,o);t=s?t.projectionNext:t.next}}function Ju(n,e,t,r,i,o){Jh(t,r,n.firstChild,e,i,o,!1)}function DA(n,e,t,r,i,o){let s=t[Tn],c=s[Gt].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let h=c[l];Ai(e,n,i,h,o)}else{let l=c,h=s[lt];Ew(r)&&(l.flags|=128),Jh(n,e,l,h,i,o,!0)}}function TA(n,e,t,r,i){let o=t[Rr],s=Cn(t);o!==s&&Ai(e,n,r,o,i);for(let a=Nt;a<t.length;a++){let c=t[a];Ju(c[ae],c,n,e,r,o)}}function CA(n,e,t){n.setAttribute(e,"style",t)}function jw(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function Bw(n,e,t){let{mergedAttrs:r,classes:i,styles:o}=t;r!==null&&Wd(n,e,r),i!==null&&jw(n,e,i),o!==null&&CA(n,e,o)}var ji={};function ee(n=1){Uw(Vi(),Ze(),Ku()+n,!1)}function Uw(n,e,t,r){if(!r)if((e[Q]&3)===3){let o=n.preOrderCheckHooks;o!==null&&pu(e,o,t)}else{let o=n.preOrderHooks;o!==null&&gu(e,o,0,t)}kr(t)}function ze(n,e=ie.Default){let t=Ze();if(t===null)return F(n,e);let r=Mn();return pw(r,t,$t(n),e)}function $w(n,e,t,r,i,o){let s=me(null);try{let a=null;i&Yn.SignalBased&&(a=e[r][ev]),a!==null&&a.transformFn!==void 0&&(o=a.transformFn(o)),i&Yn.HasDecoratorInputTransform&&(o=n.inputTransforms[r].call(e,o)),n.setInput!==null?n.setInput(e,a,o,t,r):V_(e,a,r,o)}finally{me(s)}}function bA(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)kr(~i);else{let o=i,s=t[++r],a=t[++r];mS(s,o);let c=e[o];a(2,c)}}}finally{kr(-1)}}function Xu(n,e,t,r,i,o,s,a,c,l,h){let p=e.blueprint.slice();return p[An]=i,p[Q]=r|4|128|8|64,(l!==null||n&&n[Q]&2048)&&(p[Q]|=2048),q_(p),p[lt]=p[ws]=n,p[Zn]=t,p[sn]=s||n&&n[sn],p[Tt]=a||n&&n[Tt],p[Ri]=c||n&&n[Ri]||null,p[Gt]=o,p[zu]=QS(),p[wu]=h,p[k_]=l,p[Tn]=e.type==2?n[Tn]:p,p}function ec(n,e,t,r,i){let o=n.data[e];if(o===null)o=SA(n,e,t,r,i),gS()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=r,o.attrs=i;let s=lS();o.injectorIndex=s===null?-1:s.injectorIndex}return Ds(o,!0),o}function SA(n,e,t,r,i){let o=Q_(),s=Y_(),a=s?o:o&&o.parent,c=n.data[e]=RA(n,a,t,e,r,i);return n.firstChild===null&&(n.firstChild=c),o!==null&&(s?o.child==null&&c.parent!==null&&(o.child=c):o.next===null&&(o.next=c,c.prev=o)),c}function Hw(n,e,t,r){if(t===0)return-1;let i=e.length;for(let o=0;o<t;o++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function qw(n,e,t,r,i){let o=Ku(),s=r&2;try{kr(-1),s&&e.length>Jn&&Uw(n,e,Jn,!1),Kn(s?2:0,i),t(r,i)}finally{kr(o),Kn(s?3:1,i)}}function zw(n,e,t){if(F_(e)){let r=me(null);try{let i=e.directiveStart,o=e.directiveEnd;for(let s=i;s<o;s++){let a=n.data[s];if(a.contentQueries){let c=t[s];a.contentQueries(1,c,s)}}}finally{me(r)}}}function Gw(n,e,t){K_()&&(jA(n,e,t,an(t,e)),(t.flags&64)===64&&Zw(n,e,t))}function Ww(n,e,t=an){let r=e.localNames;if(r!==null){let i=e.index+1;for(let o=0;o<r.length;o+=2){let s=r[o+1],a=s===-1?t(e,n):n[s];n[i++]=a}}}function Kw(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=Xh(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function Xh(n,e,t,r,i,o,s,a,c,l,h){let p=Jn+r,m=p+i,v=AA(p,m),M=typeof l=="function"?l():l;return v[ae]={type:n,blueprint:v,template:t,queries:null,viewQuery:a,declTNode:e,data:v.slice().fill(null,p),bindingStartIndex:p,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:c,consts:M,incompleteFirstPass:!1,ssrId:h}}function AA(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:ji);return t}function xA(n,e,t,r){let o=r.get(nA,Aw)||t===on.ShadowDom,s=n.selectRootElement(e,o);return MA(s),s}function MA(n){NA(n)}var NA=()=>null;function RA(n,e,t,r,i,o){let s=e?e.injectorIndex:-1,a=0;return aS()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function t_(n,e,t,r,i){for(let o in e){if(!e.hasOwnProperty(o))continue;let s=e[o];if(s===void 0)continue;r??={};let a,c=Yn.None;Array.isArray(s)?(a=s[0],c=s[1]):a=s;let l=o;if(i!==null){if(!i.hasOwnProperty(o))continue;l=i[o]}n===0?n_(r,t,l,a,c):n_(r,t,l,a)}return r}function n_(n,e,t,r,i){let o;n.hasOwnProperty(t)?(o=n[t]).push(e,r):o=n[t]=[e,r],i!==void 0&&o.push(i)}function PA(n,e,t){let r=e.directiveStart,i=e.directiveEnd,o=n.data,s=e.attrs,a=[],c=null,l=null;for(let h=r;h<i;h++){let p=o[h],m=t?t.get(p):null,v=m?m.inputs:null,M=m?m.outputs:null;c=t_(0,p.inputs,h,c,v),l=t_(1,p.outputs,h,l,M);let N=c!==null&&s!==null&&!Nh(e)?KA(c,h,s):null;a.push(N)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}function kA(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function OA(n,e,t,r,i,o,s,a){let c=an(e,t),l=e.inputs,h;!a&&l!=null&&(h=l[r])?(ef(n,t,h,r,i),Ph(e)&&FA(t,e.index)):e.type&3?(r=kA(r),i=s!=null?s(i,e.value||"",r):i,o.setProperty(c,r,i)):e.type&12}function FA(n,e){let t=Es(e,n);t[Q]&16||(t[Q]|=64)}function Qw(n,e,t,r){if(K_()){let i=r===null?null:{"":-1},o=UA(n,t),s,a;o===null?s=a=null:[s,a]=o,s!==null&&Yw(n,e,t,s,i,a),i&&$A(t,r,i)}t.mergedAttrs=Mh(t.mergedAttrs,t.attrs)}function Yw(n,e,t,r,i,o){for(let l=0;l<r.length;l++)MS(lw(t,e),n,r[l].type);qA(t,n.data.length,r.length);for(let l=0;l<r.length;l++){let h=r[l];h.providersResolver&&h.providersResolver(h)}let s=!1,a=!1,c=Hw(n,e,r.length,null);for(let l=0;l<r.length;l++){let h=r[l];t.mergedAttrs=Mh(t.mergedAttrs,h.hostAttrs),zA(n,t,e,c,h),HA(c,h,i),h.contentQueries!==null&&(t.flags|=4),(h.hostBindings!==null||h.hostAttrs!==null||h.hostVars!==0)&&(t.flags|=64);let p=h.type.prototype;!s&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),s=!0),!a&&(p.ngOnChanges||p.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}PA(n,t,o)}function LA(n,e,t,r,i){let o=i.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;VA(s)!=a&&s.push(a),s.push(t,r,o)}}function VA(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function jA(n,e,t,r){let i=t.directiveStart,o=t.directiveEnd;Ph(t)&&GA(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||lw(t,e),Fr(r,e);let s=t.initialInputs;for(let a=i;a<o;a++){let c=n.data[a],l=ys(e,n,a,t);if(Fr(l,e),s!==null&&WA(e,a-i,l,c,t,s),Is(c)){let h=Es(t.index,e);h[Zn]=ys(e,n,a,t)}}}function Zw(n,e,t){let r=t.directiveStart,i=t.directiveEnd,o=t.index,s=yS();try{kr(o);for(let a=r;a<i;a++){let c=n.data[a],l=e[a];nh(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&BA(c,l)}}finally{kr(-1),nh(s)}}function BA(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function UA(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let o=0;o<t.length;o++){let s=t[o];if(Tb(e,s.selectors,!1))if(r||(r=[]),Is(s))if(s.findHostDirectiveDefs!==null){let a=[];i=i||new Map,s.findHostDirectiveDefs(s,a,i),r.unshift(...a,s);let c=a.length;hh(n,e,c)}else r.unshift(s),hh(n,e,0);else i=i||new Map,s.findHostDirectiveDefs?.(s,r,i),r.push(s)}return r===null?null:[r,i]}function hh(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function $A(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let o=t[e[i+1]];if(o==null)throw new te(-301,!1);r.push(e[i],o)}}}function HA(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;Is(e)&&(t[""]=n)}}function qA(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function zA(n,e,t,r,i){n.data[r]=i;let o=i.factory||(i.factory=hs(i.type,!0)),s=new ms(o,Is(i),ze);n.blueprint[r]=s,t[r]=s,LA(n,e,r,Hw(n,t,i.hostVars,ji),i)}function GA(n,e,t){let r=an(e,n),i=Kw(t),o=n[sn].rendererFactory,s=16;t.signals?s=4096:t.onPush&&(s=64);let a=tc(n,Xu(n,i,null,s,r,e,null,o.createRenderer(r,t),null,null,null));n[e.index]=a}function WA(n,e,t,r,i,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;){let c=s[a++],l=s[a++],h=s[a++],p=s[a++];$w(r,t,c,l,h,p)}}function KA(n,e,t){let r=null,i=0;for(;i<t.length;){let o=t[i];if(o===0){i+=4;continue}else if(o===5){i+=2;continue}if(typeof o=="number")break;if(n.hasOwnProperty(o)){r===null&&(r=[]);let s=n[o];for(let a=0;a<s.length;a+=3)if(s[a]===e){r.push(o,s[a+1],s[a+2],t[i+1]);break}}i+=2}return r}function Jw(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function Xw(n,e){let t=n.contentQueries;if(t!==null){let r=me(null);try{for(let i=0;i<t.length;i+=2){let o=t[i],s=t[i+1];if(s!==-1){let a=n.data[s];X_(o),a.contentQueries(2,e[s],s)}}}finally{me(r)}}}function tc(n,e){return n[gs]?n[Uv][Ht]=e:n[gs]=e,n[Uv]=e,e}function fh(n,e,t){X_(0);let r=me(null);try{e(n,t)}finally{me(r)}}function QA(n,e){let t=n[Ri],r=t?t.get(bn,null):null;r&&r.handleError(e)}function ef(n,e,t,r,i){for(let o=0;o<t.length;){let s=t[o++],a=t[o++],c=t[o++],l=e[s],h=n.data[s];$w(h,l,r,a,c,i)}}function eI(n,e,t){let r=tS(e,n);cA(n[Tt],r,t)}function YA(n,e){let t=Es(e,n),r=t[ae];ZA(r,t);let i=t[An];i!==null&&t[wu]===null&&(t[wu]=Gh(i,t[Ri])),tf(r,t,t[Zn])}function ZA(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function tf(n,e,t){Oh(e);try{let r=n.viewQuery;r!==null&&fh(1,r,t);let i=n.template;i!==null&&qw(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[ki]?.finishViewCreation(n),n.staticContentQueries&&Xw(n,e),n.staticViewQueries&&fh(2,n.viewQuery,t);let o=n.components;o!==null&&JA(e,o)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[Q]&=-5,Fh()}}function JA(n,e){for(let t=0;t<e.length;t++)YA(n,e[t])}function XA(n,e,t,r){let i=me(null);try{let o=e.tView,a=n[Q]&4096?4096:16,c=Xu(n,o,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=n[e.index];c[Pi]=l;let h=n[ki];return h!==null&&(c[ki]=h.createEmbeddedView(o)),tf(o,c,t),c}finally{me(i)}}function r_(n,e){return!e||e.firstChild===null||Ew(n)}function ex(n,e,t,r=!0){let i=e[ae];if(fA(i,e,n,t),r){let s=dh(t,n),a=e[Tt],c=Lw(a,n[Rr]);c!==null&&dA(i,n[Gt],a,e,c,s)}let o=e[wu];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function Ru(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&r.push(Cn(o)),xn(o)&&tx(o,r);let s=t.type;if(s&8)Ru(n,e,t.child,r);else if(s&32){let a=Qh(t,e),c;for(;c=a();)r.push(c)}else if(s&16){let a=Vw(e,t);if(Array.isArray(a))r.push(...a);else{let c=Pr(e[Tn]);Ru(c[ae],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function tx(n,e){for(let t=Nt;t<n.length;t++){let r=n[t],i=r[ae].firstChild;i!==null&&Ru(r[ae],r,i,e)}n[Rr]!==n[An]&&e.push(n[Rr])}var tI=[];function nx(n){return n[Mt]??rx(n)}function rx(n){let e=tI.pop()??Object.create(ox);return e.lView=n,e}function ix(n){n.lView[Mt]!==n&&(n.lView=null,tI.push(n))}var ox=It(De({},gd),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{Wu(n.lView)},consumerOnSignalRead(){this.lView[Mt]=this}});function sx(n){let e=n[Mt]??Object.create(ax);return e.lView=n,e}var ax=It(De({},gd),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{let e=Pr(n.lView);for(;e&&!nI(e[ae]);)e=Pr(e);e&&z_(e)},consumerOnSignalRead(){this.lView[Mt]=this}});function nI(n){return n.type!==2}var ux=100;function rI(n,e=!0,t=0){let r=n[sn],i=r.rendererFactory,o=!1;o||i.begin?.();try{cx(n,t)}catch(s){throw e&&QA(n,s),s}finally{o||(i.end?.(),r.inlineEffectRunner?.flush())}}function cx(n,e){let t=Z_();try{Hv(!0),ph(n,e);let r=0;for(;Gu(n);){if(r===ux)throw new te(103,!1);r++,ph(n,1)}}finally{Hv(t)}}function lx(n,e,t,r){let i=e[Q];if((i&256)===256)return;let o=!1,s=!1;!o&&e[sn].inlineEffectRunner?.flush(),Oh(e);let a=!0,c=null,l=null;o||(nI(n)?(l=nx(e),c=md(l)):tv()===null?(a=!1,l=sx(e),c=md(l)):e[Mt]&&(vd(e[Mt]),e[Mt]=null));try{q_(e),fS(n.bindingStartIndex),t!==null&&qw(n,e,t,2,r);let h=(i&3)===3;if(!o)if(h){let v=n.preOrderCheckHooks;v!==null&&pu(e,v,null)}else{let v=n.preOrderHooks;v!==null&&gu(e,v,0,null),Vd(e,0)}if(s||dx(e),iI(e,0),n.contentQueries!==null&&Xw(n,e),!o)if(h){let v=n.contentCheckHooks;v!==null&&pu(e,v)}else{let v=n.contentHooks;v!==null&&gu(e,v,1),Vd(e,1)}bA(n,e);let p=n.components;p!==null&&sI(e,p,0);let m=n.viewQuery;if(m!==null&&fh(2,m,r),!o)if(h){let v=n.viewCheckHooks;v!==null&&pu(e,v)}else{let v=n.viewHooks;v!==null&&gu(e,v,2),Vd(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Ld]){for(let v of e[Ld])v();e[Ld]=null}o||(e[Q]&=-73)}catch(h){throw o||Wu(e),h}finally{l!==null&&(nv(l,c),a&&ix(l)),Fh()}}function iI(n,e){for(let t=Tw(n);t!==null;t=Cw(t))for(let r=Nt;r<t.length;r++){let i=t[r];oI(i,e)}}function dx(n){for(let e=Tw(n);e!==null;e=Cw(e)){if(!(e[Q]&Du.HasTransplantedViews))continue;let t=e[Eu];for(let r=0;r<t.length;r++){let i=t[r];z_(i)}}}function hx(n,e,t){let r=Es(e,n);oI(r,t)}function oI(n,e){kh(n)&&ph(n,e)}function ph(n,e){let r=n[ae],i=n[Q],o=n[Mt],s=!!(e===0&&i&16);if(s||=!!(i&64&&e===0),s||=!!(i&1024),s||=!!(o?.dirty&&yd(o)),s||=!1,o&&(o.dirty=!1),n[Q]&=-9217,s)lx(r,n,r.template,n[Zn]);else if(i&8192){iI(n,1);let a=r.components;a!==null&&sI(n,a,1)}}function sI(n,e,t){for(let r=0;r<e.length;r++)hx(n,e[r],t)}function aI(n,e){let t=Z_()?64:1088;for(n[sn].changeDetectionScheduler?.notify(e);n;){n[Q]|=t;let r=Pr(n);if(Xd(n)&&!r)return n;n=r}return null}var vs=class{get rootNodes(){let e=this._lView,t=e[ae];return Ru(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Zn]}set context(e){this._lView[Zn]=e}get destroyed(){return(this._lView[Q]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[lt];if(xn(e)){let t=e[Iu],r=t?t.indexOf(this):-1;r>-1&&(lh(e,r),vu(t,r))}this._attachedToViewContainer=!1}Ow(this._lView[ae],this._lView)}onDestroy(e){G_(this._lView,e)}markForCheck(){aI(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[Q]&=-129}reattach(){th(this._lView),this._lView[Q]|=128}detectChanges(){this._lView[Q]|=1024,rI(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new te(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=Xd(this._lView),t=this._lView[Pi];t!==null&&!e&&Yh(t,this._lView),Pw(this._lView[ae],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new te(902,!1);this._appRef=e;let t=Xd(this._lView),r=this._lView[Pi];r!==null&&!t&&kw(r,this._lView),th(this._lView)}},nf=(()=>{class n{static{this.__NG_ELEMENT_ID__=gx}}return n})(),fx=nf,px=class extends fx{constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){let i=XA(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:r});return new vs(i)}};function gx(){return mx(Mn(),Ze())}function mx(n,e){return n.type&4?new px(e,n,Yu(n,e)):null}var LV=new RegExp(`^(\\d+)*(${eA}|${XS})*(.*)`);var yx=()=>null;function i_(n,e){return yx(n,e)}var Oi=class{},rf=new K("",{providedIn:"root",factory:()=>!1});var uI=new K(""),cI=new K(""),gh=class{},Pu=class{};function vx(n){let e=Error(`No component factory found for ${Dt(n)}.`);return e[_x]=n,e}var _x="ngComponent";var mh=class{resolveComponentFactory(e){throw vx(e)}},_s=class{static{this.NULL=new mh}},Fi=class{};var wx=(()=>{class n{static{this.\u0275prov=Y({token:n,providedIn:"root",factory:()=>null})}}return n})();function yh(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)i=xv(i,a);else if(o==2){let c=a,l=e[++s];r=xv(r,c+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var vh=class extends _s{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=Ni(e);return new ku(t,this.ngModule)}};function o_(n,e){let t=[];for(let r in n){if(!n.hasOwnProperty(r))continue;let i=n[r];if(i===void 0)continue;let o=Array.isArray(i),s=o?i[0]:i,a=o?i[1]:Yn.None;e?t.push({propName:s,templateName:r,isSignal:(a&Yn.SignalBased)!==0}):t.push({propName:s,templateName:r})}return t}function Ix(n){let e=n.toLowerCase();return e==="svg"?Xb:e==="math"?eS:null}var ku=class extends Pu{get inputs(){let e=this.componentDef,t=e.inputTransforms,r=o_(e.inputs,!0);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return o_(this.componentDef.outputs,!1)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=Ab(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let o=me(null);try{i=i||this.ngModule;let s=i instanceof Nr?i:i?.injector;s&&this.componentDef.getStandaloneInjector!==null&&(s=this.componentDef.getStandaloneInjector(s)||s);let a=s?new rh(e,s):e,c=a.get(Fi,null);if(c===null)throw new te(407,!1);let l=a.get(wx,null),h=a.get(Oi,null),p={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,changeDetectionScheduler:h},m=c.createRenderer(null,this.componentDef),v=this.componentDef.selectors[0][0]||"div",M=r?xA(m,r,this.componentDef.encapsulation,a):Rw(m,v,Ix(v)),N=512;this.componentDef.signals?N|=4096:this.componentDef.onPush||(N|=16);let R=null;M!==null&&(R=Gh(M,a,!0));let B=Xh(0,null,null,1,0,null,null,null,null,null,null),$=Xu(null,B,null,N,null,null,p,m,a,null,R);Oh($);let L,z,W=null;try{let G=this.componentDef,I,y=null;G.findHostDirectiveDefs?(I=[],y=new Map,G.findHostDirectiveDefs(G,I,y),I.push(G)):I=[G];let w=Ex($,M);W=Dx(w,M,G,I,$,p,m),z=H_(B,Jn),M&&bx(m,G,M,r),t!==void 0&&Sx(z,this.ngContentSelectors,t),L=Cx(W,G,I,y,$,[Ax]),tf(B,$,null)}catch(G){throw W!==null&&uh(W),uh($),G}finally{Fh()}return new _h(this.componentType,L,Yu(z,$),$,z)}finally{me(o)}}},_h=class extends gh{constructor(e,t,r,i,o){super(),this.location=r,this._rootLView=i,this._tNode=o,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new vs(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let o=this._rootLView;ef(o[ae],o,i,e,t),this.previousInputValues.set(e,t);let s=Es(this._tNode.index,o);aI(s,1)}}get injector(){return new Mr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function Ex(n,e){let t=n[ae],r=Jn;return n[r]=e,ec(t,r,2,"#host",null)}function Dx(n,e,t,r,i,o,s){let a=i[ae];Tx(r,n,e,s);let c=null;e!==null&&(c=Gh(e,i[Ri]));let l=o.rendererFactory.createRenderer(e,t),h=16;t.signals?h=4096:t.onPush&&(h=64);let p=Xu(i,Kw(t),null,h,i[n.index],n,o,l,null,null,c);return a.firstCreatePass&&hh(a,n,r.length-1),tc(i,p),i[n.index]=p}function Tx(n,e,t,r){for(let i of n)e.mergedAttrs=Mh(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(yh(e,e.mergedAttrs,!0),t!==null&&Bw(r,t,e))}function Cx(n,e,t,r,i,o){let s=Mn(),a=i[ae],c=an(s,i);Yw(a,i,s,t,null,r);for(let h=0;h<t.length;h++){let p=s.directiveStart+h,m=ys(i,a,p,s);Fr(m,i)}Zw(a,i,s),c&&Fr(c,i);let l=ys(i,a,s.directiveStart+s.componentOffset,s);if(n[Zn]=i[Zn]=l,o!==null)for(let h of o)h(l,e);return zw(a,s,i),l}function bx(n,e,t,r){if(r)Wd(n,t,["ng-version","18.2.13"]);else{let{attrs:i,classes:o}=xb(e.selectors[0]);i&&Wd(n,t,i),o&&o.length>0&&jw(n,t,o.join(" "))}}function Sx(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let o=t[i];r.push(o!=null?Array.from(o):null)}}function Ax(){let n=Mn();jh(Ze()[ae],n)}var of=(()=>{class n{static{this.__NG_ELEMENT_ID__=xx}}return n})();function xx(){let n=Mn();return Nx(n,Ze())}var Mx=of,lI=class extends Mx{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Yu(this._hostTNode,this._hostLView)}get injector(){return new Mr(this._hostTNode,this._hostLView)}get parentInjector(){let e=Bh(this._hostTNode,this._hostLView);if(aw(e)){let t=bu(e,this._hostLView),r=Cu(e),i=t[ae].data[r+8];return new Mr(i,t)}else return new Mr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=s_(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-Nt}createEmbeddedView(e,t,r){let i,o;typeof r=="number"?i=r:r!=null&&(i=r.index,o=r.injector);let s=i_(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,i,r_(this._hostTNode,s)),a}createComponent(e,t,r,i,o){let s=e&&!Qb(e),a;if(s)a=t;else{let M=t||{};a=M.index,r=M.injector,i=M.projectableNodes,o=M.environmentInjector||M.ngModuleRef}let c=s?e:new ku(Ni(e)),l=r||this.parentInjector;if(!o&&c.ngModule==null){let N=(s?l:this.parentInjector).get(Nr,null);N&&(o=N)}let h=Ni(c.componentType??{}),p=i_(this._lContainer,h?.id??null),m=p?.firstChild??null,v=c.create(l,i,m,o);return this.insertImpl(v.hostView,a,r_(this._hostTNode,p)),v}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(nS(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[lt],l=new lI(c,c[Gt],c[lt]);l.detach(l.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return ex(s,i,o,r),e.attachToViewContainerRef(),I_(Hd(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=s_(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=lh(this._lContainer,t);r&&(vu(Hd(this._lContainer),t),Ow(r[ae],r))}detach(e){let t=this._adjustIndex(e,-1),r=lh(this._lContainer,t);return r&&vu(Hd(this._lContainer),t)!=null?new vs(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function s_(n){return n[Iu]}function Hd(n){return n[Iu]||(n[Iu]=[])}function Nx(n,e){let t,r=e[n.index];return xn(r)?t=r:(t=Jw(r,e,null,n),e[n.index]=t,tc(e,t)),Px(t,e,n,r),new lI(t,n,e)}function Rx(n,e){let t=n[Tt],r=t.createComment(""),i=an(e,n),o=Lw(t,i);return Nu(t,o,r,vA(t,i),!1),r}var Px=Fx,kx=()=>!1;function Ox(n,e,t){return kx(n,e,t)}function Fx(n,e,t,r){if(n[Rr])return;let i;t.type&8?i=Cn(r):i=Rx(e,t),n[Rr]=i}function Lx(n){let e=[],t=new Map;function r(i){let o=t.get(i);if(!o){let s=n(i);t.set(i,o=s.then(Ux))}return o}return Ou.forEach((i,o)=>{let s=[];i.templateUrl&&s.push(r(i.templateUrl).then(l=>{i.template=l}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let l=i.styles.length,h=i.styleUrls;i.styleUrls.forEach((p,m)=>{a.push(""),s.push(r(p).then(v=>{a[l+m]=v,h.splice(h.indexOf(p),1),h.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&s.push(r(i.styleUrl).then(l=>{a.push(l),i.styleUrl=void 0}));let c=Promise.all(s).then(()=>$x(o));e.push(c)}),jx(),Promise.all(e).then(()=>{})}var Ou=new Map,Vx=new Set;function jx(){let n=Ou;return Ou=new Map,n}function Bx(){return Ou.size===0}function Ux(n){return typeof n=="string"?n:n.text()}function $x(n){Vx.delete(n)}var Li=class{},wh=class{};var Fu=class extends Li{constructor(e,t,r,i=!0){super(),this.ngModuleType=e,this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new vh(this);let o=Pb(e);this._bootstrapComponents=sA(o.bootstrap),this._r3Injector=yw(e,t,[{provide:Li,useValue:this},{provide:_s,useValue:this.componentFactoryResolver},...r],Dt(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Ih=class extends wh{constructor(e){super(),this.moduleType=e}create(e){return new Fu(this.moduleType,e,[])}};function Hx(n,e,t){return new Fu(n,e,t,!1)}function dI(n){return zx(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function qx(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function zx(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function Lu(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function Gx(n,e,t,r){let i=Lu(n,e,t);return Lu(n,e+1,r)||i}function Wx(n){return(n.flags&32)===32}function Kx(n,e,t,r,i,o,s,a,c){let l=e.consts,h=ec(e,n,4,s||null,a||null);Qw(e,t,h,Tu(l,c)),jh(e,h);let p=h.tView=Xh(2,h,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,h),p.queries=e.queries.embeddedTView(h)),h}function Qx(n,e,t,r,i,o,s,a,c,l){let h=t+Jn,p=e.firstCreatePass?Kx(h,e,n,r,i,o,s,a,c):e.data[h];Ds(p,!1);let m=Yx(e,n,p,t);Lh()&&Zh(e,n,m,p),Fr(m,n);let v=Jw(m,n,m,p);return n[h]=v,tc(n,v),Ox(v,p,n),L_(p)&&Gw(e,n,p),c!=null&&Ww(n,p,l),p}function Ct(n,e,t,r,i,o,s,a){let c=Ze(),l=Vi(),h=Tu(l.consts,o);return Qx(c,l,n,e,t,r,i,h,s,a),Ct}var Yx=Zx;function Zx(n,e,t,r){return Vh(!0),e[Tt].createComment("")}var as=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(as||{}),Jx=(()=>{class n{constructor(){this.impl=null}execute(){this.impl?.execute()}static{this.\u0275prov=Y({token:n,providedIn:"root",factory:()=>new n})}}return n})(),a_=class n{constructor(){this.ngZone=ye(fe),this.scheduler=ye(Oi),this.errorHandler=ye(bn,{optional:!0}),this.sequences=new Set,this.deferredRegistrations=new Set,this.executing=!1}static{this.PHASES=[as.EarlyRead,as.Write,as.MixedReadWrite,as.Read]}execute(){this.executing=!0;for(let e of n.PHASES)for(let t of this.sequences)if(!(t.erroredOrDestroyed||!t.hooks[e]))try{t.pipelinedValue=this.ngZone.runOutsideAngular(()=>t.hooks[e](t.pipelinedValue))}catch(r){t.erroredOrDestroyed=!0,this.errorHandler?.handleError(r)}this.executing=!1;for(let e of this.sequences)e.afterRun(),e.once&&(this.sequences.delete(e),e.destroy());for(let e of this.deferredRegistrations)this.sequences.add(e);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear()}register(e){this.executing?this.deferredRegistrations.add(e):(this.sequences.add(e),this.scheduler.notify(6))}unregister(e){this.executing&&this.sequences.has(e)?(e.erroredOrDestroyed=!0,e.pipelinedValue=void 0,e.once=!0):(this.sequences.delete(e),this.deferredRegistrations.delete(e))}static{this.\u0275prov=Y({token:n,providedIn:"root",factory:()=>new n})}};function Xx(n,e,t,r){return Lu(n,J_(),t)?e+ls(t)+r:ji}function eM(n,e,t,r,i,o){let s=hS(),a=Gx(n,s,t,i);return pS(2),a?e+ls(t)+r+ls(i)+o:ji}function dt(n,e,t){let r=Ze(),i=J_();if(Lu(r,i,e)){let o=Vi(),s=_S();OA(o,s,r,n,e,r[Tt],t,!1)}return dt}function u_(n,e,t,r,i){let o=e.inputs,s=i?"class":"style";ef(n,t,o[s],s,r)}function tM(n,e,t,r,i,o){let s=e.consts,a=Tu(s,i),c=ec(e,n,2,r,a);return Qw(e,t,c,Tu(s,o)),c.attrs!==null&&yh(c,c.attrs,!1),c.mergedAttrs!==null&&yh(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function pe(n,e,t,r){let i=Ze(),o=Vi(),s=Jn+n,a=i[Tt],c=o.firstCreatePass?tM(s,o,i,e,t,r):o.data[s],l=nM(o,i,c,a,e,n);i[s]=l;let h=L_(c);return Ds(c,!0),Bw(a,l,c),!Wx(c)&&Lh()&&Zh(o,i,l,c),iS()===0&&Fr(l,i),oS(),h&&(Gw(o,i,c),zw(o,c,i)),r!==null&&Ww(i,c),pe}function oe(){let n=Mn();Y_()?dS():(n=n.parent,Ds(n,!1));let e=n;uS(e)&&cS(),sS();let t=Vi();return t.firstCreatePass&&(jh(t,n),F_(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&TS(e)&&u_(t,e,Ze(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&CS(e)&&u_(t,e,Ze(),e.stylesWithoutHost,!1),oe}function J(n,e,t,r){return pe(n,e,t,r),oe(),J}var nM=(n,e,t,r,i,o)=>(Vh(!0),Rw(r,i,wS()));var Vu="en-US";var rM=Vu;function iM(n){typeof n=="string"&&(rM=n.toLowerCase().replace(/_/g,"-"))}function ne(n,e=""){let t=Ze(),r=Vi(),i=n+Jn,o=r.firstCreatePass?ec(r,i,1,e,null):r.data[i],s=oM(r,t,o,e,n);t[i]=s,Lh()&&Zh(r,t,s,o),Ds(o,!1)}var oM=(n,e,t,r,i)=>(Vh(!0),uA(e[Tt],r));function mt(n){return _e("",n,""),mt}function _e(n,e,t){let r=Ze(),i=Xx(r,n,e,t);return i!==ji&&eI(r,Ku(),i),_e}function Ts(n,e,t,r,i){let o=Ze(),s=eM(o,n,e,t,r,i);return s!==ji&&eI(o,Ku(),s),Ts}var du=null;function sM(n){du!==null&&(n.defaultEncapsulation!==du.defaultEncapsulation||n.preserveWhitespaces!==du.preserveWhitespaces)||(du=n)}var Lr=class{constructor(e){this.full=e;let t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}},hI=new Lr("18.2.13");var sf=new K(""),Cs=new K(""),nc=(()=>{class n{constructor(t,r,i){this._ngZone=t,this.registry=r,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,af||(aM(i),i.addToWindow(r)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{fe.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}isStable(){return this._isZoneStable&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb()}});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>r.updateCb&&r.updateCb(t)?(clearTimeout(r.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,r,i){let o=-1;r&&r>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(s=>s.timeoutId!==o),t()},r)),this._callbacks.push({doneCb:t,timeoutId:o,updateCb:i})}whenStable(t,r,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,r,i),this._runCallbacksIfReady()}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,r,i){return[]}static{this.\u0275fac=function(r){return new(r||n)(F(fe),F(rc),F(Cs))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})(),rc=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,r){this._applications.set(t,r)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,r=!0){return af?.findTestabilityInTree(this,t,r)??null}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"platform"})}}return n})();function aM(n){af=n}var af;function uf(n){return!!n&&typeof n.then=="function"}function fI(n){return!!n&&typeof n.subscribe=="function"}var uM=new K(""),pI=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r}),this.appInits=ye(uM,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let o=i();if(uf(o))t.push(o);else if(fI(o)){let s=new Promise((a,c)=>{o.subscribe({complete:a,error:c})});t.push(s)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),cM=new K("");function lM(){rv(()=>{throw new te(600,!1)})}function dM(n){return n.isBoundToModule}var hM=10;function fM(n,e,t){try{let r=t();return uf(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}function gI(n,e){return Array.isArray(e)?e.reduce(gI,n):De(De({},n),e)}var Bi=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=ye(GS),this.afterRenderManager=ye(Jx),this.zonelessEnabled=ye(rf),this.dirtyFlags=0,this.deferredDirtyFlags=0,this.externalTestViews=new Set,this.beforeRender=new gt,this.afterTick=new gt,this.componentTypes=[],this.components=[],this.isStable=ye(Qu).hasPendingTasks.pipe(Ce(t=>!t)),this._injector=ye(Nr)}get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}get injector(){return this._injector}bootstrap(t,r){let i=t instanceof Pu;if(!this._injector.get(pI).done){let m=!i&&Rb(t),v=!1;throw new te(405,v)}let s;i?s=t:s=this._injector.get(_s).resolveComponentFactory(t),this.componentTypes.push(s.componentType);let a=dM(s)?void 0:this._injector.get(Li),c=r||s.selector,l=s.create(Or.NULL,[],c,a),h=l.location.nativeElement,p=l.injector.get(sf,null);return p?.registerApplication(h),l.onDestroy(()=>{this.detachView(l.hostView),mu(this.components,l),p?.unregisterApplication(h)}),this._loadComponent(l),l}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){if(this._runningTick)throw new te(101,!1);let t=me(null);try{this._runningTick=!0,this.synchronize()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,me(t),this.afterTick.next()}}synchronize(){let t=null;this._injector.destroyed||(t=this._injector.get(Fi,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let r=0;for(;this.dirtyFlags!==0&&r++<hM;)this.synchronizeOnce(t)}synchronizeOnce(t){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8,this.beforeRender.next(r);for(let{_lView:i,notifyErrorHandler:o}of this._views)pM(i,o,r,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&7)return}else t?.begin?.(),t?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>Gu(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;mu(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);let r=this._injector.get(cM,[]);[...this._bootstrapListeners,...r].forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>mu(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new te(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function mu(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function pM(n,e,t,r){if(!t&&!Gu(n))return;rI(n,e,t&&!r?0:1)}var gM=new K("");function mM(n,e,t){let r=new Ih(t);return Promise.resolve(r)}function c_(n){for(let e=n.length-1;e>=0;e--)if(n[e]!==void 0)return n[e]}var yM=(()=>{class n{constructor(){this.zone=ye(fe),this.changeDetectionScheduler=ye(Oi),this.applicationRef=ye(Bi)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function vM({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new fe(It(De({},mI()),{scheduleInRootZone:t})),[{provide:fe,useFactory:n},{provide:ps,multi:!0,useFactory:()=>{let r=ye(yM,{optional:!0});return()=>r.initialize()}},{provide:ps,multi:!0,useFactory:()=>{let r=ye(_M);return()=>{r.initialize()}}},e===!0?{provide:uI,useValue:!0}:[],{provide:cI,useValue:t??vw}]}function mI(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var _M=(()=>{class n{constructor(){this.subscription=new Qe,this.initialized=!1,this.zone=ye(fe),this.pendingTasks=ye(Qu)}initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{fe.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{fe.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var wM=(()=>{class n{constructor(){this.appRef=ye(Bi),this.taskService=ye(Qu),this.ngZone=ye(fe),this.zonelessEnabled=ye(rf),this.disableScheduling=ye(uI,{optional:!0})??!1,this.zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run,this.schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}],this.subscriptions=new Qe,this.angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Au):null,this.scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(ye(cI,{optional:!0})??!1),this.cancelScheduledCallback=null,this.useMicrotaskScheduler=!1,this.runningTick=!1,this.pendingRenderTaskId=null,this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof xu||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 7:{this.appRef.deferredDirtyFlags|=8;break}case 9:case 8:case 6:case 10:default:this.appRef.dirtyFlags|=8}if(!this.shouldScheduleTick())return;let r=this.useMicrotaskScheduler?Qv:ww;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(){return!(this.disableScheduling||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Au+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(t),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,Qv(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function IM(){return typeof $localize<"u"&&$localize.locale||Vu}var cf=new K("",{providedIn:"root",factory:()=>ye(cf,ie.Optional|ie.SkipSelf)||IM()});var ju=new K("");function hu(n){return!n.moduleRef}function EM(n){let e=hu(n)?n.r3Injector:n.moduleRef.injector,t=e.get(fe);return t.run(()=>{hu(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(bn,null),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:o=>{r.handleError(o)}})}),hu(n)){let o=()=>e.destroy(),s=n.platformInjector.get(ju);s.add(o),e.onDestroy(()=>{i.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(ju);s.add(o),n.moduleRef.onDestroy(()=>{mu(n.allPlatformModules,n.moduleRef),i.unsubscribe(),s.delete(o)})}return fM(r,t,()=>{let o=e.get(pI);return o.runInitializers(),o.donePromise.then(()=>{let s=e.get(cf,Vu);if(iM(s||Vu),hu(n)){let a=e.get(Bi);return n.rootComponent!==void 0&&a.bootstrap(n.rootComponent),a}else return DM(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}function DM(n,e){let t=n.injector.get(Bi);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>t.bootstrap(r));else if(n.instance.ngDoBootstrap)n.instance.ngDoBootstrap(t);else throw new te(-403,!1);e.push(n)}var yI=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,r){let i=r?.scheduleInRootZone,o=()=>zS(r?.ngZone,It(De({},mI({eventCoalescing:r?.ngZoneEventCoalescing,runCoalescing:r?.ngZoneRunCoalescing})),{scheduleInRootZone:i})),s=r?.ignoreChangesOutsideZone,a=[vM({ngZoneFactory:o,ignoreChangesOutsideZone:s}),{provide:Oi,useExisting:wM}],c=Hx(t.moduleType,this.injector,a);return EM({moduleRef:c,allPlatformModules:this._modules,platformInjector:this.injector})}bootstrapModule(t,r=[]){let i=gI({},r);return mM(this.injector,i,t).then(o=>this.bootstrapModuleFactory(o,i))}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new te(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());let t=this._injector.get(ju,null);t&&(t.forEach(r=>r()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static{this.\u0275fac=function(r){return new(r||n)(F(Or))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"platform"})}}return n})(),cs=null,vI=new K("");function TM(n){if(cs&&!cs.get(vI,!1))throw new te(400,!1);lM(),cs=n;let e=n.get(yI);return SM(n),e}function lf(n,e,t=[]){let r=`Platform: ${e}`,i=new K(r);return(o=[])=>{let s=_I();if(!s||s.injector.get(vI,!1)){let a=[...t,...o,{provide:i,useValue:!0}];n?n(a):TM(CM(a,r))}return bM(i)}}function CM(n=[],e){return Or.create({name:e,providers:[{provide:qu,useValue:"platform"},{provide:ju,useValue:new Set([()=>cs=null])},...n]})}function bM(n){let e=_I();if(!e)throw new te(401,!1);return e}function _I(){return cs?.get(yI)??null}function SM(n){n.get(qh,null)?.forEach(t=>t())}function df(){return!1}var Eh=class{constructor(){}supports(e){return dI(e)}create(e){return new Dh(e)}},AM=(n,e)=>e,Dh=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||AM}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,o=null;for(;t||r;){let s=!r||t&&t.currentIndex<l_(r,i,o)?t:r,a=l_(s,i,o),c=s.currentIndex;if(s===r)i--,r=r._nextRemoved;else if(t=t._next,s.previousIndex==null)i++;else{o||(o=[]);let l=a-i,h=c-i;if(l!=h){for(let m=0;m<l;m++){let v=m<o.length?o[m]:o[m]=0,M=v+m;h<=M&&M<l&&(o[m]=v+1)}let p=s.previousIndex;o[p]=h-l}}a!==c&&e(s,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!dI(e))throw new te(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,o,s;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,a),r=!0):(r&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else i=0,qx(e,a=>{s=this._trackByFn(i,a),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,a,s,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,s,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,i)):e=this._addAfter(new Th(t,r),o,i)),e}_verifyReinsertion(e,t,r,i){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return o!==null?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,o=e._nextRemoved;return i===null?this._removalsHead=o:i._nextRemoved=o,o===null?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new Bu),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Bu),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},Th=class{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},Ch=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},Bu=class{constructor(){this.map=new Map}put(e){let t=e.trackById,r=this.map.get(t);r||(r=new Ch,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function l_(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function d_(){return new hf([new Eh])}var hf=(()=>{class n{static{this.\u0275prov=Y({token:n,providedIn:"root",factory:d_})}constructor(t){this.factories=t}static create(t,r){if(r!=null){let i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:r=>n.create(t,r||d_()),deps:[[n,new mb,new Hu]]}}find(t){let r=this.factories.find(i=>i.supports(t));if(r!=null)return r;throw new te(901,!1)}}return n})();var wI=lf(null,"core",[]),II=(()=>{class n{constructor(t){}static{this.\u0275fac=function(r){return new(r||n)(F(Bi))}}static{this.\u0275mod=zt({type:n})}static{this.\u0275inj=qt({})}}return n})();var DI=null;function sc(){return DI}function TI(n){DI??=n}var ic=class{};var Xn=new K("");function CI(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,o]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}var ff=class{constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Pt=(()=>{class n{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;if(!this._differ&&t)if(0)try{}catch{}else this._differ=this._differs.find(t).create(this.ngForTrackBy)}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((i,o,s)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new ff(i.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)r.remove(o===null?void 0:o);else if(o!==null){let a=r.get(o);r.move(a,s),EI(a,i)}});for(let i=0,o=r.length;i<o;i++){let a=r.get(i).context;a.index=i,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{let o=r.get(i.currentIndex);EI(o,i)})}static ngTemplateContextGuard(t,r){return!0}static{this.\u0275fac=function(r){return new(r||n)(ze(of),ze(nf),ze(hf))}}static{this.\u0275dir=b_({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}}return n})();function EI(n,e){n.context.$implicit=e.item}var bI=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=zt({type:n})}static{this.\u0275inj=qt({})}}return n})(),SI="browser",NM="server";function jr(n){return n===NM}var oc=class{};var mf=class extends ic{constructor(){super(...arguments),this.supportsDOMEvents=!0}},yf=class n extends mf{static makeCurrent(){TI(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=PM();return t==null?null:kM(t)}resetBaseElement(){bs=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return CI(document.cookie,e)}},bs=null;function PM(){return bs=bs||document.querySelector("base"),bs?bs.getAttribute("href"):null}function kM(n){return new URL(n,document.baseURI).pathname}var vf=class{addToWindow(e){Sn.getAngularTestability=(r,i=!0)=>{let o=e.findTestabilityInTree(r,i);if(o==null)throw new te(5103,!1);return o},Sn.getAllAngularTestabilities=()=>e.getAllTestabilities(),Sn.getAllAngularRootElements=()=>e.getAllRootElements();let t=r=>{let i=Sn.getAllAngularTestabilities(),o=i.length,s=function(){o--,o==0&&r()};i.forEach(a=>{a.whenStable(s)})};Sn.frameworkStabilizers||(Sn.frameworkStabilizers=[]),Sn.frameworkStabilizers.push(t)}findTestabilityInTree(e,t,r){if(t==null)return null;let i=e.getTestability(t);return i??(r?sc().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},OM=(()=>{class n{build(){return new XMLHttpRequest}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})(),_f=new K(""),NI=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(o=>o.supports(t)),!r)throw new te(5101,!1);return this._eventNameToPlugin.set(t,r),r}static{this.\u0275fac=function(r){return new(r||n)(F(_f),F(fe))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})(),ac=class{constructor(e){this._doc=e}},pf="ng-app-id",RI=(()=>{class n{constructor(t,r,i,o={}){this.doc=t,this.appId=r,this.nonce=i,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=jr(o),this.resetHostNodes()}addStyles(t){for(let r of t)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(t){for(let r of t)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let t=this.styleNodesInDOM;t&&(t.forEach(r=>r.remove()),t.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(let r of this.getAllStyles())this.addStyleToHost(t,r)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(let r of this.hostNodes)this.addStyleToHost(r,t)}onStyleRemoved(t){let r=this.styleRef;r.get(t)?.elements?.forEach(i=>i.remove()),r.delete(t)}collectServerRenderedStyles(){let t=this.doc.head?.querySelectorAll(`style[${pf}="${this.appId}"]`);if(t?.length){let r=new Map;return t.forEach(i=>{i.textContent!=null&&r.set(i.textContent,i)}),r}return null}changeUsageCount(t,r){let i=this.styleRef;if(i.has(t)){let o=i.get(t);return o.usage+=r,o.usage}return i.set(t,{usage:r,elements:[]}),r}getStyleElement(t,r){let i=this.styleNodesInDOM,o=i?.get(r);if(o?.parentNode===t)return i.delete(r),o.removeAttribute(pf),o;{let s=this.doc.createElement("style");return this.nonce&&s.setAttribute("nonce",this.nonce),s.textContent=r,this.platformIsServer&&s.setAttribute(pf,this.appId),t.appendChild(s),s}}addStyleToHost(t,r){let i=this.getStyleElement(t,r),o=this.styleRef,s=o.get(r)?.elements;s?s.push(i):o.set(r,{elements:[i],usage:1})}resetHostNodes(){let t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(r){return new(r||n)(F(Xn),F(Zu),F(zh,8),F(Rt))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})(),gf={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},If=/%COMP%/g,PI="%COMP%",FM=`_nghost-${PI}`,LM=`_ngcontent-${PI}`,VM=!0,jM=new K("",{providedIn:"root",factory:()=>VM});function BM(n){return LM.replace(If,n)}function UM(n){return FM.replace(If,n)}function kI(n,e){return e.map(t=>t.replace(If,n))}var AI=(()=>{class n{constructor(t,r,i,o,s,a,c,l=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=a,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=jr(a),this.defaultRenderer=new Ss(t,s,c,this.platformIsServer)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===on.ShadowDom&&(r=It(De({},r),{encapsulation:on.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof uc?i.applyToHost(t):i instanceof As&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,o=i.get(r.id);if(!o){let s=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,p=this.platformIsServer;switch(r.encapsulation){case on.Emulated:o=new uc(c,l,r,this.appId,h,s,a,p);break;case on.ShadowDom:return new wf(c,l,t,r,s,a,this.nonce,p);default:o=new As(c,l,r,h,s,a,p);break}i.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(r){return new(r||n)(F(NI),F(RI),F(Zu),F(jM),F(Xn),F(Rt),F(fe),F(zh))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})(),Ss=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(gf[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(xI(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(xI(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new te(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let o=gf[i];o?e.setAttributeNS(o,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=gf[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Vr.DashCase|Vr.Important)?e.style.setProperty(t,r,i&Vr.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Vr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=sc().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function xI(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var wf=class extends Ss{constructor(e,t,r,i,o,s,a,c){super(e,o,s,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=kI(i.id,i.styles);for(let h of l){let p=document.createElement("style");a&&p.setAttribute("nonce",a),p.textContent=h,this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},As=class extends Ss{constructor(e,t,r,i,o,s,a,c){super(e,o,s,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?kI(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},uc=class extends As{constructor(e,t,r,i,o,s,a,c){let l=i+"-"+r.id;super(e,t,r,o,s,a,c,l),this.contentAttr=BM(l),this.hostAttr=UM(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},$M=(()=>{class n extends ac{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}static{this.\u0275fac=function(r){return new(r||n)(F(Xn))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})(),MI=["alt","control","meta","shift"],HM={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},qM={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},zM=(()=>{class n extends ac{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i){let o=n.parseEventName(r),s=n.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>sc().onAndCancel(t,o.domEventName,s))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let o=n._normalizeKey(r.pop()),s="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),s="code."),MI.forEach(l=>{let h=r.indexOf(l);h>-1&&(r.splice(h,1),s+=l+".")}),s+=o,r.length!=0||o.length===0)return null;let c={};return c.domEventName=i,c.fullKey=s,c}static matchEventFullKeyCode(t,r){let i=HM[t.key]||t.key,o="";return r.indexOf("code.")>-1&&(i=t.code,o="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),MI.forEach(s=>{if(s!==i){let a=qM[s];a(t)&&(o+=s+".")}}),o+=i,o===r)}static eventCallback(t,r,i){return o=>{n.matchEventFullKeyCode(o,t)&&i.runGuarded(()=>r(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static{this.\u0275fac=function(r){return new(r||n)(F(Xn))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})();function GM(){yf.makeCurrent()}function WM(){return new bn}function KM(){return Sw(document),document}var QM=[{provide:Rt,useValue:SI},{provide:qh,useValue:GM,multi:!0},{provide:Xn,useFactory:KM,deps:[]}],OI=lf(wI,"browser",QM),YM=new K(""),ZM=[{provide:Cs,useClass:vf,deps:[]},{provide:sf,useClass:nc,deps:[fe,rc,Cs]},{provide:nc,useClass:nc,deps:[fe,rc,Cs]}],JM=[{provide:qu,useValue:"root"},{provide:bn,useFactory:WM,deps:[]},{provide:_f,useClass:$M,multi:!0,deps:[Xn,fe,Rt]},{provide:_f,useClass:zM,multi:!0,deps:[Xn]},AI,RI,NI,{provide:Fi,useExisting:AI},{provide:oc,useClass:OM,deps:[]},[]],FI=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:Zu,useValue:t.appId}]}}static{this.\u0275fac=function(r){return new(r||n)(F(YM,12))}}static{this.\u0275mod=zt({type:n})}static{this.\u0275inj=qt({providers:[...JM,...ZM],imports:[bI,II]})}}return n})();var eN="firebase",tN="10.14.1";zn(eN,tN,"app");var xs=new Lr("ANGULARFIRE2_VERSION");var nN=(n,e)=>{let t=e?[e]:Xy(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(s=>{r.includes(s)||r.push(s)})}),r},Br=class{constructor(){return nN(rN)}},rN="app-check";function Ef(){}var cc=class{zone;delegate;constructor(e,t=xd){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(s){i.runGuarded(()=>{e.apply(this,[s])})};return this.delegate.schedule(o,t,r)}},Df=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Ef,{},Ef,Ef)),t.pipe(Od({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},lc=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new cc(Zone.current)),this.insideAngular=t.run(()=>new cc(Zone.current,ns)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(F(fe))};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function iN(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function yt(n){return oN(iN())(n)}function oN(n){return function(t){return t=t.lift(new Df(n.ngZone)),t.pipe(jt(n.outsideAngular),xt(n.insideAngular))}}var uN=new Map,cN={activated:!1,tokenObservers:[]},lN={initialized:!1,enabled:!1};function Wt(n){return uN.get(n)||Object.assign({},cN)}function $I(){return lN}var dN="https://content-firebaseappcheck.googleapis.com/v1";var hN="exchangeDebugToken",VI={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},X2=24*60*60*1e3;var Cf=class{constructor(e,t,r,i,o){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=i,i>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return x(this,null,function*(){this.stop();try{this.pending=new ld,this.pending.promise.catch(t=>{}),yield fN(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new ld,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function fN(n){return new Promise(e=>{setTimeout(e,n)})}var pN={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},er=new Zy("appCheck","AppCheck",pN);function HI(n){if(!Wt(n).activated)throw er.create("use-before-activation",{appName:n.name})}function qI(r,i){return x(this,arguments,function*({url:n,body:e},t){let o={"Content-Type":"application/json"},s=t.getImmediate({optional:!0});if(s){let v=yield s.getHeartbeatsHeader();v&&(o["X-Firebase-Client"]=v)}let a={method:"POST",body:JSON.stringify(e),headers:o},c;try{c=yield fetch(n,a)}catch(v){throw er.create("fetch-network-error",{originalErrorMessage:v?.message})}if(c.status!==200)throw er.create("fetch-status-error",{httpStatus:c.status});let l;try{l=yield c.json()}catch(v){throw er.create("fetch-parse-error",{originalErrorMessage:v?.message})}let h=l.ttl.match(/^([\d.]+)(s)$/);if(!h||!h[2]||isNaN(Number(h[1])))throw er.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let p=Number(h[1])*1e3,m=Date.now();return{token:l.token,expireTimeMillis:m+p,issuedAtTimeMillis:m}})}function zI(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${dN}/projects/${t}/apps/${r}:${hN}?key=${i}`,body:{debug_token:e}}}var gN="firebase-app-check-database",mN=1,bf="firebase-app-check-store";var dc=null;function yN(){return dc||(dc=new Promise((n,e)=>{try{let t=indexedDB.open(gN,mN);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(er.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(bf,{keyPath:"compositeKey"})}}}catch(t){e(er.create("storage-open",{originalErrorMessage:t?.message}))}}),dc)}function vN(n,e){return _N(wN(n),e)}function _N(n,e){return x(this,null,function*(){let r=(yield yN()).transaction(bf,"readwrite"),o=r.objectStore(bf).put({compositeKey:n,value:e});return new Promise((s,a)=>{o.onsuccess=c=>{s()},r.onerror=c=>{var l;a(er.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})})}function wN(n){return`${n.options.appId}-${n.name}`}var Sf=new Va("@firebase/app-check");function Tf(n,e){return La()?vN(n,e).catch(t=>{Sf.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function GI(){return $I().enabled}function WI(){return x(this,null,function*(){let n=$I();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var IN={error:"UNKNOWN_ERROR"};function EN(n){return Ky.encodeString(JSON.stringify(n),!1)}function Af(n,e=!1){return x(this,null,function*(){let t=n.app;HI(t);let r=Wt(t),i=r.token,o;if(i&&!Ms(i)&&(r.token=void 0,i=void 0),!i){let c=yield r.cachedTokenPromise;c&&(Ms(c)?i=c:yield Tf(t,void 0))}if(!e&&i&&Ms(i))return{token:i.token};let s=!1;if(GI()){r.exchangeTokenPromise||(r.exchangeTokenPromise=qI(zI(t,yield WI()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),s=!0);let c=yield r.exchangeTokenPromise;return yield Tf(t,c),r.token=c,{token:c.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),s=!0),i=yield Wt(t).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?Sf.warn(c.message):Sf.error(c),o=c}let a;return i?o?Ms(i)?a={token:i.token,internalError:o}:a=BI(o):(a={token:i.token},r.token=i,yield Tf(t,i)):a=BI(o),s&&bN(t,a),a})}function DN(n){return x(this,null,function*(){let e=n.app;HI(e);let{provider:t}=Wt(e);if(GI()){let r=yield WI(),{token:i}=yield qI(zI(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function TN(n,e,t,r){let{app:i}=n,o=Wt(i),s={next:t,error:r,type:e};if(o.tokenObservers=[...o.tokenObservers,s],o.token&&Ms(o.token)){let a=o.token;Promise.resolve().then(()=>{t({token:a.token}),jI(n)}).catch(()=>{})}o.cachedTokenPromise.then(()=>jI(n))}function KI(n,e){let t=Wt(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function jI(n){let{app:e}=n,t=Wt(e),r=t.tokenRefresher;r||(r=CN(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function CN(n){let{app:e}=n;return new Cf(()=>x(this,null,function*(){let t=Wt(e),r;if(t.token?r=yield Af(n,!0):r=yield Af(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=Wt(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},VI.RETRIAL_MIN_WAIT,VI.RETRIAL_MAX_WAIT)}function bN(n,e){let t=Wt(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Ms(n){return n.expireTimeMillis-Date.now()>0}function BI(n){return{token:EN(IN),error:n}}var xf=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=Wt(this.app);for(let t of e)KI(this.app,t.next);return Promise.resolve()}};function SN(n,e){return new xf(n,e)}function AN(n){return{getToken:e=>Af(n,e),getLimitedUseToken:()=>DN(n),addTokenListener:e=>TN(n,"INTERNAL",e),removeTokenListener:e=>KI(n.app,e)}}var xN="@firebase/app-check",MN="0.8.8";var NN="app-check",UI="app-check-internal";function RN(){Jo(new Cr(NN,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return SN(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(UI).initialize()})),Jo(new Cr(UI,n=>{let e=n.getProvider("app-check").getImmediate();return AN(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),zn(xN,MN)}RN();var PN=["localhost","0.0.0.0","127.0.0.1"],dj=typeof window<"u"&&PN.includes(window.location.hostname);var kN="firebase",ON="10.14.1";Et.registerVersion(kN,ON,"app-compat");var FN=["ngOnDestroy"],ZI=(n,e,t,r={})=>new Proxy(n,{get:(i,o)=>t.runOutsideAngular(()=>{if(n[o])return r?.spy?.get&&r.spy.get(o,n[o]),n[o];if(FN.indexOf(o)>-1)return()=>{};let s=e.toPromise().then(a=>{let c=a?.[o];return typeof c=="function"?c.bind(a):c?.then?c.then(l=>t.run(()=>l)):t.run(()=>c)});return new Proxy(()=>{},{get:(a,c)=>s[c],apply:(a,c,l)=>s.then(h=>{let p=h?.(...l);return r?.spy?.apply&&r.spy.apply(o,l,p),p})})})});var hc=class{constructor(e){return e}},$i=new K("angularfire2.app.options"),Hi=new K("angularfire2.app.name");function Ns(n,e,t){let r=typeof t=="string"&&t||"[DEFAULT]",i=typeof t=="object"&&t||{};i.name=i.name||r;let s=Et.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>Et.initializeApp(n,i));try{if(JSON.stringify(n)!==JSON.stringify(s.options)){let a=!!module.hot;LN("error",`${s.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new hc(s)}var LN=(n,...e)=>{df()&&typeof console<"u"&&console[n](...e)},VN={provide:hc,useFactory:Ns,deps:[$i,fe,[new Hu,Hi]]},JI=(()=>{class n{static initializeApp(t,r){return{ngModule:n,providers:[{provide:$i,useValue:t},{provide:Hi,useValue:r}]}}constructor(t){Et.registerVersion("angularfire",xs.full,"core"),Et.registerVersion("angularfire",xs.full,"app-compat"),Et.registerVersion("angular",hI.full,t.toString())}static \u0275fac=function(r){return new(r||n)(F(Rt))};static \u0275mod=zt({type:n});static \u0275inj=qt({providers:[VN]})}return n})();function fc(n,e,t,r,i){let[,o,s]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===n)||[];if(o)return jN(i,s)||(YI("error",`${e} was already initialized on the ${t} Firebase App with different settings.${BN?" You may need to reload as Firebase is not HMR aware.":""}`),YI("warn",{is:i,was:s})),o;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([n,a,i]),a}}function jN(n,e){try{return n.toString()===e.toString()}catch{return n===e}}var BN=typeof module<"u"&&!!module.hot,YI=(n,...e)=>{df()&&typeof console<"u"&&console[n](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var Mf=new K("angularfire2.auth.use-emulator"),Nf=new K("angularfire2.auth.settings"),Rf=new K("angularfire2.auth.tenant-id"),Pf=new K("angularfire2.auth.langugage-code"),kf=new K("angularfire2.auth.use-device-language"),Of=new K("angularfire.auth.persistence"),Ff=(n,e,t,r,i,o,s,a)=>fc(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{let c=e.runOutsideAngular(()=>n.auth());if(t&&c.useEmulator(...t),r&&(c.tenantId=r),c.languageCode=i,o&&c.useDeviceLanguage(),s)for(let[l,h]of Object.entries(s))c.settings[l]=h;return a&&c.setPersistence(a),c},[t,r,i,o,s,a]),XI=(()=>{class n{authState;idToken;user;idTokenResult;credential;constructor(t,r,i,o,s,a,c,l,h,p,m,v){let M=new gt,N=En(void 0).pipe(xt(s.outsideAngular),Bt(()=>o.runOutsideAngular(()=>import("./chunk-DT56ZVVI.js"))),Ce(()=>Ns(t,o,r)),Ce(R=>Ff(R,o,a,l,h,p,c,m)),uu({bufferSize:1,refCount:!1}));if(jr(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=En(null);else{N.pipe(au()).subscribe();let R=N.pipe(Bt(L=>L.getRedirectResult().then(z=>z,()=>null)),yt,uu({bufferSize:1,refCount:!1})),B=N.pipe(Bt(L=>new Ae(z=>({unsubscribe:o.runOutsideAngular(()=>L.onAuthStateChanged(W=>z.next(W),W=>z.error(W),()=>z.complete()))})))),$=N.pipe(Bt(L=>new Ae(z=>({unsubscribe:o.runOutsideAngular(()=>L.onIdTokenChanged(W=>z.next(W),W=>z.error(W),()=>z.complete()))}))));this.authState=R.pipe(cu(B),jt(s.outsideAngular),xt(s.insideAngular)),this.user=R.pipe(cu($),jt(s.outsideAngular),xt(s.insideAngular)),this.idToken=this.user.pipe(Bt(L=>L?ct(L.getIdToken()):En(null))),this.idTokenResult=this.user.pipe(Bt(L=>L?ct(L.getIdTokenResult()):En(null))),this.credential=Rd(R,M,this.authState.pipe(Wn(L=>!L))).pipe(Ce(L=>L?.user?L:null),jt(s.outsideAngular),xt(s.insideAngular))}return ZI(this,N,o,{spy:{apply:(R,B,$)=>{(R.startsWith("signIn")||R.startsWith("createUser"))&&$.then(L=>M.next(L))}}})}static \u0275fac=function(r){return new(r||n)(F($i),F(Hi,8),F(Rt),F(fe),F(lc),F(Mf,8),F(Nf,8),F(Rf,8),F(Pf,8),F(kf,8),F(Of,8),F(Br,8))};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();var eE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},tE={};var tr,Lf;(function(){var n;function e(I,y){function w(){}w.prototype=y.prototype,I.D=y.prototype,I.prototype=new w,I.prototype.constructor=I,I.C=function(E,D,C){for(var _=Array(arguments.length-2),vn=2;vn<arguments.length;vn++)_[vn-2]=arguments[vn];return y.prototype[D].apply(E,_)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,y,w){w||(w=0);var E=Array(16);if(typeof y=="string")for(var D=0;16>D;++D)E[D]=y.charCodeAt(w++)|y.charCodeAt(w++)<<8|y.charCodeAt(w++)<<16|y.charCodeAt(w++)<<24;else for(D=0;16>D;++D)E[D]=y[w++]|y[w++]<<8|y[w++]<<16|y[w++]<<24;y=I.g[0],w=I.g[1],D=I.g[2];var C=I.g[3],_=y+(C^w&(D^C))+E[0]+3614090360&4294967295;y=w+(_<<7&4294967295|_>>>25),_=C+(D^y&(w^D))+E[1]+3905402710&4294967295,C=y+(_<<12&4294967295|_>>>20),_=D+(w^C&(y^w))+E[2]+606105819&4294967295,D=C+(_<<17&4294967295|_>>>15),_=w+(y^D&(C^y))+E[3]+3250441966&4294967295,w=D+(_<<22&4294967295|_>>>10),_=y+(C^w&(D^C))+E[4]+4118548399&4294967295,y=w+(_<<7&4294967295|_>>>25),_=C+(D^y&(w^D))+E[5]+1200080426&4294967295,C=y+(_<<12&4294967295|_>>>20),_=D+(w^C&(y^w))+E[6]+2821735955&4294967295,D=C+(_<<17&4294967295|_>>>15),_=w+(y^D&(C^y))+E[7]+4249261313&4294967295,w=D+(_<<22&4294967295|_>>>10),_=y+(C^w&(D^C))+E[8]+1770035416&4294967295,y=w+(_<<7&4294967295|_>>>25),_=C+(D^y&(w^D))+E[9]+2336552879&4294967295,C=y+(_<<12&4294967295|_>>>20),_=D+(w^C&(y^w))+E[10]+4294925233&4294967295,D=C+(_<<17&4294967295|_>>>15),_=w+(y^D&(C^y))+E[11]+2304563134&4294967295,w=D+(_<<22&4294967295|_>>>10),_=y+(C^w&(D^C))+E[12]+1804603682&4294967295,y=w+(_<<7&4294967295|_>>>25),_=C+(D^y&(w^D))+E[13]+4254626195&4294967295,C=y+(_<<12&4294967295|_>>>20),_=D+(w^C&(y^w))+E[14]+2792965006&4294967295,D=C+(_<<17&4294967295|_>>>15),_=w+(y^D&(C^y))+E[15]+1236535329&4294967295,w=D+(_<<22&4294967295|_>>>10),_=y+(D^C&(w^D))+E[1]+4129170786&4294967295,y=w+(_<<5&4294967295|_>>>27),_=C+(w^D&(y^w))+E[6]+3225465664&4294967295,C=y+(_<<9&4294967295|_>>>23),_=D+(y^w&(C^y))+E[11]+643717713&4294967295,D=C+(_<<14&4294967295|_>>>18),_=w+(C^y&(D^C))+E[0]+3921069994&4294967295,w=D+(_<<20&4294967295|_>>>12),_=y+(D^C&(w^D))+E[5]+3593408605&4294967295,y=w+(_<<5&4294967295|_>>>27),_=C+(w^D&(y^w))+E[10]+38016083&4294967295,C=y+(_<<9&4294967295|_>>>23),_=D+(y^w&(C^y))+E[15]+3634488961&4294967295,D=C+(_<<14&4294967295|_>>>18),_=w+(C^y&(D^C))+E[4]+3889429448&4294967295,w=D+(_<<20&4294967295|_>>>12),_=y+(D^C&(w^D))+E[9]+568446438&4294967295,y=w+(_<<5&4294967295|_>>>27),_=C+(w^D&(y^w))+E[14]+3275163606&4294967295,C=y+(_<<9&4294967295|_>>>23),_=D+(y^w&(C^y))+E[3]+4107603335&4294967295,D=C+(_<<14&4294967295|_>>>18),_=w+(C^y&(D^C))+E[8]+1163531501&4294967295,w=D+(_<<20&4294967295|_>>>12),_=y+(D^C&(w^D))+E[13]+2850285829&4294967295,y=w+(_<<5&4294967295|_>>>27),_=C+(w^D&(y^w))+E[2]+4243563512&4294967295,C=y+(_<<9&4294967295|_>>>23),_=D+(y^w&(C^y))+E[7]+1735328473&4294967295,D=C+(_<<14&4294967295|_>>>18),_=w+(C^y&(D^C))+E[12]+2368359562&4294967295,w=D+(_<<20&4294967295|_>>>12),_=y+(w^D^C)+E[5]+4294588738&4294967295,y=w+(_<<4&4294967295|_>>>28),_=C+(y^w^D)+E[8]+2272392833&4294967295,C=y+(_<<11&4294967295|_>>>21),_=D+(C^y^w)+E[11]+1839030562&4294967295,D=C+(_<<16&4294967295|_>>>16),_=w+(D^C^y)+E[14]+4259657740&4294967295,w=D+(_<<23&4294967295|_>>>9),_=y+(w^D^C)+E[1]+2763975236&4294967295,y=w+(_<<4&4294967295|_>>>28),_=C+(y^w^D)+E[4]+1272893353&4294967295,C=y+(_<<11&4294967295|_>>>21),_=D+(C^y^w)+E[7]+4139469664&4294967295,D=C+(_<<16&4294967295|_>>>16),_=w+(D^C^y)+E[10]+3200236656&4294967295,w=D+(_<<23&4294967295|_>>>9),_=y+(w^D^C)+E[13]+681279174&4294967295,y=w+(_<<4&4294967295|_>>>28),_=C+(y^w^D)+E[0]+3936430074&4294967295,C=y+(_<<11&4294967295|_>>>21),_=D+(C^y^w)+E[3]+3572445317&4294967295,D=C+(_<<16&4294967295|_>>>16),_=w+(D^C^y)+E[6]+76029189&4294967295,w=D+(_<<23&4294967295|_>>>9),_=y+(w^D^C)+E[9]+3654602809&4294967295,y=w+(_<<4&4294967295|_>>>28),_=C+(y^w^D)+E[12]+3873151461&4294967295,C=y+(_<<11&4294967295|_>>>21),_=D+(C^y^w)+E[15]+530742520&4294967295,D=C+(_<<16&4294967295|_>>>16),_=w+(D^C^y)+E[2]+3299628645&4294967295,w=D+(_<<23&4294967295|_>>>9),_=y+(D^(w|~C))+E[0]+4096336452&4294967295,y=w+(_<<6&4294967295|_>>>26),_=C+(w^(y|~D))+E[7]+1126891415&4294967295,C=y+(_<<10&4294967295|_>>>22),_=D+(y^(C|~w))+E[14]+2878612391&4294967295,D=C+(_<<15&4294967295|_>>>17),_=w+(C^(D|~y))+E[5]+4237533241&4294967295,w=D+(_<<21&4294967295|_>>>11),_=y+(D^(w|~C))+E[12]+1700485571&4294967295,y=w+(_<<6&4294967295|_>>>26),_=C+(w^(y|~D))+E[3]+2399980690&4294967295,C=y+(_<<10&4294967295|_>>>22),_=D+(y^(C|~w))+E[10]+4293915773&4294967295,D=C+(_<<15&4294967295|_>>>17),_=w+(C^(D|~y))+E[1]+2240044497&4294967295,w=D+(_<<21&4294967295|_>>>11),_=y+(D^(w|~C))+E[8]+1873313359&4294967295,y=w+(_<<6&4294967295|_>>>26),_=C+(w^(y|~D))+E[15]+4264355552&4294967295,C=y+(_<<10&4294967295|_>>>22),_=D+(y^(C|~w))+E[6]+2734768916&4294967295,D=C+(_<<15&4294967295|_>>>17),_=w+(C^(D|~y))+E[13]+1309151649&4294967295,w=D+(_<<21&4294967295|_>>>11),_=y+(D^(w|~C))+E[4]+4149444226&4294967295,y=w+(_<<6&4294967295|_>>>26),_=C+(w^(y|~D))+E[11]+3174756917&4294967295,C=y+(_<<10&4294967295|_>>>22),_=D+(y^(C|~w))+E[2]+718787259&4294967295,D=C+(_<<15&4294967295|_>>>17),_=w+(C^(D|~y))+E[9]+3951481745&4294967295,I.g[0]=I.g[0]+y&4294967295,I.g[1]=I.g[1]+(D+(_<<21&4294967295|_>>>11))&4294967295,I.g[2]=I.g[2]+D&4294967295,I.g[3]=I.g[3]+C&4294967295}r.prototype.u=function(I,y){y===void 0&&(y=I.length);for(var w=y-this.blockSize,E=this.B,D=this.h,C=0;C<y;){if(D==0)for(;C<=w;)i(this,I,C),C+=this.blockSize;if(typeof I=="string"){for(;C<y;)if(E[D++]=I.charCodeAt(C++),D==this.blockSize){i(this,E),D=0;break}}else for(;C<y;)if(E[D++]=I[C++],D==this.blockSize){i(this,E),D=0;break}}this.h=D,this.o+=y},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var y=1;y<I.length-8;++y)I[y]=0;var w=8*this.o;for(y=I.length-8;y<I.length;++y)I[y]=w&255,w/=256;for(this.u(I),I=Array(16),y=w=0;4>y;++y)for(var E=0;32>E;E+=8)I[w++]=this.g[y]>>>E&255;return I};function o(I,y){var w=a;return Object.prototype.hasOwnProperty.call(w,I)?w[I]:w[I]=y(I)}function s(I,y){this.h=y;for(var w=[],E=!0,D=I.length-1;0<=D;D--){var C=I[D]|0;E&&C==y||(w[D]=C,E=!1)}this.g=w}var a={};function c(I){return-128<=I&&128>I?o(I,function(y){return new s([y|0],0>y?-1:0)}):new s([I|0],0>I?-1:0)}function l(I){if(isNaN(I)||!isFinite(I))return p;if(0>I)return R(l(-I));for(var y=[],w=1,E=0;I>=w;E++)y[E]=I/w|0,w*=4294967296;return new s(y,0)}function h(I,y){if(I.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(I.charAt(0)=="-")return R(h(I.substring(1),y));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=l(Math.pow(y,8)),E=p,D=0;D<I.length;D+=8){var C=Math.min(8,I.length-D),_=parseInt(I.substring(D,D+C),y);8>C?(C=l(Math.pow(y,C)),E=E.j(C).add(l(_))):(E=E.j(w),E=E.add(l(_)))}return E}var p=c(0),m=c(1),v=c(16777216);n=s.prototype,n.m=function(){if(N(this))return-R(this).m();for(var I=0,y=1,w=0;w<this.g.length;w++){var E=this.i(w);I+=(0<=E?E:4294967296+E)*y,y*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(M(this))return"0";if(N(this))return"-"+R(this).toString(I);for(var y=l(Math.pow(I,6)),w=this,E="";;){var D=z(w,y).g;w=B(w,D.j(y));var C=((0<w.g.length?w.g[0]:w.h)>>>0).toString(I);if(w=D,M(w))return C+E;for(;6>C.length;)C="0"+C;E=C+E}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function M(I){if(I.h!=0)return!1;for(var y=0;y<I.g.length;y++)if(I.g[y]!=0)return!1;return!0}function N(I){return I.h==-1}n.l=function(I){return I=B(this,I),N(I)?-1:M(I)?0:1};function R(I){for(var y=I.g.length,w=[],E=0;E<y;E++)w[E]=~I.g[E];return new s(w,~I.h).add(m)}n.abs=function(){return N(this)?R(this):this},n.add=function(I){for(var y=Math.max(this.g.length,I.g.length),w=[],E=0,D=0;D<=y;D++){var C=E+(this.i(D)&65535)+(I.i(D)&65535),_=(C>>>16)+(this.i(D)>>>16)+(I.i(D)>>>16);E=_>>>16,C&=65535,_&=65535,w[D]=_<<16|C}return new s(w,w[w.length-1]&-2147483648?-1:0)};function B(I,y){return I.add(R(y))}n.j=function(I){if(M(this)||M(I))return p;if(N(this))return N(I)?R(this).j(R(I)):R(R(this).j(I));if(N(I))return R(this.j(R(I)));if(0>this.l(v)&&0>I.l(v))return l(this.m()*I.m());for(var y=this.g.length+I.g.length,w=[],E=0;E<2*y;E++)w[E]=0;for(E=0;E<this.g.length;E++)for(var D=0;D<I.g.length;D++){var C=this.i(E)>>>16,_=this.i(E)&65535,vn=I.i(D)>>>16,Ro=I.i(D)&65535;w[2*E+2*D]+=_*Ro,$(w,2*E+2*D),w[2*E+2*D+1]+=C*Ro,$(w,2*E+2*D+1),w[2*E+2*D+1]+=_*vn,$(w,2*E+2*D+1),w[2*E+2*D+2]+=C*vn,$(w,2*E+2*D+2)}for(E=0;E<y;E++)w[E]=w[2*E+1]<<16|w[2*E];for(E=y;E<2*y;E++)w[E]=0;return new s(w,0)};function $(I,y){for(;(I[y]&65535)!=I[y];)I[y+1]+=I[y]>>>16,I[y]&=65535,y++}function L(I,y){this.g=I,this.h=y}function z(I,y){if(M(y))throw Error("division by zero");if(M(I))return new L(p,p);if(N(I))return y=z(R(I),y),new L(R(y.g),R(y.h));if(N(y))return y=z(I,R(y)),new L(R(y.g),y.h);if(30<I.g.length){if(N(I)||N(y))throw Error("slowDivide_ only works with positive integers.");for(var w=m,E=y;0>=E.l(I);)w=W(w),E=W(E);var D=G(w,1),C=G(E,1);for(E=G(E,2),w=G(w,2);!M(E);){var _=C.add(E);0>=_.l(I)&&(D=D.add(w),C=_),E=G(E,1),w=G(w,1)}return y=B(I,D.j(y)),new L(D,y)}for(D=p;0<=I.l(y);){for(w=Math.max(1,Math.floor(I.m()/y.m())),E=Math.ceil(Math.log(w)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),C=l(w),_=C.j(y);N(_)||0<_.l(I);)w-=E,C=l(w),_=C.j(y);M(C)&&(C=m),D=D.add(C),I=B(I,_)}return new L(D,I)}n.A=function(I){return z(this,I).h},n.and=function(I){for(var y=Math.max(this.g.length,I.g.length),w=[],E=0;E<y;E++)w[E]=this.i(E)&I.i(E);return new s(w,this.h&I.h)},n.or=function(I){for(var y=Math.max(this.g.length,I.g.length),w=[],E=0;E<y;E++)w[E]=this.i(E)|I.i(E);return new s(w,this.h|I.h)},n.xor=function(I){for(var y=Math.max(this.g.length,I.g.length),w=[],E=0;E<y;E++)w[E]=this.i(E)^I.i(E);return new s(w,this.h^I.h)};function W(I){for(var y=I.g.length+1,w=[],E=0;E<y;E++)w[E]=I.i(E)<<1|I.i(E-1)>>>31;return new s(w,I.h)}function G(I,y){var w=y>>5;y%=32;for(var E=I.g.length-w,D=[],C=0;C<E;C++)D[C]=0<y?I.i(C+w)>>>y|I.i(C+w+1)<<32-y:I.i(C+w);return new s(D,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Lf=tE.Md5=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=l,s.fromString=h,tr=tE.Integer=s}).apply(typeof eE<"u"?eE:typeof self<"u"?self:typeof window<"u"?window:{});var pc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Nn={};var Vf,$N,qi,jf,Rs,gc,Bf,Uf,$f;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,d,f){return u==Array.prototype||u==Object.prototype||(u[d]=f.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof pc=="object"&&pc];for(var d=0;d<u.length;++d){var f=u[d];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=t(this);function i(u,d){if(d)e:{var f=r;u=u.split(".");for(var g=0;g<u.length-1;g++){var T=u[g];if(!(T in f))break e;f=f[T]}u=u[u.length-1],g=f[u],d=d(g),d!=g&&d!=null&&e(f,u,{configurable:!0,writable:!0,value:d})}}function o(u,d){u instanceof String&&(u+="");var f=0,g=!1,T={next:function(){if(!g&&f<u.length){var S=f++;return{value:d(S,u[S]),done:!1}}return g=!0,{done:!0,value:void 0}}};return T[Symbol.iterator]=function(){return T},T}i("Array.prototype.values",function(u){return u||function(){return o(this,function(d,f){return f})}});var s=s||{},a=this||self;function c(u){var d=typeof u;return d=d!="object"?d:u?Array.isArray(u)?"array":d:"null",d=="array"||d=="object"&&typeof u.length=="number"}function l(u){var d=typeof u;return d=="object"&&u!=null||d=="function"}function h(u,d,f){return u.call.apply(u.bind,arguments)}function p(u,d,f){if(!u)throw Error();if(2<arguments.length){var g=Array.prototype.slice.call(arguments,2);return function(){var T=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(T,g),u.apply(d,T)}}return function(){return u.apply(d,arguments)}}function m(u,d,f){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:p,m.apply(null,arguments)}function v(u,d){var f=Array.prototype.slice.call(arguments,1);return function(){var g=f.slice();return g.push.apply(g,arguments),u.apply(this,g)}}function M(u,d){function f(){}f.prototype=d.prototype,u.aa=d.prototype,u.prototype=new f,u.prototype.constructor=u,u.Qb=function(g,T,S){for(var O=Array(arguments.length-2),we=2;we<arguments.length;we++)O[we-2]=arguments[we];return d.prototype[T].apply(g,O)}}function N(u){let d=u.length;if(0<d){let f=Array(d);for(let g=0;g<d;g++)f[g]=u[g];return f}return[]}function R(u,d){for(let f=1;f<arguments.length;f++){let g=arguments[f];if(c(g)){let T=u.length||0,S=g.length||0;u.length=T+S;for(let O=0;O<S;O++)u[T+O]=g[O]}else u.push(g)}}class B{constructor(d,f){this.i=d,this.j=f,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function $(u){return/^[\s\xa0]*$/.test(u)}function L(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function z(u){return z[" "](u),u}z[" "]=function(){};var W=L().indexOf("Gecko")!=-1&&!(L().toLowerCase().indexOf("webkit")!=-1&&L().indexOf("Edge")==-1)&&!(L().indexOf("Trident")!=-1||L().indexOf("MSIE")!=-1)&&L().indexOf("Edge")==-1;function G(u,d,f){for(let g in u)d.call(f,u[g],g,u)}function I(u,d){for(let f in u)d.call(void 0,u[f],f,u)}function y(u){let d={};for(let f in u)d[f]=u[f];return d}let w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(u,d){let f,g;for(let T=1;T<arguments.length;T++){g=arguments[T];for(f in g)u[f]=g[f];for(let S=0;S<w.length;S++)f=w[S],Object.prototype.hasOwnProperty.call(g,f)&&(u[f]=g[f])}}function D(u){var d=1;u=u.split(":");let f=[];for(;0<d&&u.length;)f.push(u.shift()),d--;return u.length&&f.push(u.join(":")),f}function C(u){a.setTimeout(()=>{throw u},0)}function _(){var u=Vl;let d=null;return u.g&&(d=u.g,u.g=u.g.next,u.g||(u.h=null),d.next=null),d}class vn{constructor(){this.h=this.g=null}add(d,f){let g=Ro.get();g.set(d,f),this.h?this.h.next=g:this.g=g,this.h=g}}var Ro=new B(()=>new Y0,u=>u.reset());class Y0{constructor(){this.next=this.g=this.h=null}set(d,f){this.h=d,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let Po,ko=!1,Vl=new vn,qm=()=>{let u=a.Promise.resolve(void 0);Po=()=>{u.then(Z0)}};var Z0=()=>{for(var u;u=_();){try{u.h.call(u.g)}catch(f){C(f)}var d=Ro;d.j(u),100>d.h&&(d.h++,u.next=d.g,d.g=u)}ko=!1};function Un(){this.s=this.s,this.C=this.C}Un.prototype.s=!1,Un.prototype.ma=function(){this.s||(this.s=!0,this.N())},Un.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function et(u,d){this.type=u,this.g=this.target=d,this.defaultPrevented=!1}et.prototype.h=function(){this.defaultPrevented=!0};var J0=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,d=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let f=()=>{};a.addEventListener("test",f,d),a.removeEventListener("test",f,d)}catch{}return u}();function Oo(u,d){if(et.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var f=this.type=u.type,g=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=d,d=u.relatedTarget){if(W){e:{try{z(d.nodeName);var T=!0;break e}catch{}T=!1}T||(d=null)}}else f=="mouseover"?d=u.fromElement:f=="mouseout"&&(d=u.toElement);this.relatedTarget=d,g?(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:X0[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&Oo.aa.h.call(this)}}M(Oo,et);var X0={2:"touch",3:"pen",4:"mouse"};Oo.prototype.h=function(){Oo.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Fo="closure_listenable_"+(1e6*Math.random()|0),eC=0;function tC(u,d,f,g,T){this.listener=u,this.proxy=null,this.src=d,this.type=f,this.capture=!!g,this.ha=T,this.key=++eC,this.da=this.fa=!1}function _a(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function wa(u){this.src=u,this.g={},this.h=0}wa.prototype.add=function(u,d,f,g,T){var S=u.toString();u=this.g[S],u||(u=this.g[S]=[],this.h++);var O=Bl(u,d,g,T);return-1<O?(d=u[O],f||(d.fa=!1)):(d=new tC(d,this.src,S,!!g,T),d.fa=f,u.push(d)),d};function jl(u,d){var f=d.type;if(f in u.g){var g=u.g[f],T=Array.prototype.indexOf.call(g,d,void 0),S;(S=0<=T)&&Array.prototype.splice.call(g,T,1),S&&(_a(d),u.g[f].length==0&&(delete u.g[f],u.h--))}}function Bl(u,d,f,g){for(var T=0;T<u.length;++T){var S=u[T];if(!S.da&&S.listener==d&&S.capture==!!f&&S.ha==g)return T}return-1}var Ul="closure_lm_"+(1e6*Math.random()|0),$l={};function zm(u,d,f,g,T){if(g&&g.once)return Wm(u,d,f,g,T);if(Array.isArray(d)){for(var S=0;S<d.length;S++)zm(u,d[S],f,g,T);return null}return f=Gl(f),u&&u[Fo]?u.K(d,f,l(g)?!!g.capture:!!g,T):Gm(u,d,f,!1,g,T)}function Gm(u,d,f,g,T,S){if(!d)throw Error("Invalid event type");var O=l(T)?!!T.capture:!!T,we=ql(u);if(we||(u[Ul]=we=new wa(u)),f=we.add(d,f,g,O,S),f.proxy)return f;if(g=nC(),f.proxy=g,g.src=u,g.listener=f,u.addEventListener)J0||(T=O),T===void 0&&(T=!1),u.addEventListener(d.toString(),g,T);else if(u.attachEvent)u.attachEvent(Qm(d.toString()),g);else if(u.addListener&&u.removeListener)u.addListener(g);else throw Error("addEventListener and attachEvent are unavailable.");return f}function nC(){function u(f){return d.call(u.src,u.listener,f)}let d=rC;return u}function Wm(u,d,f,g,T){if(Array.isArray(d)){for(var S=0;S<d.length;S++)Wm(u,d[S],f,g,T);return null}return f=Gl(f),u&&u[Fo]?u.L(d,f,l(g)?!!g.capture:!!g,T):Gm(u,d,f,!0,g,T)}function Km(u,d,f,g,T){if(Array.isArray(d))for(var S=0;S<d.length;S++)Km(u,d[S],f,g,T);else g=l(g)?!!g.capture:!!g,f=Gl(f),u&&u[Fo]?(u=u.i,d=String(d).toString(),d in u.g&&(S=u.g[d],f=Bl(S,f,g,T),-1<f&&(_a(S[f]),Array.prototype.splice.call(S,f,1),S.length==0&&(delete u.g[d],u.h--)))):u&&(u=ql(u))&&(d=u.g[d.toString()],u=-1,d&&(u=Bl(d,f,g,T)),(f=-1<u?d[u]:null)&&Hl(f))}function Hl(u){if(typeof u!="number"&&u&&!u.da){var d=u.src;if(d&&d[Fo])jl(d.i,u);else{var f=u.type,g=u.proxy;d.removeEventListener?d.removeEventListener(f,g,u.capture):d.detachEvent?d.detachEvent(Qm(f),g):d.addListener&&d.removeListener&&d.removeListener(g),(f=ql(d))?(jl(f,u),f.h==0&&(f.src=null,d[Ul]=null)):_a(u)}}}function Qm(u){return u in $l?$l[u]:$l[u]="on"+u}function rC(u,d){if(u.da)u=!0;else{d=new Oo(d,this);var f=u.listener,g=u.ha||u.src;u.fa&&Hl(u),u=f.call(g,d)}return u}function ql(u){return u=u[Ul],u instanceof wa?u:null}var zl="__closure_events_fn_"+(1e9*Math.random()>>>0);function Gl(u){return typeof u=="function"?u:(u[zl]||(u[zl]=function(d){return u.handleEvent(d)}),u[zl])}function tt(){Un.call(this),this.i=new wa(this),this.M=this,this.F=null}M(tt,Un),tt.prototype[Fo]=!0,tt.prototype.removeEventListener=function(u,d,f,g){Km(this,u,d,f,g)};function at(u,d){var f,g=u.F;if(g)for(f=[];g;g=g.F)f.push(g);if(u=u.M,g=d.type||d,typeof d=="string")d=new et(d,u);else if(d instanceof et)d.target=d.target||u;else{var T=d;d=new et(g,u),E(d,T)}if(T=!0,f)for(var S=f.length-1;0<=S;S--){var O=d.g=f[S];T=Ia(O,g,!0,d)&&T}if(O=d.g=u,T=Ia(O,g,!0,d)&&T,T=Ia(O,g,!1,d)&&T,f)for(S=0;S<f.length;S++)O=d.g=f[S],T=Ia(O,g,!1,d)&&T}tt.prototype.N=function(){if(tt.aa.N.call(this),this.i){var u=this.i,d;for(d in u.g){for(var f=u.g[d],g=0;g<f.length;g++)_a(f[g]);delete u.g[d],u.h--}}this.F=null},tt.prototype.K=function(u,d,f,g){return this.i.add(String(u),d,!1,f,g)},tt.prototype.L=function(u,d,f,g){return this.i.add(String(u),d,!0,f,g)};function Ia(u,d,f,g){if(d=u.i.g[String(d)],!d)return!0;d=d.concat();for(var T=!0,S=0;S<d.length;++S){var O=d[S];if(O&&!O.da&&O.capture==f){var we=O.listener,Ke=O.ha||O.src;O.fa&&jl(u.i,O),T=we.call(Ke,g)!==!1&&T}}return T&&!g.defaultPrevented}function Ym(u,d,f){if(typeof u=="function")f&&(u=m(u,f));else if(u&&typeof u.handleEvent=="function")u=m(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:a.setTimeout(u,d||0)}function Zm(u){u.g=Ym(()=>{u.g=null,u.i&&(u.i=!1,Zm(u))},u.l);let d=u.h;u.h=null,u.m.apply(null,d)}class iC extends Un{constructor(d,f){super(),this.m=d,this.l=f,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:Zm(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Lo(u){Un.call(this),this.h=u,this.g={}}M(Lo,Un);var Jm=[];function Xm(u){G(u.g,function(d,f){this.g.hasOwnProperty(f)&&Hl(d)},u),u.g={}}Lo.prototype.N=function(){Lo.aa.N.call(this),Xm(this)},Lo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Wl=a.JSON.stringify,oC=a.JSON.parse,sC=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function Kl(){}Kl.prototype.h=null;function ey(u){return u.h||(u.h=u.i())}function ty(){}var Vo={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ql(){et.call(this,"d")}M(Ql,et);function Yl(){et.call(this,"c")}M(Yl,et);var Ir={},ny=null;function Ea(){return ny=ny||new tt}Ir.La="serverreachability";function ry(u){et.call(this,Ir.La,u)}M(ry,et);function jo(u){let d=Ea();at(d,new ry(d))}Ir.STAT_EVENT="statevent";function iy(u,d){et.call(this,Ir.STAT_EVENT,u),this.stat=d}M(iy,et);function ut(u){let d=Ea();at(d,new iy(d,u))}Ir.Ma="timingevent";function oy(u,d){et.call(this,Ir.Ma,u),this.size=d}M(oy,et);function Bo(u,d){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},d)}function Uo(){this.g=!0}Uo.prototype.xa=function(){this.g=!1};function aC(u,d,f,g,T,S){u.info(function(){if(u.g)if(S)for(var O="",we=S.split("&"),Ke=0;Ke<we.length;Ke++){var de=we[Ke].split("=");if(1<de.length){var nt=de[0];de=de[1];var rt=nt.split("_");O=2<=rt.length&&rt[1]=="type"?O+(nt+"="+de+"&"):O+(nt+"=redacted&")}}else O=null;else O=S;return"XMLHTTP REQ ("+g+") [attempt "+T+"]: "+d+`
`+f+`
`+O})}function uC(u,d,f,g,T,S,O){u.info(function(){return"XMLHTTP RESP ("+g+") [ attempt "+T+"]: "+d+`
`+f+`
`+S+" "+O})}function pi(u,d,f,g){u.info(function(){return"XMLHTTP TEXT ("+d+"): "+lC(u,f)+(g?" "+g:"")})}function cC(u,d){u.info(function(){return"TIMEOUT: "+d})}Uo.prototype.info=function(){};function lC(u,d){if(!u.g)return d;if(!d)return null;try{var f=JSON.parse(d);if(f){for(u=0;u<f.length;u++)if(Array.isArray(f[u])){var g=f[u];if(!(2>g.length)){var T=g[1];if(Array.isArray(T)&&!(1>T.length)){var S=T[0];if(S!="noop"&&S!="stop"&&S!="close")for(var O=1;O<T.length;O++)T[O]=""}}}}return Wl(f)}catch{return d}}var Da={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},sy={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Zl;function Ta(){}M(Ta,Kl),Ta.prototype.g=function(){return new XMLHttpRequest},Ta.prototype.i=function(){return{}},Zl=new Ta;function $n(u,d,f,g){this.j=u,this.i=d,this.l=f,this.R=g||1,this.U=new Lo(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ay}function ay(){this.i=null,this.g="",this.h=!1}var uy={},Jl={};function Xl(u,d,f){u.L=1,u.v=Aa(_n(d)),u.m=f,u.P=!0,cy(u,null)}function cy(u,d){u.F=Date.now(),Ca(u),u.A=_n(u.v);var f=u.A,g=u.R;Array.isArray(g)||(g=[String(g)]),Dy(f.i,"t",g),u.C=0,f=u.j.J,u.h=new ay,u.g=Uy(u.j,f?d:null,!u.m),0<u.O&&(u.M=new iC(m(u.Y,u,u.g),u.O)),d=u.U,f=u.g,g=u.ca;var T="readystatechange";Array.isArray(T)||(T&&(Jm[0]=T.toString()),T=Jm);for(var S=0;S<T.length;S++){var O=zm(f,T[S],g||d.handleEvent,!1,d.h||d);if(!O)break;d.g[O.key]=O}d=u.H?y(u.H):{},u.m?(u.u||(u.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,d)):(u.u="GET",u.g.ea(u.A,u.u,null,d)),jo(),aC(u.i,u.u,u.A,u.l,u.R,u.m)}$n.prototype.ca=function(u){u=u.target;let d=this.M;d&&wn(u)==3?d.j():this.Y(u)},$n.prototype.Y=function(u){try{if(u==this.g)e:{let rt=wn(this.g);var d=this.g.Ba();let yi=this.g.Z();if(!(3>rt)&&(rt!=3||this.g&&(this.h.h||this.g.oa()||My(this.g)))){this.J||rt!=4||d==7||(d==8||0>=yi?jo(3):jo(2)),ed(this);var f=this.g.Z();this.X=f;t:if(ly(this)){var g=My(this.g);u="";var T=g.length,S=wn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Er(this),$o(this);var O="";break t}this.h.i=new a.TextDecoder}for(d=0;d<T;d++)this.h.h=!0,u+=this.h.i.decode(g[d],{stream:!(S&&d==T-1)});g.length=0,this.h.g+=u,this.C=0,O=this.h.g}else O=this.g.oa();if(this.o=f==200,uC(this.i,this.u,this.A,this.l,this.R,rt,f),this.o){if(this.T&&!this.K){t:{if(this.g){var we,Ke=this.g;if((we=Ke.g?Ke.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!$(we)){var de=we;break t}}de=null}if(f=de)pi(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,td(this,f);else{this.o=!1,this.s=3,ut(12),Er(this),$o(this);break e}}if(this.P){f=!0;let Lt;for(;!this.J&&this.C<O.length;)if(Lt=dC(this,O),Lt==Jl){rt==4&&(this.s=4,ut(14),f=!1),pi(this.i,this.l,null,"[Incomplete Response]");break}else if(Lt==uy){this.s=4,ut(15),pi(this.i,this.l,O,"[Invalid Chunk]"),f=!1;break}else pi(this.i,this.l,Lt,null),td(this,Lt);if(ly(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),rt!=4||O.length!=0||this.h.h||(this.s=1,ut(16),f=!1),this.o=this.o&&f,!f)pi(this.i,this.l,O,"[Invalid Chunked Response]"),Er(this),$o(this);else if(0<O.length&&!this.W){this.W=!0;var nt=this.j;nt.g==this&&nt.ba&&!nt.M&&(nt.j.info("Great, no buffering proxy detected. Bytes received: "+O.length),ad(nt),nt.M=!0,ut(11))}}else pi(this.i,this.l,O,null),td(this,O);rt==4&&Er(this),this.o&&!this.J&&(rt==4?Ly(this.j,this):(this.o=!1,Ca(this)))}else AC(this.g),f==400&&0<O.indexOf("Unknown SID")?(this.s=3,ut(12)):(this.s=0,ut(13)),Er(this),$o(this)}}}catch{}finally{}};function ly(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function dC(u,d){var f=u.C,g=d.indexOf(`
`,f);return g==-1?Jl:(f=Number(d.substring(f,g)),isNaN(f)?uy:(g+=1,g+f>d.length?Jl:(d=d.slice(g,g+f),u.C=g+f,d)))}$n.prototype.cancel=function(){this.J=!0,Er(this)};function Ca(u){u.S=Date.now()+u.I,dy(u,u.I)}function dy(u,d){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Bo(m(u.ba,u),d)}function ed(u){u.B&&(a.clearTimeout(u.B),u.B=null)}$n.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(cC(this.i,this.A),this.L!=2&&(jo(),ut(17)),Er(this),this.s=2,$o(this)):dy(this,this.S-u)};function $o(u){u.j.G==0||u.J||Ly(u.j,u)}function Er(u){ed(u);var d=u.M;d&&typeof d.ma=="function"&&d.ma(),u.M=null,Xm(u.U),u.g&&(d=u.g,u.g=null,d.abort(),d.ma())}function td(u,d){try{var f=u.j;if(f.G!=0&&(f.g==u||nd(f.h,u))){if(!u.K&&nd(f.h,u)&&f.G==3){try{var g=f.Da.g.parse(d)}catch{g=null}if(Array.isArray(g)&&g.length==3){var T=g;if(T[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<u.F)Pa(f),Na(f);else break e;sd(f),ut(18)}}else f.za=T[1],0<f.za-f.T&&37500>T[2]&&f.F&&f.v==0&&!f.C&&(f.C=Bo(m(f.Za,f),6e3));if(1>=py(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else Tr(f,11)}else if((u.K||f.g==u)&&Pa(f),!$(d))for(T=f.Da.g.parse(d),d=0;d<T.length;d++){let de=T[d];if(f.T=de[0],de=de[1],f.G==2)if(de[0]=="c"){f.K=de[1],f.ia=de[2];let nt=de[3];nt!=null&&(f.la=nt,f.j.info("VER="+f.la));let rt=de[4];rt!=null&&(f.Aa=rt,f.j.info("SVER="+f.Aa));let yi=de[5];yi!=null&&typeof yi=="number"&&0<yi&&(g=1.5*yi,f.L=g,f.j.info("backChannelRequestTimeoutMs_="+g)),g=f;let Lt=u.g;if(Lt){let Oa=Lt.g?Lt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Oa){var S=g.h;S.g||Oa.indexOf("spdy")==-1&&Oa.indexOf("quic")==-1&&Oa.indexOf("h2")==-1||(S.j=S.l,S.g=new Set,S.h&&(rd(S,S.h),S.h=null))}if(g.D){let ud=Lt.g?Lt.g.getResponseHeader("X-HTTP-Session-Id"):null;ud&&(g.ya=ud,Se(g.I,g.D,ud))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-u.F,f.j.info("Handshake RTT: "+f.R+"ms")),g=f;var O=u;if(g.qa=By(g,g.J?g.ia:null,g.W),O.K){gy(g.h,O);var we=O,Ke=g.L;Ke&&(we.I=Ke),we.B&&(ed(we),Ca(we)),g.g=O}else Oy(g);0<f.i.length&&Ra(f)}else de[0]!="stop"&&de[0]!="close"||Tr(f,7);else f.G==3&&(de[0]=="stop"||de[0]=="close"?de[0]=="stop"?Tr(f,7):od(f):de[0]!="noop"&&f.l&&f.l.ta(de),f.v=0)}}jo(4)}catch{}}var hC=class{constructor(u,d){this.g=u,this.map=d}};function hy(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function fy(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function py(u){return u.h?1:u.g?u.g.size:0}function nd(u,d){return u.h?u.h==d:u.g?u.g.has(d):!1}function rd(u,d){u.g?u.g.add(d):u.h=d}function gy(u,d){u.h&&u.h==d?u.h=null:u.g&&u.g.has(d)&&u.g.delete(d)}hy.prototype.cancel=function(){if(this.i=my(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function my(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let d=u.i;for(let f of u.g.values())d=d.concat(f.D);return d}return N(u.i)}function fC(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var d=[],f=u.length,g=0;g<f;g++)d.push(u[g]);return d}d=[],f=0;for(g in u)d[f++]=u[g];return d}function pC(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var d=[];u=u.length;for(var f=0;f<u;f++)d.push(f);return d}d=[],f=0;for(let g in u)d[f++]=g;return d}}}function yy(u,d){if(u.forEach&&typeof u.forEach=="function")u.forEach(d,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,d,void 0);else for(var f=pC(u),g=fC(u),T=g.length,S=0;S<T;S++)d.call(void 0,g[S],f&&f[S],u)}var vy=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function gC(u,d){if(u){u=u.split("&");for(var f=0;f<u.length;f++){var g=u[f].indexOf("="),T=null;if(0<=g){var S=u[f].substring(0,g);T=u[f].substring(g+1)}else S=u[f];d(S,T?decodeURIComponent(T.replace(/\+/g," ")):"")}}}function Dr(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Dr){this.h=u.h,ba(this,u.j),this.o=u.o,this.g=u.g,Sa(this,u.s),this.l=u.l;var d=u.i,f=new zo;f.i=d.i,d.g&&(f.g=new Map(d.g),f.h=d.h),_y(this,f),this.m=u.m}else u&&(d=String(u).match(vy))?(this.h=!1,ba(this,d[1]||"",!0),this.o=Ho(d[2]||""),this.g=Ho(d[3]||"",!0),Sa(this,d[4]),this.l=Ho(d[5]||"",!0),_y(this,d[6]||"",!0),this.m=Ho(d[7]||"")):(this.h=!1,this.i=new zo(null,this.h))}Dr.prototype.toString=function(){var u=[],d=this.j;d&&u.push(qo(d,wy,!0),":");var f=this.g;return(f||d=="file")&&(u.push("//"),(d=this.o)&&u.push(qo(d,wy,!0),"@"),u.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&u.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&u.push("/"),u.push(qo(f,f.charAt(0)=="/"?vC:yC,!0))),(f=this.i.toString())&&u.push("?",f),(f=this.m)&&u.push("#",qo(f,wC)),u.join("")};function _n(u){return new Dr(u)}function ba(u,d,f){u.j=f?Ho(d,!0):d,u.j&&(u.j=u.j.replace(/:$/,""))}function Sa(u,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);u.s=d}else u.s=null}function _y(u,d,f){d instanceof zo?(u.i=d,IC(u.i,u.h)):(f||(d=qo(d,_C)),u.i=new zo(d,u.h))}function Se(u,d,f){u.i.set(d,f)}function Aa(u){return Se(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Ho(u,d){return u?d?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function qo(u,d,f){return typeof u=="string"?(u=encodeURI(u).replace(d,mC),f&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function mC(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var wy=/[#\/\?@]/g,yC=/[#\?:]/g,vC=/[#\?]/g,_C=/[#\?@]/g,wC=/#/g;function zo(u,d){this.h=this.g=null,this.i=u||null,this.j=!!d}function Hn(u){u.g||(u.g=new Map,u.h=0,u.i&&gC(u.i,function(d,f){u.add(decodeURIComponent(d.replace(/\+/g," ")),f)}))}n=zo.prototype,n.add=function(u,d){Hn(this),this.i=null,u=gi(this,u);var f=this.g.get(u);return f||this.g.set(u,f=[]),f.push(d),this.h+=1,this};function Iy(u,d){Hn(u),d=gi(u,d),u.g.has(d)&&(u.i=null,u.h-=u.g.get(d).length,u.g.delete(d))}function Ey(u,d){return Hn(u),d=gi(u,d),u.g.has(d)}n.forEach=function(u,d){Hn(this),this.g.forEach(function(f,g){f.forEach(function(T){u.call(d,T,g,this)},this)},this)},n.na=function(){Hn(this);let u=Array.from(this.g.values()),d=Array.from(this.g.keys()),f=[];for(let g=0;g<d.length;g++){let T=u[g];for(let S=0;S<T.length;S++)f.push(d[g])}return f},n.V=function(u){Hn(this);let d=[];if(typeof u=="string")Ey(this,u)&&(d=d.concat(this.g.get(gi(this,u))));else{u=Array.from(this.g.values());for(let f=0;f<u.length;f++)d=d.concat(u[f])}return d},n.set=function(u,d){return Hn(this),this.i=null,u=gi(this,u),Ey(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[d]),this.h+=1,this},n.get=function(u,d){return u?(u=this.V(u),0<u.length?String(u[0]):d):d};function Dy(u,d,f){Iy(u,d),0<f.length&&(u.i=null,u.g.set(gi(u,d),N(f)),u.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],d=Array.from(this.g.keys());for(var f=0;f<d.length;f++){var g=d[f];let S=encodeURIComponent(String(g)),O=this.V(g);for(g=0;g<O.length;g++){var T=S;O[g]!==""&&(T+="="+encodeURIComponent(String(O[g]))),u.push(T)}}return this.i=u.join("&")};function gi(u,d){return d=String(d),u.j&&(d=d.toLowerCase()),d}function IC(u,d){d&&!u.j&&(Hn(u),u.i=null,u.g.forEach(function(f,g){var T=g.toLowerCase();g!=T&&(Iy(this,g),Dy(this,T,f))},u)),u.j=d}function EC(u,d){let f=new Uo;if(a.Image){let g=new Image;g.onload=v(qn,f,"TestLoadImage: loaded",!0,d,g),g.onerror=v(qn,f,"TestLoadImage: error",!1,d,g),g.onabort=v(qn,f,"TestLoadImage: abort",!1,d,g),g.ontimeout=v(qn,f,"TestLoadImage: timeout",!1,d,g),a.setTimeout(function(){g.ontimeout&&g.ontimeout()},1e4),g.src=u}else d(!1)}function DC(u,d){let f=new Uo,g=new AbortController,T=setTimeout(()=>{g.abort(),qn(f,"TestPingServer: timeout",!1,d)},1e4);fetch(u,{signal:g.signal}).then(S=>{clearTimeout(T),S.ok?qn(f,"TestPingServer: ok",!0,d):qn(f,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(T),qn(f,"TestPingServer: error",!1,d)})}function qn(u,d,f,g,T){try{T&&(T.onload=null,T.onerror=null,T.onabort=null,T.ontimeout=null),g(f)}catch{}}function TC(){this.g=new sC}function CC(u,d,f){let g=f||"";try{yy(u,function(T,S){let O=T;l(T)&&(O=Wl(T)),d.push(g+S+"="+encodeURIComponent(O))})}catch(T){throw d.push(g+"type="+encodeURIComponent("_badmap")),T}}function Go(u){this.l=u.Ub||null,this.j=u.eb||!1}M(Go,Kl),Go.prototype.g=function(){return new xa(this.l,this.j)},Go.prototype.i=function(u){return function(){return u}}({});function xa(u,d){tt.call(this),this.D=u,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}M(xa,tt),n=xa.prototype,n.open=function(u,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=d,this.readyState=1,Ko(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(d.body=u),(this.D||a).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Wo(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Ko(this)),this.g&&(this.readyState=3,Ko(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ty(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ty(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var d=u.value?u.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!u.done}))&&(this.response=this.responseText+=d)}u.done?Wo(this):Ko(this),this.readyState==3&&Ty(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,Wo(this))},n.Qa=function(u){this.g&&(this.response=u,Wo(this))},n.ga=function(){this.g&&Wo(this)};function Wo(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Ko(u)}n.setRequestHeader=function(u,d){this.u.append(u,d)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],d=this.h.entries();for(var f=d.next();!f.done;)f=f.value,u.push(f[0]+": "+f[1]),f=d.next();return u.join(`\r
`)};function Ko(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(xa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Cy(u){let d="";return G(u,function(f,g){d+=g,d+=":",d+=f,d+=`\r
`}),d}function id(u,d,f){e:{for(g in f){var g=!1;break e}g=!0}g||(f=Cy(f),typeof u=="string"?f!=null&&encodeURIComponent(String(f)):Se(u,d,f))}function ke(u){tt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}M(ke,tt);var bC=/^https?$/i,SC=["POST","PUT"];n=ke.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,d,f,g){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);d=d?d.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Zl.g(),this.v=this.o?ey(this.o):ey(Zl),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(d,String(u),!0),this.B=!1}catch(S){by(this,S);return}if(u=f||"",f=new Map(this.headers),g)if(Object.getPrototypeOf(g)===Object.prototype)for(var T in g)f.set(T,g[T]);else if(typeof g.keys=="function"&&typeof g.get=="function")for(let S of g.keys())f.set(S,g.get(S));else throw Error("Unknown input type for opt_headers: "+String(g));g=Array.from(f.keys()).find(S=>S.toLowerCase()=="content-type"),T=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(SC,d,void 0))||g||T||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[S,O]of f)this.g.setRequestHeader(S,O);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{xy(this),this.u=!0,this.g.send(u),this.u=!1}catch(S){by(this,S)}};function by(u,d){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=d,u.m=5,Sy(u),Ma(u)}function Sy(u){u.A||(u.A=!0,at(u,"complete"),at(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,at(this,"complete"),at(this,"abort"),Ma(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ma(this,!0)),ke.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Ay(this):this.bb())},n.bb=function(){Ay(this)};function Ay(u){if(u.h&&typeof s<"u"&&(!u.v[1]||wn(u)!=4||u.Z()!=2)){if(u.u&&wn(u)==4)Ym(u.Ea,0,u);else if(at(u,"readystatechange"),wn(u)==4){u.h=!1;try{let O=u.Z();e:switch(O){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var f;if(!(f=d)){var g;if(g=O===0){var T=String(u.D).match(vy)[1]||null;!T&&a.self&&a.self.location&&(T=a.self.location.protocol.slice(0,-1)),g=!bC.test(T?T.toLowerCase():"")}f=g}if(f)at(u,"complete"),at(u,"success");else{u.m=6;try{var S=2<wn(u)?u.g.statusText:""}catch{S=""}u.l=S+" ["+u.Z()+"]",Sy(u)}}finally{Ma(u)}}}}function Ma(u,d){if(u.g){xy(u);let f=u.g,g=u.v[0]?()=>{}:null;u.g=null,u.v=null,d||at(u,"ready");try{f.onreadystatechange=g}catch{}}}function xy(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function wn(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<wn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var d=this.g.responseText;return u&&d.indexOf(u)==0&&(d=d.substring(u.length)),oC(d)}};function My(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function AC(u){let d={};u=(u.g&&2<=wn(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let g=0;g<u.length;g++){if($(u[g]))continue;var f=D(u[g]);let T=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();let S=d[T]||[];d[T]=S,S.push(f)}I(d,function(g){return g.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Qo(u,d,f){return f&&f.internalChannelParams&&f.internalChannelParams[u]||d}function Ny(u){this.Aa=0,this.i=[],this.j=new Uo,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Qo("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Qo("baseRetryDelayMs",5e3,u),this.cb=Qo("retryDelaySeedMs",1e4,u),this.Wa=Qo("forwardChannelMaxRetries",2,u),this.wa=Qo("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new hy(u&&u.concurrentRequestLimit),this.Da=new TC,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Ny.prototype,n.la=8,n.G=1,n.connect=function(u,d,f,g){ut(0),this.W=u,this.H=d||{},f&&g!==void 0&&(this.H.OSID=f,this.H.OAID=g),this.F=this.X,this.I=By(this,null,this.W),Ra(this)};function od(u){if(Ry(u),u.G==3){var d=u.U++,f=_n(u.I);if(Se(f,"SID",u.K),Se(f,"RID",d),Se(f,"TYPE","terminate"),Yo(u,f),d=new $n(u,u.j,d),d.L=2,d.v=Aa(_n(f)),f=!1,a.navigator&&a.navigator.sendBeacon)try{f=a.navigator.sendBeacon(d.v.toString(),"")}catch{}!f&&a.Image&&(new Image().src=d.v,f=!0),f||(d.g=Uy(d.j,null),d.g.ea(d.v)),d.F=Date.now(),Ca(d)}jy(u)}function Na(u){u.g&&(ad(u),u.g.cancel(),u.g=null)}function Ry(u){Na(u),u.u&&(a.clearTimeout(u.u),u.u=null),Pa(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function Ra(u){if(!fy(u.h)&&!u.s){u.s=!0;var d=u.Ga;Po||qm(),ko||(Po(),ko=!0),Vl.add(d,u),u.B=0}}function xC(u,d){return py(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=d.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Bo(m(u.Ga,u,d),Vy(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let T=new $n(this,this.j,u),S=this.o;if(this.S&&(S?(S=y(S),E(S,this.S)):S=this.S),this.m!==null||this.O||(T.H=S,S=null),this.P)e:{for(var d=0,f=0;f<this.i.length;f++){t:{var g=this.i[f];if("__data__"in g.map&&(g=g.map.__data__,typeof g=="string")){g=g.length;break t}g=void 0}if(g===void 0)break;if(d+=g,4096<d){d=f;break e}if(d===4096||f===this.i.length-1){d=f+1;break e}}d=1e3}else d=1e3;d=ky(this,T,d),f=_n(this.I),Se(f,"RID",u),Se(f,"CVER",22),this.D&&Se(f,"X-HTTP-Session-Id",this.D),Yo(this,f),S&&(this.O?d="headers="+encodeURIComponent(String(Cy(S)))+"&"+d:this.m&&id(f,this.m,S)),rd(this.h,T),this.Ua&&Se(f,"TYPE","init"),this.P?(Se(f,"$req",d),Se(f,"SID","null"),T.T=!0,Xl(T,f,null)):Xl(T,f,d),this.G=2}}else this.G==3&&(u?Py(this,u):this.i.length==0||fy(this.h)||Py(this))};function Py(u,d){var f;d?f=d.l:f=u.U++;let g=_n(u.I);Se(g,"SID",u.K),Se(g,"RID",f),Se(g,"AID",u.T),Yo(u,g),u.m&&u.o&&id(g,u.m,u.o),f=new $n(u,u.j,f,u.B+1),u.m===null&&(f.H=u.o),d&&(u.i=d.D.concat(u.i)),d=ky(u,f,1e3),f.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),rd(u.h,f),Xl(f,g,d)}function Yo(u,d){u.H&&G(u.H,function(f,g){Se(d,g,f)}),u.l&&yy({},function(f,g){Se(d,g,f)})}function ky(u,d,f){f=Math.min(u.i.length,f);var g=u.l?m(u.l.Na,u.l,u):null;e:{var T=u.i;let S=-1;for(;;){let O=["count="+f];S==-1?0<f?(S=T[0].g,O.push("ofs="+S)):S=0:O.push("ofs="+S);let we=!0;for(let Ke=0;Ke<f;Ke++){let de=T[Ke].g,nt=T[Ke].map;if(de-=S,0>de)S=Math.max(0,T[Ke].g-100),we=!1;else try{CC(nt,O,"req"+de+"_")}catch{g&&g(nt)}}if(we){g=O.join("&");break e}}}return u=u.i.splice(0,f),d.D=u,g}function Oy(u){if(!u.g&&!u.u){u.Y=1;var d=u.Fa;Po||qm(),ko||(Po(),ko=!0),Vl.add(d,u),u.v=0}}function sd(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Bo(m(u.Fa,u),Vy(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,Fy(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Bo(m(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ut(10),Na(this),Fy(this))};function ad(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function Fy(u){u.g=new $n(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var d=_n(u.qa);Se(d,"RID","rpc"),Se(d,"SID",u.K),Se(d,"AID",u.T),Se(d,"CI",u.F?"0":"1"),!u.F&&u.ja&&Se(d,"TO",u.ja),Se(d,"TYPE","xmlhttp"),Yo(u,d),u.m&&u.o&&id(d,u.m,u.o),u.L&&(u.g.I=u.L);var f=u.g;u=u.ia,f.L=1,f.v=Aa(_n(d)),f.m=null,f.P=!0,cy(f,u)}n.Za=function(){this.C!=null&&(this.C=null,Na(this),sd(this),ut(19))};function Pa(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function Ly(u,d){var f=null;if(u.g==d){Pa(u),ad(u),u.g=null;var g=2}else if(nd(u.h,d))f=d.D,gy(u.h,d),g=1;else return;if(u.G!=0){if(d.o)if(g==1){f=d.m?d.m.length:0,d=Date.now()-d.F;var T=u.B;g=Ea(),at(g,new oy(g,f)),Ra(u)}else Oy(u);else if(T=d.s,T==3||T==0&&0<d.X||!(g==1&&xC(u,d)||g==2&&sd(u)))switch(f&&0<f.length&&(d=u.h,d.i=d.i.concat(f)),T){case 1:Tr(u,5);break;case 4:Tr(u,10);break;case 3:Tr(u,6);break;default:Tr(u,2)}}}function Vy(u,d){let f=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(f*=2),f*d}function Tr(u,d){if(u.j.info("Error code "+d),d==2){var f=m(u.fb,u),g=u.Xa;let T=!g;g=new Dr(g||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||ba(g,"https"),Aa(g),T?EC(g.toString(),f):DC(g.toString(),f)}else ut(2);u.G=0,u.l&&u.l.sa(d),jy(u),Ry(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),ut(2)):(this.j.info("Failed to ping google.com"),ut(1))};function jy(u){if(u.G=0,u.ka=[],u.l){let d=my(u.h);(d.length!=0||u.i.length!=0)&&(R(u.ka,d),R(u.ka,u.i),u.h.i.length=0,N(u.i),u.i.length=0),u.l.ra()}}function By(u,d,f){var g=f instanceof Dr?_n(f):new Dr(f);if(g.g!="")d&&(g.g=d+"."+g.g),Sa(g,g.s);else{var T=a.location;g=T.protocol,d=d?d+"."+T.hostname:T.hostname,T=+T.port;var S=new Dr(null);g&&ba(S,g),d&&(S.g=d),T&&Sa(S,T),f&&(S.l=f),g=S}return f=u.D,d=u.ya,f&&d&&Se(g,f,d),Se(g,"VER",u.la),Yo(u,g),g}function Uy(u,d,f){if(d&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=u.Ca&&!u.pa?new ke(new Go({eb:f})):new ke(u.pa),d.Ha(u.J),d}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function $y(){}n=$y.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ka(){}ka.prototype.g=function(u,d){return new wt(u,d)};function wt(u,d){tt.call(this),this.g=new Ny(d),this.l=u,this.h=d&&d.messageUrlParams||null,u=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(u?u["X-WebChannel-Content-Type"]=d.messageContentType:u={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(u?u["X-WebChannel-Client-Profile"]=d.va:u={"X-WebChannel-Client-Profile":d.va}),this.g.S=u,(u=d&&d.Sb)&&!$(u)&&(this.g.m=u),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!$(d)&&(this.g.D=d,u=this.h,u!==null&&d in u&&(u=this.h,d in u&&delete u[d])),this.j=new mi(this)}M(wt,tt),wt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},wt.prototype.close=function(){od(this.g)},wt.prototype.o=function(u){var d=this.g;if(typeof u=="string"){var f={};f.__data__=u,u=f}else this.u&&(f={},f.__data__=Wl(u),u=f);d.i.push(new hC(d.Ya++,u)),d.G==3&&Ra(d)},wt.prototype.N=function(){this.g.l=null,delete this.j,od(this.g),delete this.g,wt.aa.N.call(this)};function Hy(u){Ql.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var d=u.__sm__;if(d){e:{for(let f in d){u=f;break e}u=void 0}(this.i=u)&&(u=this.i,d=d!==null&&u in d?d[u]:void 0),this.data=d}else this.data=u}M(Hy,Ql);function qy(){Yl.call(this),this.status=1}M(qy,Yl);function mi(u){this.g=u}M(mi,$y),mi.prototype.ua=function(){at(this.g,"a")},mi.prototype.ta=function(u){at(this.g,new Hy(u))},mi.prototype.sa=function(u){at(this.g,new qy)},mi.prototype.ra=function(){at(this.g,"b")},ka.prototype.createWebChannel=ka.prototype.g,wt.prototype.send=wt.prototype.o,wt.prototype.open=wt.prototype.m,wt.prototype.close=wt.prototype.close,$f=Nn.createWebChannelTransport=function(){return new ka},Uf=Nn.getStatEventTarget=function(){return Ea()},Bf=Nn.Event=Ir,gc=Nn.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Da.NO_ERROR=0,Da.TIMEOUT=8,Da.HTTP_ERROR=6,Rs=Nn.ErrorCode=Da,sy.COMPLETE="complete",jf=Nn.EventType=sy,ty.EventType=Vo,Vo.OPEN="a",Vo.CLOSE="b",Vo.ERROR="c",Vo.MESSAGE="d",tt.prototype.listen=tt.prototype.K,qi=Nn.WebChannel=ty,$N=Nn.FetchXmlHttpFactory=Go,ke.prototype.listenOnce=ke.prototype.L,ke.prototype.getLastError=ke.prototype.Ka,ke.prototype.getLastErrorCode=ke.prototype.Ba,ke.prototype.getStatus=ke.prototype.Z,ke.prototype.getResponseJson=ke.prototype.Oa,ke.prototype.getResponseText=ke.prototype.oa,ke.prototype.send=ke.prototype.ea,ke.prototype.setWithCredentials=ke.prototype.Ha,Vf=Nn.XhrIo=ke}).apply(typeof pc<"u"?pc:typeof self<"u"?self:typeof window<"u"?window:{});var nE="@firebase/firestore";var He=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};He.UNAUTHENTICATED=new He(null),He.GOOGLE_CREDENTIALS=new He("google-credentials-uid"),He.FIRST_PARTY=new He("first-party-uid"),He.MOCK_USER=new He("mock-user");var Eo="10.14.0";var ur=new Va("@firebase/firestore");function Qi(){return ur.logLevel}function oD(n){ur.setLogLevel(n)}function k(n,...e){if(ur.logLevel<=Xt.DEBUG){let t=e.map(Wg);ur.debug(`Firestore (${Eo}): ${n}`,...t)}}function Le(n,...e){if(ur.logLevel<=Xt.ERROR){let t=e.map(Wg);ur.error(`Firestore (${Eo}): ${n}`,...t)}}function Kt(n,...e){if(ur.logLevel<=Xt.WARN){let t=e.map(Wg);ur.warn(`Firestore (${Eo}): ${n}`,...t)}}function Wg(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function U(n="Unexpected state"){let e=`FIRESTORE (${Eo}) INTERNAL ASSERTION FAILED: `+n;throw Le(e),new Error(e)}function H(n,e){n||U()}function sD(n,e){n||U()}function V(n,e){return n}var A={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},P=class extends Yy{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Ge=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Cc=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Kf=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(He.UNAUTHENTICATED))}shutdown(){}},Qf=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Yf=class{constructor(e){this.t=e,this.currentUser=He.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){H(this.o===void 0);let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),o=new Ge;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ge,e.enqueueRetryable(()=>i(this.currentUser))};let s=()=>{let c=o;e.enqueueRetryable(()=>x(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{k("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(k("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ge)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(k("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(H(typeof r.accessToken=="string"),new Cc(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return H(e===null||typeof e=="string"),new He(e)}},Zf=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=He.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Jf=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new Zf(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(He.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Xf=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},ep=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){H(this.o===void 0);let r=o=>{o.error!=null&&k("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.R;return this.R=o.token,k("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{k("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?i(o):k("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(H(typeof t.token=="string"),this.R=t.token,new Xf(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function HN(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var bc=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=HN(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%e.length))}return r}};function Z(n,e){return n<e?-1:n>e?1:0}function io(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function aD(n){return n+"\0"}var Re=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new P(A.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new P(A.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new P(A.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new P(A.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Z(this.nanoseconds,e.nanoseconds):Z(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var q=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new Re(0,0))}static max(){return new n(new Re(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Sc=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&U(),r===void 0?r=e.length-t:r>e.length-t&&U(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=e.get(i),s=t.get(i);if(o<s)return-1;if(o>s)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},ce=class n extends Sc{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new P(A.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},qN=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ve=class n extends Sc{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return qN.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new P(A.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new P(A.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new P(A.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(s=!s,i++):a!=="."||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new P(A.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var j=class n{constructor(e){this.path=e}static fromPath(e){return new n(ce.fromString(e))}static fromName(e){return new n(ce.fromString(e).popFirst(5))}static empty(){return new n(ce.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ce.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ce.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new ce(e.slice()))}};var oo=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function tp(n){return n.fields.find(e=>e.kind===2)}function $r(n){return n.fields.filter(e=>e.kind!==2)}oo.UNKNOWN_ID=-1;var to=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var qs=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,Ot.min())}};function uD(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=q.fromTimestamp(r===1e9?new Re(t+1,0):new Re(t,r));return new Ot(i,j.empty(),e)}function cD(n){return new Ot(n.readTime,n.key,-1)}var Ot=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(q.min(),j.empty(),-1)}static max(){return new n(q.max(),j.empty(),-1)}};function Kg(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=j.comparator(n.documentKey,e.documentKey),t!==0?t:Z(n.largestBatchId,e.largestBatchId))}var lD="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ac=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function vr(n){return x(this,null,function*(){if(n.code!==A.FAILED_PRECONDITION||n.message!==lD)throw n;k("LocalStore","Unexpectedly lost primary lease")})}var b=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&U(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,s=!1;e.forEach(a=>{++i,a.next(()=>{++o,s&&o===i&&t()},c=>r(c))}),s=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,s=new Array(o),a=0;for(let c=0;c<o;c++){let l=c;t(e[l]).next(h=>{s[l]=h,++a,a===o&&r(s)},h=>i(h))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};var xc=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Ge,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Kr(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=Qg(r.target.error);this.V.reject(new Kr(e,i))}}static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(o){throw new Kr(t,o)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(k("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new rp(t)}},cr=class n{constructor(e,t,r){this.name=e,this.version=t,this.p=r,n.S(Zo())===12.2&&Le("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return k("SimpleDb","Removing database:",e),Hr(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!La())return!1;if(n.v())return!0;let e=Zo(),t=n.S(e),r=0<t&&t<10,i=dD(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return x(this,null,function*(){return this.db||(k("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{let s=o.target.result;t(s)},i.onblocked=()=>{r(new Kr(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{let s=o.target.error;s.name==="VersionError"?r(new P(A.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):s.name==="InvalidStateError"?r(new P(A.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+s)):r(new Kr(e,s))},i.onupgradeneeded=o=>{k("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);let s=o.target.result;this.p.O(s,i.transaction,o.oldVersion,this.version).next(()=>{k("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return x(this,null,function*(){let o=t==="readonly",s=0;for(;;){++s;try{this.db=yield this.M(e);let a=xc.open(this.db,e,o?"readonly":"readwrite",r),c=i(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),b.reject(l))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,l=c.name!=="FirebaseError"&&s<3;if(k("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function dD(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var np=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Hr(this.B.delete())}},Kr=class extends P{constructor(e,t){super(A.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function _r(n){return n.name==="IndexedDbTransactionError"}var rp=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(k("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(k("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Hr(r)}add(e){return k("SimpleDb","ADD",this.store.name,e,e),Hr(this.store.add(e))}get(e){return Hr(this.store.get(e)).next(t=>(t===void 0&&(t=null),k("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return k("SimpleDb","DELETE",this.store.name,e),Hr(this.store.delete(e))}count(){return k("SimpleDb","COUNT",this.store.name),Hr(this.store.count())}U(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let o=i.getAll(r.range);return new b((s,a)=>{o.onerror=c=>{a(c.target.error)},o.onsuccess=c=>{s(c.target.result)}})}{let o=this.cursor(r),s=[];return this.W(o,(a,c)=>{s.push(c)}).next(()=>s)}}G(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new b((i,o)=>{r.onerror=s=>{o(s.target.error)},r.onsuccess=s=>{i(s.target.result)}})}j(e,t){k("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.H=!1;let i=this.cursor(r);return this.W(i,(o,s,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.W(i,t)}Y(e){let t=this.cursor({});return new b((r,i)=>{t.onerror=o=>{let s=Qg(o.target.error);i(s)},t.onsuccess=o=>{let s=o.target.result;s?e(s.primaryKey,s.value).next(a=>{a?s.continue():r()}):r()}})}W(e,t){let r=[];return new b((i,o)=>{e.onerror=s=>{o(s.target.error)},e.onsuccess=s=>{let a=s.target.result;if(!a)return void i();let c=new np(a),l=t(a.primaryKey,a.value,c);if(l instanceof b){let h=l.catch(p=>(c.done(),b.reject(p)));r.push(h)}c.isDone?i():c.K===null?a.continue():a.continue(c.K)}}).next(()=>b.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function Hr(n){return new b((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=Qg(r.target.error);t(i)}})}var rE=!1;function Qg(n){let e=cr.S(Zo());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new P("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return rE||(rE=!0,setTimeout(()=>{throw r},0)),r}}return n}var ip=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){k("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>x(this,null,function*(){this.task=null;try{k("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){_r(t)?k("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield vr(t)}yield this.X(6e4)}))}},op=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return x(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let r=new Set,i=t,o=!0;return b.doWhile(()=>o===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(s=>{if(s!==null&&!r.has(s))return k("IndexBackfiller",`Processing collection: ${s}`),this.ne(e,s,i).next(a=>{i-=a,r.add(s)});o=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(o=>{let s=o.changes;return this.localStore.indexManager.updateIndexEntries(e,s).next(()=>this.re(i,o)).next(a=>(k("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>s.size)}))}re(e,t){let r=e;return t.changes.forEach((i,o)=>{let s=cD(o);Kg(s,r)>0&&(r=s)}),new Ot(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var bt=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function da(n){return n==null}function zs(n){return n===0&&1/n==-1/0}function hD(n){return typeof n=="number"&&Number.isInteger(n)&&!zs(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function ht(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=iE(e)),e=zN(n.get(t),e);return iE(e)}function zN(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let o=n.charAt(i);switch(o){case"\0":t+="";break;case"":t+="";break;default:t+=o}}return t}function iE(n){return n+""}function un(n){let e=n.length;if(H(e>=2),e===2)return H(n.charAt(0)===""&&n.charAt(1)===""),ce.emptyPath();let t=e-2,r=[],i="";for(let o=0;o<e;){let s=n.indexOf("",o);switch((s<0||s>t)&&U(),n.charAt(s+1)){case"":let a=n.substring(o,s),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=n.substring(o,s),i+="\0";break;case"":i+=n.substring(o,s+1);break;default:U()}o=s+2}return new ce(r)}var oE=["userId","batchId"];function wc(n,e){return[n,ht(e)]}function fD(n,e,t){return[n,ht(e),t]}var GN={},WN=["prefixPath","collectionGroup","readTime","documentId"],KN=["prefixPath","collectionGroup","documentId"],QN=["collectionGroup","readTime","prefixPath","documentId"],YN=["canonicalId","targetId"],ZN=["targetId","path"],JN=["path","targetId"],XN=["collectionId","parent"],eR=["indexId","uid"],tR=["uid","sequenceNumber"],nR=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],rR=["indexId","uid","orderedDocumentKey"],iR=["userId","collectionPath","documentId"],oR=["userId","collectionPath","largestBatchId"],sR=["userId","collectionGroup","largestBatchId"],pD=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],aR=[...pD,"documentOverlays"],gD=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],mD=gD,Yg=[...mD,"indexConfiguration","indexState","indexEntries"],uR=Yg,cR=[...Yg,"globals"];var Gs=class extends Ac{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function We(n,e){let t=V(n);return cr.F(t._e,e)}function sE(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function si(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function yD(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var xe=class n{constructor(e,t){this.comparator=e,this.root=t||ln.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ln.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ln.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new eo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new eo(this.root,e,this.comparator,!1)}getReverseIterator(){return new eo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new eo(this.root,e,this.comparator,!0)}},eo=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},ln=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw U();let e=this.left.check();if(e!==this.right.check())throw U();return e+(this.isRed()?0:1)}};ln.EMPTY=null,ln.RED=!0,ln.BLACK=!1;ln.EMPTY=new class{constructor(){this.size=0}get key(){throw U()}get value(){throw U()}get color(){throw U()}get left(){throw U()}get right(){throw U()}copy(e,t,r,i,o){return this}insert(e,t,r){return new ln(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ee=class n{constructor(e){this.comparator=e,this.data=new xe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Mc(this.data.getIterator())}getIteratorFrom(e){return new Mc(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Mc=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function zi(n){return n.hasNext()?n.getNext():void 0}var St=class n{constructor(e){this.fields=e,e.sort(Ve.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ee(Ve.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return io(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Nc=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function vD(){return typeof atob<"u"}var Be=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Nc("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Z(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Be.EMPTY_BYTE_STRING=new Be("");var lR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function kn(n){if(H(!!n),typeof n=="string"){let e=0,t=lR.exec(n);if(H(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Me(n.seconds),nanos:Me(n.nanos)}}function Me(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function lr(n){return typeof n=="string"?Be.fromBase64String(n):Be.fromUint8Array(n)}function El(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Zg(n){let e=n.mapValue.fields.__previous_value__;return El(e)?Zg(e):e}function Ws(n){let e=kn(n.mapValue.fields.__local_write_time__.timestampValue);return new Re(e.seconds,e.nanos)}var sp=class{constructor(e,t,r,i,o,s,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}},dr=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var sr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Ic={nullValue:"NULL_VALUE"};function Qr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?El(n)?4:_D(n)?9007199254740991:Dl(n)?10:11:U()}function fn(n,e){if(n===e)return!0;let t=Qr(n);if(t!==Qr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ws(n).isEqual(Ws(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let s=kn(i.timestampValue),a=kn(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return lr(i.bytesValue).isEqual(lr(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return Me(i.geoPointValue.latitude)===Me(o.geoPointValue.latitude)&&Me(i.geoPointValue.longitude)===Me(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return Me(i.integerValue)===Me(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let s=Me(i.doubleValue),a=Me(o.doubleValue);return s===a?zs(s)===zs(a):isNaN(s)&&isNaN(a)}return!1}(n,e);case 9:return io(n.arrayValue.values||[],e.arrayValue.values||[],fn);case 10:case 11:return function(i,o){let s=i.mapValue.fields||{},a=o.mapValue.fields||{};if(sE(s)!==sE(a))return!1;for(let c in s)if(s.hasOwnProperty(c)&&(a[c]===void 0||!fn(s[c],a[c])))return!1;return!0}(n,e);default:return U()}}function Ks(n,e){return(n.values||[]).find(t=>fn(t,e))!==void 0}function hr(n,e){if(n===e)return 0;let t=Qr(n),r=Qr(e);if(t!==r)return Z(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Z(n.booleanValue,e.booleanValue);case 2:return function(o,s){let a=Me(o.integerValue||o.doubleValue),c=Me(s.integerValue||s.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return aE(n.timestampValue,e.timestampValue);case 4:return aE(Ws(n),Ws(e));case 5:return Z(n.stringValue,e.stringValue);case 6:return function(o,s){let a=lr(o),c=lr(s);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(o,s){let a=o.split("/"),c=s.split("/");for(let l=0;l<a.length&&l<c.length;l++){let h=Z(a[l],c[l]);if(h!==0)return h}return Z(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,s){let a=Z(Me(o.latitude),Me(s.latitude));return a!==0?a:Z(Me(o.longitude),Me(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return uE(n.arrayValue,e.arrayValue);case 10:return function(o,s){var a,c,l,h;let p=o.fields||{},m=s.fields||{},v=(a=p.value)===null||a===void 0?void 0:a.arrayValue,M=(c=m.value)===null||c===void 0?void 0:c.arrayValue,N=Z(((l=v?.values)===null||l===void 0?void 0:l.length)||0,((h=M?.values)===null||h===void 0?void 0:h.length)||0);return N!==0?N:uE(v,M)}(n.mapValue,e.mapValue);case 11:return function(o,s){if(o===sr.mapValue&&s===sr.mapValue)return 0;if(o===sr.mapValue)return 1;if(s===sr.mapValue)return-1;let a=o.fields||{},c=Object.keys(a),l=s.fields||{},h=Object.keys(l);c.sort(),h.sort();for(let p=0;p<c.length&&p<h.length;++p){let m=Z(c[p],h[p]);if(m!==0)return m;let v=hr(a[c[p]],l[h[p]]);if(v!==0)return v}return Z(c.length,h.length)}(n.mapValue,e.mapValue);default:throw U()}}function aE(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Z(n,e);let t=kn(n),r=kn(e),i=Z(t.seconds,r.seconds);return i!==0?i:Z(t.nanos,r.nanos)}function uE(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=hr(t[i],r[i]);if(o)return o}return Z(t.length,r.length)}function so(n){return ap(n)}function ap(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=kn(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return lr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return j.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=ap(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let s of r)o?o=!1:i+=",",i+=`${s}:${ap(t.fields[s])}`;return i+"}"}(n.mapValue):U()}function Yr(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function up(n){return!!n&&"integerValue"in n}function Qs(n){return!!n&&"arrayValue"in n}function cE(n){return!!n&&"nullValue"in n}function lE(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ec(n){return!!n&&"mapValue"in n}function Dl(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function js(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return si(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=js(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=js(n.arrayValue.values[t]);return e}return Object.assign({},n)}function _D(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var wD={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function dR(n){return"nullValue"in n?Ic:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Yr(dr.empty(),j.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Dl(n)?wD:{mapValue:{}}:U()}function hR(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Yr(dr.empty(),j.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?wD:"mapValue"in n?Dl(n)?{mapValue:{}}:sr:U()}function dE(n,e){let t=hr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function hE(n,e){let t=hr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var st=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Ec(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=js(t)}setAll(e){let t=Ve.emptyPath(),r={},i=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}s?r[a.lastSegment()]=js(s):i.push(a.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());Ec(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return fn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Ec(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){si(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(js(this.value))}};function ID(n){let e=[];return si(n.fields,(t,r)=>{let i=new Ve([t]);if(Ec(r)){let o=ID(r.mapValue).fields;if(o.length===0)e.push(i);else for(let s of o)e.push(i.child(s))}else e.push(i)}),new St(e)}var qe=class n{constructor(e,t,r,i,o,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new n(e,0,q.min(),q.min(),q.min(),st.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,q.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,q.min(),q.min(),st.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,q.min(),q.min(),st.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=st.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=st.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=q.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var pn=class{constructor(e,t){this.position=e,this.inclusive=t}};function fE(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],s=n.position[i];if(o.field.isKeyField()?r=j.comparator(j.fromName(s.referenceValue),t.key):r=hr(s,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function pE(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!fn(n.position[t],e.position[t]))return!1;return!0}var Zr=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function fR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Rc=class{},se=class n extends Rc{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new dp(e,t,r):t==="array-contains"?new pp(e,r):t==="in"?new Pc(e,r):t==="not-in"?new gp(e,r):t==="array-contains-any"?new mp(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new hp(e,r):new fp(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(hr(t,this.value)):t!==null&&Qr(this.value)===Qr(t)&&this.matchesComparison(hr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return U()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},ve=class n extends Rc{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return ao(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function ao(n){return n.op==="and"}function cp(n){return n.op==="or"}function Jg(n){return ED(n)&&ao(n)}function ED(n){for(let e of n.filters)if(e instanceof ve)return!1;return!0}function lp(n){if(n instanceof se)return n.field.canonicalString()+n.op.toString()+so(n.value);if(Jg(n))return n.filters.map(e=>lp(e)).join(",");{let e=n.filters.map(t=>lp(t)).join(",");return`${n.op}(${e})`}}function DD(n,e){return n instanceof se?function(r,i){return i instanceof se&&r.op===i.op&&r.field.isEqual(i.field)&&fn(r.value,i.value)}(n,e):n instanceof ve?function(r,i){return i instanceof ve&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,s,a)=>o&&DD(s,i.filters[a]),!0):!1}(n,e):void U()}function TD(n,e){let t=n.filters.concat(e);return ve.create(t,n.op)}function CD(n){return n instanceof se?function(t){return`${t.field.canonicalString()} ${t.op} ${so(t.value)}`}(n):n instanceof ve?function(t){return t.op.toString()+" {"+t.getFilters().map(CD).join(" ,")+"}"}(n):"Filter"}var dp=class extends se{constructor(e,t,r){super(e,t,r),this.key=j.fromName(r.referenceValue)}matches(e){let t=j.comparator(e.key,this.key);return this.matchesComparison(t)}},hp=class extends se{constructor(e,t){super(e,"in",t),this.keys=bD("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},fp=class extends se{constructor(e,t){super(e,"not-in",t),this.keys=bD("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function bD(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>j.fromName(r.referenceValue))}var pp=class extends se{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Qs(t)&&Ks(t.arrayValue,this.value)}},Pc=class extends se{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Ks(this.value.arrayValue,t)}},gp=class extends se{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ks(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Ks(this.value.arrayValue,t)}},mp=class extends se{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Qs(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Ks(this.value.arrayValue,r))}};var yp=class{constructor(e,t=null,r=[],i=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.ue=null}};function vp(n,e=null,t=[],r=[],i=null,o=null,s=null){return new yp(n,e,t,r,i,o,s)}function Jr(n){let e=V(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>lp(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),da(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>so(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>so(r)).join(",")),e.ue=t}return e.ue}function ha(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!fR(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!DD(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!pE(n.startAt,e.startAt)&&pE(n.endAt,e.endAt)}function kc(n){return j.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Oc(n,e){return n.filters.filter(t=>t instanceof se&&t.field.isEqual(e))}function gE(n,e,t){let r=Ic,i=!0;for(let o of Oc(n,e)){let s=Ic,a=!0;switch(o.op){case"<":case"<=":s=dR(o.value);break;case"==":case"in":case">=":s=o.value;break;case">":s=o.value,a=!1;break;case"!=":case"not-in":s=Ic}dE({value:r,inclusive:i},{value:s,inclusive:a})<0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];dE({value:r,inclusive:i},{value:s,inclusive:t.inclusive})<0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}function mE(n,e,t){let r=sr,i=!0;for(let o of Oc(n,e)){let s=sr,a=!0;switch(o.op){case">=":case">":s=hR(o.value),a=!1;break;case"==":case"in":case"<=":s=o.value;break;case"<":s=o.value,a=!1;break;case"!=":case"not-in":s=sr}hE({value:r,inclusive:i},{value:s,inclusive:a})>0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];hE({value:r,inclusive:i},{value:s,inclusive:t.inclusive})>0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}var Qt=class{constructor(e,t=null,r=[],i=[],o=null,s="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function SD(n,e,t,r,i,o,s,a){return new Qt(n,e,t,r,i,o,s,a)}function Do(n){return new Qt(n)}function yE(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Xg(n){return n.collectionGroup!==null}function no(n){let e=V(n);if(e.ce===null){e.ce=[];let t=new Set;for(let o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Ee(Ve.comparator);return s.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new Zr(o,r))}),t.has(Ve.keyField().canonicalString())||e.ce.push(new Zr(Ve.keyField(),r))}return e.ce}function ft(n){let e=V(n);return e.le||(e.le=pR(e,no(n))),e.le}function pR(n,e){if(n.limitType==="F")return vp(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new Zr(i.field,o)});let t=n.endAt?new pn(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new pn(n.startAt.position,n.startAt.inclusive):null;return vp(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function _p(n,e){let t=n.filters.concat([e]);return new Qt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Fc(n,e,t){return new Qt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function fa(n,e){return ha(ft(n),ft(e))&&n.limitType===e.limitType}function AD(n){return`${Jr(ft(n))}|lt:${n.limitType}`}function Yi(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>CD(i)).join(", ")}]`),da(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>so(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>so(i)).join(",")),`Target(${r})`}(ft(n))}; limitType=${n.limitType})`}function pa(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):j.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of no(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(s,a,c){let l=fE(s,a,c);return s.inclusive?l<=0:l<0}(r.startAt,no(r),i)||r.endAt&&!function(s,a,c){let l=fE(s,a,c);return s.inclusive?l>=0:l>0}(r.endAt,no(r),i))}(n,e)}function xD(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function MD(n){return(e,t)=>{let r=!1;for(let i of no(n)){let o=gR(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function gR(n,e,t){let r=n.field.isKeyField()?j.comparator(e.key,t.key):function(o,s,a){let c=s.data.field(o),l=a.data.field(o);return c!==null&&l!==null?hr(c,l):U()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return U()}}var gn=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){si(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return yD(this.inner)}size(){return this.innerSize}};var mR=new xe(j.comparator);function vt(){return mR}var ND=new xe(j.comparator);function Ls(...n){let e=ND;for(let t of n)e=e.insert(t.key,t);return e}function RD(n){let e=ND;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function cn(){return Bs()}function PD(){return Bs()}function Bs(){return new gn(n=>n.toString(),(n,e)=>n.isEqual(e))}var yR=new xe(j.comparator),vR=new Ee(j.comparator);function X(...n){let e=vR;for(let t of n)e=e.add(t);return e}var _R=new Ee(Z);function em(){return _R}function tm(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zs(e)?"-0":e}}function kD(n){return{integerValue:""+n}}function OD(n,e){return hD(e)?kD(e):tm(n,e)}var uo=class{constructor(){this._=void 0}};function wR(n,e,t){return n instanceof fr?function(i,o){let s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&El(o)&&(o=Zg(o)),o&&(s.fields.__previous_value__=o),{mapValue:s}}(t,e):n instanceof On?LD(n,e):n instanceof Fn?VD(n,e):function(i,o){let s=FD(i,o),a=vE(s)+vE(i.Pe);return up(s)&&up(i.Pe)?kD(a):tm(i.serializer,a)}(n,e)}function IR(n,e,t){return n instanceof On?LD(n,e):n instanceof Fn?VD(n,e):t}function FD(n,e){return n instanceof pr?function(r){return up(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var fr=class extends uo{},On=class extends uo{constructor(e){super(),this.elements=e}};function LD(n,e){let t=jD(e);for(let r of n.elements)t.some(i=>fn(i,r))||t.push(r);return{arrayValue:{values:t}}}var Fn=class extends uo{constructor(e){super(),this.elements=e}};function VD(n,e){let t=jD(e);for(let r of n.elements)t=t.filter(i=>!fn(i,r));return{arrayValue:{values:t}}}var pr=class extends uo{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function vE(n){return Me(n.integerValue||n.doubleValue)}function jD(n){return Qs(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var Xr=class{constructor(e,t){this.field=e,this.transform=t}};function ER(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof On&&i instanceof On||r instanceof Fn&&i instanceof Fn?io(r.elements,i.elements,fn):r instanceof pr&&i instanceof pr?fn(r.Pe,i.Pe):r instanceof fr&&i instanceof fr}(n.transform,e.transform)}var wp=class{constructor(e,t){this.version=e,this.transformResults=t}},Fe=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Dc(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var co=class{};function BD(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new mr(n.key,Fe.none()):new gr(n.key,n.data,Fe.none());{let t=n.data,r=st.empty(),i=new Ee(Ve.comparator);for(let o of e.fields)if(!i.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?r.delete(o):r.set(o,s),i=i.add(o)}return new Yt(n.key,r,new St(i.toArray()),Fe.none())}}function DR(n,e,t){n instanceof gr?function(i,o,s){let a=i.value.clone(),c=wE(i.fieldTransforms,o,s.transformResults);a.setAll(c),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Yt?function(i,o,s){if(!Dc(i.precondition,o))return void o.convertToUnknownDocument(s.version);let a=wE(i.fieldTransforms,o,s.transformResults),c=o.data;c.setAll(UD(i)),c.setAll(a),o.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(n,e,t):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,t)}function Us(n,e,t,r){return n instanceof gr?function(o,s,a,c){if(!Dc(o.precondition,s))return a;let l=o.value.clone(),h=IE(o.fieldTransforms,c,s);return l.setAll(h),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof Yt?function(o,s,a,c){if(!Dc(o.precondition,s))return a;let l=IE(o.fieldTransforms,c,s),h=s.data;return h.setAll(UD(o)),h.setAll(l),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(p=>p.field))}(n,e,t,r):function(o,s,a){return Dc(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a}(n,e,t)}function TR(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=FD(r.transform,i||null);o!=null&&(t===null&&(t=st.empty()),t.set(r.field,o))}return t||null}function _E(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&io(r,i,(o,s)=>ER(o,s))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var gr=class extends co{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Yt=class extends co{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function UD(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function wE(n,e,t){let r=new Map;H(n.length===t.length);for(let i=0;i<t.length;i++){let o=n[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,IR(s,a,t[i]))}return r}function IE(n,e,t){let r=new Map;for(let i of n){let o=i.transform,s=t.data.field(i.field);r.set(i.field,wR(o,s,e))}return r}var mr=class extends co{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Ys=class extends co{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Zs=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&DR(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Us(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Us(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=PD();return this.mutations.forEach(i=>{let o=e.get(i.key),s=o.overlayedDocument,a=this.applyToLocalView(s,o.mutatedFields);a=t.has(i.key)?null:a;let c=BD(s,a);c!==null&&r.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(q.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),X())}isEqual(e){return this.batchId===e.batchId&&io(this.mutations,e.mutations,(t,r)=>_E(t,r))&&io(this.baseMutations,e.baseMutations,(t,r)=>_E(t,r))}},Ip=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){H(e.mutations.length===r.length);let i=function(){return yR}(),o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new n(e,t,r,i)}};var Js=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Ep=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Ue,ue;function $D(n){switch(n){default:return U();case A.CANCELLED:case A.UNKNOWN:case A.DEADLINE_EXCEEDED:case A.RESOURCE_EXHAUSTED:case A.INTERNAL:case A.UNAVAILABLE:case A.UNAUTHENTICATED:return!1;case A.INVALID_ARGUMENT:case A.NOT_FOUND:case A.ALREADY_EXISTS:case A.PERMISSION_DENIED:case A.FAILED_PRECONDITION:case A.ABORTED:case A.OUT_OF_RANGE:case A.UNIMPLEMENTED:case A.DATA_LOSS:return!0}}function HD(n){if(n===void 0)return Le("GRPC error has no .code"),A.UNKNOWN;switch(n){case Ue.OK:return A.OK;case Ue.CANCELLED:return A.CANCELLED;case Ue.UNKNOWN:return A.UNKNOWN;case Ue.DEADLINE_EXCEEDED:return A.DEADLINE_EXCEEDED;case Ue.RESOURCE_EXHAUSTED:return A.RESOURCE_EXHAUSTED;case Ue.INTERNAL:return A.INTERNAL;case Ue.UNAVAILABLE:return A.UNAVAILABLE;case Ue.UNAUTHENTICATED:return A.UNAUTHENTICATED;case Ue.INVALID_ARGUMENT:return A.INVALID_ARGUMENT;case Ue.NOT_FOUND:return A.NOT_FOUND;case Ue.ALREADY_EXISTS:return A.ALREADY_EXISTS;case Ue.PERMISSION_DENIED:return A.PERMISSION_DENIED;case Ue.FAILED_PRECONDITION:return A.FAILED_PRECONDITION;case Ue.ABORTED:return A.ABORTED;case Ue.OUT_OF_RANGE:return A.OUT_OF_RANGE;case Ue.UNIMPLEMENTED:return A.UNIMPLEMENTED;case Ue.DATA_LOSS:return A.DATA_LOSS;default:return U()}}(ue=Ue||(Ue={}))[ue.OK=0]="OK",ue[ue.CANCELLED=1]="CANCELLED",ue[ue.UNKNOWN=2]="UNKNOWN",ue[ue.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ue[ue.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ue[ue.NOT_FOUND=5]="NOT_FOUND",ue[ue.ALREADY_EXISTS=6]="ALREADY_EXISTS",ue[ue.PERMISSION_DENIED=7]="PERMISSION_DENIED",ue[ue.UNAUTHENTICATED=16]="UNAUTHENTICATED",ue[ue.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ue[ue.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ue[ue.ABORTED=10]="ABORTED",ue[ue.OUT_OF_RANGE=11]="OUT_OF_RANGE",ue[ue.UNIMPLEMENTED=12]="UNIMPLEMENTED",ue[ue.INTERNAL=13]="INTERNAL",ue[ue.UNAVAILABLE=14]="UNAVAILABLE",ue[ue.DATA_LOSS=15]="DATA_LOSS";var EE=null;function qD(){return new TextEncoder}var CR=new tr([4294967295,4294967295],0);function DE(n){let e=qD().encode(n),t=new Lf;return t.update(e),new Uint8Array(t.digest())}function TE(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new tr([t,r],0),new tr([i,o],0)]}var Dp=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Wr(`Invalid padding: ${t}`);if(r<0)throw new Wr(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Wr(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Wr(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=tr.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(tr.fromNumber(r)));return i.compare(CR)===1&&(i=new tr([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=DE(e),[r,i]=TE(t);for(let o=0;o<this.hashCount;o++){let s=this.Ee(r,i,o);if(!this.de(s))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new n(o,i,t);return r.forEach(a=>s.insert(a)),s}insert(e){if(this.Ie===0)return;let t=DE(e),[r,i]=TE(t);for(let o=0;o<this.hashCount;o++){let s=this.Ee(r,i,o);this.Ae(s)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Wr=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Xs=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,ea.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(q.min(),i,new xe(Z),vt(),X())}},ea=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,X(),X(),X())}};var ro=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},Lc=class{constructor(e,t){this.targetId=e,this.me=t}},Vc=class{constructor(e,t,r=Be.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},jc=class{constructor(){this.fe=0,this.ge=bE(),this.pe=Be.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=X(),t=X(),r=X();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:U()}}),new ea(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=bE()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,H(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},Tp=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=vt(),this.qe=CE(),this.Qe=new xe(Z)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:U()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let o=i.target;if(kc(o))if(r===0){let s=new j(o.path);this.Ue(t,s,qe.newNoDocument(s,q.min()))}else H(r===1);else{let s=this.Ye(t);if(s!==r){let a=this.Ze(e),c=a?this.Xe(a,e,s):1;if(c!==0){this.je(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}EE?.et(function(h,p,m,v,M){var N,R,B,$,L,z;let W={localCacheCount:h,existenceFilterCount:p.count,databaseId:m.database,projectId:m.projectId},G=p.unchangedNames;return G&&(W.bloomFilter={applied:M===0,hashCount:(N=G?.hashCount)!==null&&N!==void 0?N:0,bitmapLength:($=(B=(R=G?.bits)===null||R===void 0?void 0:R.bitmap)===null||B===void 0?void 0:B.length)!==null&&$!==void 0?$:0,padding:(z=(L=G?.bits)===null||L===void 0?void 0:L.padding)!==null&&z!==void 0?z:0,mightContain:I=>{var y;return(y=v?.mightContain(I))!==null&&y!==void 0&&y}}),W}(s,e.me,this.Le.tt(),a,c))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,s,a;try{s=lr(r).toUint8Array()}catch(c){if(c instanceof Nc)return Kt("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new Dp(s,i,o)}catch(c){return Kt(c instanceof Wr?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let s=this.Le.tt(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,o,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((o,s)=>{let a=this.Je(s);if(a){if(o.current&&kc(a.target)){let c=new j(a.target.path);this.ke.get(c)!==null||this.it(s,c)||this.Ue(s,c,qe.newNoDocument(c,e))}o.be&&(t.set(s,o.ve()),o.Ce())}});let r=X();this.qe.forEach((o,s)=>{let a=!0;s.forEachWhile(c=>{let l=this.Je(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(o))}),this.ke.forEach((o,s)=>s.setReadTime(e));let i=new Xs(e,t,this.Qe,this.ke,r);return this.ke=vt(),this.qe=CE(),this.Qe=new xe(Z),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new jc,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Ee(Z),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||k("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new jc),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function CE(){return new xe(j.comparator)}function bE(){return new xe(j.comparator)}var bR={asc:"ASCENDING",desc:"DESCENDING"},SR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},AR={and:"AND",or:"OR"},Cp=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function bp(n,e){return n.useProto3Json||da(e)?e:{value:e}}function lo(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function zD(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function xR(n,e){return lo(n,e.toTimestamp())}function je(n){return H(!!n),q.fromTimestamp(function(t){let r=kn(t);return new Re(r.seconds,r.nanos)}(n))}function nm(n,e){return Sp(n,e).canonicalString()}function Sp(n,e){let t=function(i){return new ce(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function GD(n){let e=ce.fromString(n);return H(nT(e)),e}function ta(n,e){return nm(n.databaseId,e.path)}function dn(n,e){let t=GD(e);if(t.get(1)!==n.databaseId.projectId)throw new P(A.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new P(A.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new j(QD(t))}function WD(n,e){return nm(n.databaseId,e)}function KD(n){let e=GD(n);return e.length===4?ce.emptyPath():QD(e)}function Ap(n){return new ce(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function QD(n){return H(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function SE(n,e,t){return{name:ta(n,e),fields:t.value.mapValue.fields}}function YD(n,e,t){let r=dn(n,e.name),i=je(e.updateTime),o=e.createTime?je(e.createTime):q.min(),s=new st({mapValue:{fields:e.fields}}),a=qe.newFoundDocument(r,i,o,s);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function MR(n,e){return"found"in e?function(r,i){H(!!i.found),i.found.name,i.found.updateTime;let o=dn(r,i.found.name),s=je(i.found.updateTime),a=i.found.createTime?je(i.found.createTime):q.min(),c=new st({mapValue:{fields:i.found.fields}});return qe.newFoundDocument(o,s,a,c)}(n,e):"missing"in e?function(r,i){H(!!i.missing),H(!!i.readTime);let o=dn(r,i.missing),s=je(i.readTime);return qe.newNoDocument(o,s)}(n,e):U()}function NR(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:U()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(l,h){return l.useProto3Json?(H(h===void 0||typeof h=="string"),Be.fromBase64String(h||"")):(H(h===void 0||h instanceof Buffer||h instanceof Uint8Array),Be.fromUint8Array(h||new Uint8Array))}(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&function(l){let h=l.code===void 0?A.UNKNOWN:HD(l.code);return new P(h,l.message||"")}(s);t=new Vc(r,i,o,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=dn(n,r.document.name),o=je(r.document.updateTime),s=r.document.createTime?je(r.document.createTime):q.min(),a=new st({mapValue:{fields:r.document.fields}}),c=qe.newFoundDocument(i,o,s,a),l=r.targetIds||[],h=r.removedTargetIds||[];t=new ro(l,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=dn(n,r.document),o=r.readTime?je(r.readTime):q.min(),s=qe.newNoDocument(i,o),a=r.removedTargetIds||[];t=new ro([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=dn(n,r.document),o=r.removedTargetIds||[];t=new ro([],o,i,null)}else{if(!("filter"in e))return U();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,s=new Ep(i,o),a=r.targetId;t=new Lc(a,s)}}return t}function na(n,e){let t;if(e instanceof gr)t={update:SE(n,e.key,e.value)};else if(e instanceof mr)t={delete:ta(n,e.key)};else if(e instanceof Yt)t={update:SE(n,e.key,e.data),updateMask:LR(e.fieldMask)};else{if(!(e instanceof Ys))return U();t={verify:ta(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,s){let a=s.transform;if(a instanceof fr)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof On)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Fn)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof pr)return{fieldPath:s.field.canonicalString(),increment:a.Pe};throw U()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:xR(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:U()}(n,e.precondition)),t}function xp(n,e){let t=e.currentDocument?function(o){return o.updateTime!==void 0?Fe.updateTime(je(o.updateTime)):o.exists!==void 0?Fe.exists(o.exists):Fe.none()}(e.currentDocument):Fe.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(s,a){let c=null;if("setToServerValue"in a)H(a.setToServerValue==="REQUEST_TIME"),c=new fr;else if("appendMissingElements"in a){let h=a.appendMissingElements.values||[];c=new On(h)}else if("removeAllFromArray"in a){let h=a.removeAllFromArray.values||[];c=new Fn(h)}else"increment"in a?c=new pr(s,a.increment):U();let l=Ve.fromServerFormat(a.fieldPath);return new Xr(l,c)}(n,i)):[];if(e.update){e.update.name;let i=dn(n,e.update.name),o=new st({mapValue:{fields:e.update.fields}});if(e.updateMask){let s=function(c){let l=c.fieldPaths||[];return new St(l.map(h=>Ve.fromServerFormat(h)))}(e.updateMask);return new Yt(i,o,s,t,r)}return new gr(i,o,t,r)}if(e.delete){let i=dn(n,e.delete);return new mr(i,t)}if(e.verify){let i=dn(n,e.verify);return new Ys(i,t)}return U()}function RR(n,e){return n&&n.length>0?(H(e!==void 0),n.map(t=>function(i,o){let s=i.updateTime?je(i.updateTime):je(o);return s.isEqual(q.min())&&(s=je(o)),new wp(s,i.transformResults||[])}(t,e))):[]}function ZD(n,e){return{documents:[WD(n,e.path)]}}function JD(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=WD(n,i);let o=function(l){if(l.length!==0)return tT(ve.create(l,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let s=function(l){if(l.length!==0)return l.map(h=>function(m){return{field:Zi(m.field),direction:kR(m.dir)}}(h))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);let a=bp(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:i}}function XD(n){let e=KD(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){H(r===1);let h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let o=[];t.where&&(o=function(p){let m=eT(p);return m instanceof ve&&Jg(m)?m.getFilters():[m]}(t.where));let s=[];t.orderBy&&(s=function(p){return p.map(m=>function(M){return new Zr(Ji(M.field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(M.direction))}(m))}(t.orderBy));let a=null;t.limit&&(a=function(p){let m;return m=typeof p=="object"?p.value:p,da(m)?null:m}(t.limit));let c=null;t.startAt&&(c=function(p){let m=!!p.before,v=p.values||[];return new pn(v,m)}(t.startAt));let l=null;return t.endAt&&(l=function(p){let m=!p.before,v=p.values||[];return new pn(v,m)}(t.endAt)),SD(e,i,s,o,a,"F",c,l)}function PR(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return U()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function eT(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Ji(t.unaryFilter.field);return se.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Ji(t.unaryFilter.field);return se.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=Ji(t.unaryFilter.field);return se.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=Ji(t.unaryFilter.field);return se.create(s,"!=",{nullValue:"NULL_VALUE"});default:return U()}}(n):n.fieldFilter!==void 0?function(t){return se.create(Ji(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return U()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return ve.create(t.compositeFilter.filters.map(r=>eT(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return U()}}(t.compositeFilter.op))}(n):U()}function kR(n){return bR[n]}function OR(n){return SR[n]}function FR(n){return AR[n]}function Zi(n){return{fieldPath:n.canonicalString()}}function Ji(n){return Ve.fromServerFormat(n.fieldPath)}function tT(n){return n instanceof se?function(t){if(t.op==="=="){if(lE(t.value))return{unaryFilter:{field:Zi(t.field),op:"IS_NAN"}};if(cE(t.value))return{unaryFilter:{field:Zi(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(lE(t.value))return{unaryFilter:{field:Zi(t.field),op:"IS_NOT_NAN"}};if(cE(t.value))return{unaryFilter:{field:Zi(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zi(t.field),op:OR(t.op),value:t.value}}}(n):n instanceof ve?function(t){let r=t.getFilters().map(i=>tT(i));return r.length===1?r[0]:{compositeFilter:{op:FR(t.op),filters:r}}}(n):U()}function LR(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function nT(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var ho=class n{constructor(e,t,r,i,o=q.min(),s=q.min(),a=Be.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Bc=class{constructor(e){this.ct=e}};function VR(n,e){let t;if(e.document)t=YD(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=j.fromSegments(e.noDocument.path),i=ti(e.noDocument.readTime);t=qe.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return U();{let r=j.fromSegments(e.unknownDocument.path),i=ti(e.unknownDocument.version);t=qe.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let o=new Re(i[0],i[1]);return q.fromTimestamp(o)}(e.readTime)),t}function AE(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Uc(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(o,s){return{name:ta(o,s.key),fields:s.data.value.mapValue.fields,updateTime:lo(o,s.version.toTimestamp()),createTime:lo(o,s.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:ei(e.version)};else{if(!e.isUnknownDocument())return U();r.unknownDocument={path:t.path.toArray(),version:ei(e.version)}}return r}function Uc(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function ei(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ti(n){let e=new Re(n.seconds,n.nanoseconds);return q.fromTimestamp(e)}function qr(n,e){let t=(e.baseMutations||[]).map(o=>xp(n.ct,o));for(let o=0;o<e.mutations.length-1;++o){let s=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){let a=e.mutations[o+1];s.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}let r=e.mutations.map(o=>xp(n.ct,o)),i=Re.fromMillis(e.localWriteTimeMs);return new Zs(e.batchId,i,t,r)}function Vs(n){let e=ti(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?ti(n.lastLimboFreeSnapshotVersion):q.min(),r;return r=function(o){return o.documents!==void 0}(n.query)?function(o){return H(o.documents.length===1),ft(Do(KD(o.documents[0])))}(n.query):function(o){return ft(XD(o))}(n.query),new ho(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Be.fromBase64String(n.resumeToken))}function rT(n,e){let t=ei(e.snapshotVersion),r=ei(e.lastLimboFreeSnapshotVersion),i;i=kc(e.target)?ZD(n.ct,e.target):JD(n.ct,e.target)._t;let o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Jr(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function rm(n){let e=XD({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Fc(e,e.limit,"L"):e}function Hf(n,e){return new Js(e.largestBatchId,xp(n.ct,e.overlayMutation))}function xE(n,e){let t=e.path.lastSegment();return[n,ht(e.path.popLast()),t]}function ME(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:ei(r.readTime),documentKey:ht(r.documentKey.path),largestBatchId:r.largestBatchId}}var Mp=class{getBundleMetadata(e,t){return NE(e).get(t).next(r=>{if(r)return function(o){return{id:o.bundleId,createTime:ti(o.createTime),version:o.version}}(r)})}saveBundleMetadata(e,t){return NE(e).put(function(i){return{bundleId:i.id,createTime:ei(je(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return RE(e).get(t).next(r=>{if(r)return function(o){return{name:o.name,query:rm(o.bundledQuery),readTime:ti(o.readTime)}}(r)})}saveNamedQuery(e,t){return RE(e).put(function(i){return{name:i.name,readTime:ei(je(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function NE(n){return We(n,"bundles")}function RE(n){return We(n,"namedQueries")}var $c=class n{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return Ps(e).get(xE(this.userId,t)).next(r=>r?Hf(this.serializer,r):null)}getOverlays(e,t){let r=cn();return b.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((o,s)=>{let a=new Js(t,s);i.push(this.ht(e,a))}),b.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(s=>i.add(ht(s.getCollectionPath())));let o=[];return i.forEach(s=>{let a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,r+1],!1,!0);o.push(Ps(e).j("collectionPathOverlayIndex",a))}),b.waitFor(o)}getOverlaysForCollection(e,t,r){let i=cn(),o=ht(t),s=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Ps(e).U("collectionPathOverlayIndex",s).next(a=>{for(let c of a){let l=Hf(this.serializer,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let o=cn(),s,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Ps(e).J({index:"collectionGroupOverlayIndex",range:a},(c,l,h)=>{let p=Hf(this.serializer,l);o.size()<i||p.largestBatchId===s?(o.set(p.getKey(),p),s=p.largestBatchId):h.done()}).next(()=>o)}ht(e,t){return Ps(e).put(function(i,o,s){let[a,c,l]=xE(o,s.mutation.key);return{userId:o,collectionPath:c,documentId:l,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:na(i.ct,s.mutation)}}(this.serializer,this.userId,t))}};function Ps(n){return We(n,"documentOverlays")}var Np=class{Pt(e){return We(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{let r=t?.value;return r?Be.fromUint8Array(r):Be.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}};var Rn=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Me(e.integerValue));else if("doubleValue"in e){let r=Me(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),zs(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=kn(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(lr(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?_D(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Dl(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):U()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let o=e.fields||{};this.dt(t,53);let s="value",a=((i=(r=o[s].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(Me(a)),this.Vt(s,t),this.Tt(o[s],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),j.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};Rn.vt=new Rn;function jR(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function PE(n){let e=64-function(r){let i=0;for(let o=0;o<8;++o){let s=jR(255&r[o]);if(i+=s,s!==8)break}return i}(n);return Math.ceil(e/8)}var Rp=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{let i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{let i=t.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){let t=this.qt(e),r=PE(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Kt(e){let t=this.qt(e),r=PE(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){let t=function(o){let s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,o,!1),new Uint8Array(s.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ft(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){let t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},Pp=class{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}},kp=class{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}},zr=class{constructor(){this.jt=new Rp,this.Ht=new Pp(this.jt),this.Jt=new kp(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}};var Gr=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Zt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function nr(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=kE(n.arrayValue,e.arrayValue),t!==0?t:(t=kE(n.directionalValue,e.directionalValue),t!==0?t:j.comparator(n.documentKey,e.documentKey)))}function kE(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var Hc=class{constructor(e){this.Xt=new Ee((t,r)=>Ve.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(let t of e.filters){let r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(H(e.collectionGroup===this.collectionId),this.nn)return!1;let t=tp(e);if(t!==void 0&&!this.sn(t))return!1;let r=$r(e),i=new Set,o=0,s=0;for(;o<r.length&&this.sn(r[o]);++o)i=i.add(r[o].fieldPath.canonicalString());if(o===r.length)return!0;if(this.Xt.size>0){let a=this.Xt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[o];if(!this.on(a,c)||!this._n(this.en[s++],c))return!1}++o}for(;o<r.length;++o){let a=r[o];if(s>=this.en.length||!this._n(this.en[s++],a))return!1}return!0}an(){if(this.nn)return null;let e=new Ee(Ve.comparator),t=[];for(let r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new to(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new to(r.field,0))}for(let r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new to(r.field,r.dir==="asc"?0:1)));return new oo(oo.UNKNOWN_ID,this.collectionId,t,qs.empty())}sn(e){for(let t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function iT(n){var e,t;if(H(n instanceof se||n instanceof ve),n instanceof se){if(n instanceof Pc){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(o=>se.create(n.field,"==",o)))||[];return ve.create(i,"or")}return n}let r=n.filters.map(i=>iT(i));return ve.create(r,n.op)}function BR(n){if(n.getFilters().length===0)return[];let e=Lp(iT(n));return H(oT(e)),Op(e)||Fp(e)?[e]:e.getFilters()}function Op(n){return n instanceof se}function Fp(n){return n instanceof ve&&Jg(n)}function oT(n){return Op(n)||Fp(n)||function(t){if(t instanceof ve&&cp(t)){for(let r of t.getFilters())if(!Op(r)&&!Fp(r))return!1;return!0}return!1}(n)}function Lp(n){if(H(n instanceof se||n instanceof ve),n instanceof se)return n;if(n.filters.length===1)return Lp(n.filters[0]);let e=n.filters.map(r=>Lp(r)),t=ve.create(e,n.op);return t=qc(t),oT(t)?t:(H(t instanceof ve),H(ao(t)),H(t.filters.length>1),t.filters.reduce((r,i)=>im(r,i)))}function im(n,e){let t;return H(n instanceof se||n instanceof ve),H(e instanceof se||e instanceof ve),t=n instanceof se?e instanceof se?function(i,o){return ve.create([i,o],"and")}(n,e):OE(n,e):e instanceof se?OE(e,n):function(i,o){if(H(i.filters.length>0&&o.filters.length>0),ao(i)&&ao(o))return TD(i,o.getFilters());let s=cp(i)?i:o,a=cp(i)?o:i,c=s.filters.map(l=>im(l,a));return ve.create(c,"or")}(n,e),qc(t)}function OE(n,e){if(ao(e))return TD(e,n.getFilters());{let t=e.filters.map(r=>im(n,r));return ve.create(t,"or")}}function qc(n){if(H(n instanceof se||n instanceof ve),n instanceof se)return n;let e=n.getFilters();if(e.length===1)return qc(e[0]);if(ED(n))return n;let t=e.map(i=>qc(i)),r=[];return t.forEach(i=>{i instanceof se?r.push(i):i instanceof ve&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:ve.create(r,n.op)}var Vp=class{constructor(){this.un=new ra}addToCollectionParentIndex(e,t){return this.un.add(t),b.resolve()}getCollectionParents(e,t){return b.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return b.resolve()}deleteFieldIndex(e,t){return b.resolve()}deleteAllFieldIndexes(e){return b.resolve()}createTargetIndexes(e,t){return b.resolve()}getDocumentsMatchingTarget(e,t){return b.resolve(null)}getIndexType(e,t){return b.resolve(0)}getFieldIndexes(e,t){return b.resolve([])}getNextCollectionGroupToUpdate(e){return b.resolve(null)}getMinOffset(e,t){return b.resolve(Ot.min())}getMinOffsetFromCollectionGroup(e,t){return b.resolve(Ot.min())}updateCollectionGroup(e,t,r){return b.resolve()}updateIndexEntries(e,t){return b.resolve()}},ra=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ee(ce.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ee(ce.comparator)).toArray()}};var mc=new Uint8Array(0),jp=class{constructor(e,t){this.databaseId=t,this.cn=new ra,this.ln=new gn(r=>Jr(r),(r,i)=>ha(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});let o={collectionId:r,parent:ht(i)};return FE(e).put(o)}return b.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[aD(t),""],!1,!0);return FE(e).U(i).next(o=>{for(let s of o){if(s.collectionId!==t)break;r.push(un(s.parent))}return r})}addFieldIndex(e,t){let r=ks(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete i.indexId;let o=r.add(i);if(t.indexState){let s=Wi(e);return o.next(a=>{s.put(ME(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return o.next()}deleteFieldIndex(e,t){let r=ks(e),i=Wi(e),o=Gi(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=ks(e),r=Gi(e),i=Wi(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return b.forEach(this.hn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let o=new Hc(r).an();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,t){let r=Gi(e),i=!0,o=new Map;return b.forEach(this.hn(t),s=>this.Pn(e,s).next(a=>{i&&(i=!!a),o.set(s,a)})).next(()=>{if(i){let s=X(),a=[];return b.forEach(o,(c,l)=>{k("IndexedDbIndexManager",`Using index ${function(L){return`id=${L.indexId}|cg=${L.collectionGroup}|f=${L.fields.map(z=>`${z.fieldPath}:${z.kind}`).join(",")}`}(c)} to execute ${Jr(t)}`);let h=function(L,z){let W=tp(z);if(W===void 0)return null;for(let G of Oc(L,W.fieldPath))switch(G.op){case"array-contains-any":return G.value.arrayValue.values||[];case"array-contains":return[G.value]}return null}(l,c),p=function(L,z){let W=new Map;for(let G of $r(z))for(let I of Oc(L,G.fieldPath))switch(I.op){case"==":case"in":W.set(G.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return W.set(G.fieldPath.canonicalString(),I.value),Array.from(W.values())}return null}(l,c),m=function(L,z){let W=[],G=!0;for(let I of $r(z)){let y=I.kind===0?gE(L,I.fieldPath,L.startAt):mE(L,I.fieldPath,L.startAt);W.push(y.value),G&&(G=y.inclusive)}return new pn(W,G)}(l,c),v=function(L,z){let W=[],G=!0;for(let I of $r(z)){let y=I.kind===0?mE(L,I.fieldPath,L.endAt):gE(L,I.fieldPath,L.endAt);W.push(y.value),G&&(G=y.inclusive)}return new pn(W,G)}(l,c),M=this.In(c,l,m),N=this.In(c,l,v),R=this.Tn(c,l,p),B=this.En(c.indexId,h,M,m.inclusive,N,v.inclusive,R);return b.forEach(B,$=>r.G($,t.limit).next(L=>{L.forEach(z=>{let W=j.fromSegments(z.documentKey);s.has(W)||(s=s.add(W),a.push(W))})}))}).next(()=>a)}return b.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=BR(ve.create(e.filters,"and")).map(r=>vp(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,i,o,s,a){let c=(t!=null?t.length:1)*Math.max(r.length,o.length),l=c/(t!=null?t.length:1),h=[];for(let p=0;p<c;++p){let m=t?this.dn(t[p/l]):mc,v=this.An(e,m,r[p%l],i),M=this.Rn(e,m,o[p%l],s),N=a.map(R=>this.An(e,m,R,!0));h.push(...this.createRange(v,M,N))}return h}An(e,t,r,i){let o=new Gr(e,j.empty(),t,r);return i?o:o.Zt()}Rn(e,t,r,i){let o=new Gr(e,j.empty(),t,r);return i?o.Zt():o}Pn(e,t){let r=new Hc(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(o=>{let s=null;for(let a of o)r.rn(a)&&(!s||a.fields.length>s.fields.length)&&(s=a);return s})}getIndexType(e,t){let r=2,i=this.hn(t);return b.forEach(i,o=>this.Pn(e,o).next(s=>{s?r!==0&&s.fields.length<function(c){let l=new Ee(Ve.comparator),h=!1;for(let p of c.filters)for(let m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:l=l.add(m.field));for(let p of c.orderBy)p.field.isKeyField()||(l=l.add(p.field));return l.size+(h?1:0)}(o)&&(r=1):r=0})).next(()=>function(s){return s.limit!==null}(t)&&i.length>1&&r===2?1:r)}Vn(e,t){let r=new zr;for(let i of $r(e)){let o=t.data.field(i.fieldPath);if(o==null)return null;let s=r.Yt(i.kind);Rn.vt.It(o,s)}return r.zt()}dn(e){let t=new zr;return Rn.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){let r=new zr;return Rn.vt.It(Yr(this.databaseId,t),r.Yt(function(o){let s=$r(o);return s.length===0?0:s[s.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let i=[];i.push(new zr);let o=0;for(let s of $r(e)){let a=r[o++];for(let c of i)if(this.fn(t,s.fieldPath)&&Qs(a))i=this.gn(i,s,a);else{let l=c.Yt(s.kind);Rn.vt.It(a,l)}}return this.pn(i)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){let i=[...e],o=[];for(let s of r.arrayValue.values||[])for(let a of i){let c=new zr;c.seed(a.zt()),Rn.vt.It(s,c.Yt(t.kind)),o.push(c)}return o}fn(e,t){return!!e.filters.find(r=>r instanceof se&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=ks(e),i=Wi(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(o=>{let s=[];return b.forEach(o,a=>i.get([a.indexId,this.uid]).next(c=>{s.push(function(h,p){let m=p?new qs(p.sequenceNumber,new Ot(ti(p.readTime),new j(un(p.documentKey)),p.largestBatchId)):qs.empty(),v=h.fields.map(([M,N])=>new to(Ve.fromServerFormat(M),N));return new oo(h.indexId,h.collectionGroup,v,m)}(a,c))})).next(()=>s)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let o=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:Z(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=ks(e),o=Wi(e);return this.yn(e).next(s=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>b.forEach(a,c=>o.put(ME(c.indexId,this.uid,s,r)))))}updateIndexEntries(e,t){let r=new Map;return b.forEach(t,(i,o)=>{let s=r.get(i.collectionGroup);return(s?b.resolve(s):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),b.forEach(a,c=>this.wn(e,i,c).next(l=>{let h=this.Sn(o,c);return l.isEqual(h)?b.resolve():this.bn(e,o,c,l,h)}))))})}Dn(e,t,r,i){return Gi(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,i){return Gi(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){let i=Gi(e),o=new Ee(nr);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(s,a)=>{o=o.add(new Gr(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>o)}Sn(e,t){let r=new Ee(nr),i=this.Vn(t,e);if(i==null)return r;let o=tp(t);if(o!=null){let s=e.data.field(o.fieldPath);if(Qs(s))for(let a of s.arrayValue.values||[])r=r.add(new Gr(t.indexId,e.key,this.dn(a),i))}else r=r.add(new Gr(t.indexId,e.key,mc,i));return r}bn(e,t,r,i,o){k("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let s=[];return function(c,l,h,p,m){let v=c.getIterator(),M=l.getIterator(),N=zi(v),R=zi(M);for(;N||R;){let B=!1,$=!1;if(N&&R){let L=h(N,R);L<0?$=!0:L>0&&(B=!0)}else N!=null?$=!0:B=!0;B?(p(R),R=zi(M)):$?(m(N),N=zi(v)):(N=zi(v),R=zi(M))}}(i,o,nr,a=>{s.push(this.Dn(e,t,r,a))},a=>{s.push(this.vn(e,t,r,a))}),b.waitFor(s)}yn(e){let t=1;return Wi(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,o)=>{o.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((s,a)=>nr(s,a)).filter((s,a,c)=>!a||nr(s,c[a-1])!==0);let i=[];i.push(e);for(let s of r){let a=nr(s,e),c=nr(s,t);if(a===0)i[0]=e.Zt();else if(a>0&&c<0)i.push(s),i.push(s.Zt());else if(c>0)break}i.push(t);let o=[];for(let s=0;s<i.length;s+=2){if(this.Cn(i[s],i[s+1]))return[];let a=[i[s].indexId,this.uid,i[s].arrayValue,i[s].directionalValue,mc,[]],c=[i[s+1].indexId,this.uid,i[s+1].arrayValue,i[s+1].directionalValue,mc,[]];o.push(IDBKeyRange.bound(a,c))}return o}Cn(e,t){return nr(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(LE)}getMinOffset(e,t){return b.mapArray(this.hn(t),r=>this.Pn(e,r).next(i=>i||U())).next(LE)}};function FE(n){return We(n,"collectionParents")}function Gi(n){return We(n,"indexEntries")}function ks(n){return We(n,"indexConfiguration")}function Wi(n){return We(n,"indexState")}function LE(n){H(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;Kg(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Ot(e.readTime,e.documentKey,t)}var VE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},kt=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function sT(n,e,t){let r=n.store("mutations"),i=n.store("documentMutations"),o=[],s=IDBKeyRange.only(t.batchId),a=0,c=r.J({range:s},(h,p,m)=>(a++,m.delete()));o.push(c.next(()=>{H(a===1)}));let l=[];for(let h of t.mutations){let p=fD(e,h.key.path,t.batchId);o.push(i.delete(p)),l.push(h.key)}return b.waitFor(o).next(()=>l)}function zc(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw U();e=n.noDocument}return JSON.stringify(e).length}kt.DEFAULT_COLLECTION_PERCENTILE=10,kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,kt.DEFAULT=new kt(41943040,kt.DEFAULT_COLLECTION_PERCENTILE,kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),kt.DISABLED=new kt(-1,0,0);var Gc=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,t,r,i){H(e.uid!=="");let o=e.isAuthenticated()?e.uid:"";return new n(o,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return rr(e).J({index:"userMutationsIndex",range:r},(i,o,s)=>{t=!1,s.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let o=Xi(e),s=rr(e);return s.add({}).next(a=>{H(typeof a=="number");let c=new Zs(a,t,r,i),l=function(v,M,N){let R=N.baseMutations.map($=>na(v.ct,$)),B=N.mutations.map($=>na(v.ct,$));return{userId:M,batchId:N.batchId,localWriteTimeMs:N.localWriteTime.toMillis(),baseMutations:R,mutations:B}}(this.serializer,this.userId,c),h=[],p=new Ee((m,v)=>Z(m.canonicalString(),v.canonicalString()));for(let m of i){let v=fD(this.userId,m.key.path,a);p=p.add(m.key.path.popLast()),h.push(s.put(l)),h.push(o.put(v,GN))}return p.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Fn[a]=c.keys()}),b.waitFor(h).next(()=>c)})}lookupMutationBatch(e,t){return rr(e).get(t).next(r=>r?(H(r.userId===this.userId),qr(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?b.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Fn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return rr(e).J({index:"userMutationsIndex",range:i},(s,a,c)=>{a.userId===this.userId&&(H(a.batchId>=r),o=qr(this.serializer,a)),c.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return rr(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,o,s)=>{r=o.batchId,s.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return rr(e).U("userMutationsIndex",t).next(r=>r.map(i=>qr(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=wc(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=[];return Xi(e).J({range:i},(s,a,c)=>{let[l,h,p]=s,m=un(h);if(l===this.userId&&t.path.isEqual(m))return rr(e).get(p).next(v=>{if(!v)throw U();H(v.userId===this.userId),o.push(qr(this.serializer,v))});c.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ee(Z),i=[];return t.forEach(o=>{let s=wc(this.userId,o.path),a=IDBKeyRange.lowerBound(s),c=Xi(e).J({range:a},(l,h,p)=>{let[m,v,M]=l,N=un(v);m===this.userId&&o.path.isEqual(N)?r=r.add(M):p.done()});i.push(c)}),b.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=wc(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new Ee(Z);return Xi(e).J({range:s},(c,l,h)=>{let[p,m,v]=c,M=un(m);p===this.userId&&r.isPrefixOf(M)?M.length===i&&(a=a.add(v)):h.done()}).next(()=>this.xn(e,a))}xn(e,t){let r=[],i=[];return t.forEach(o=>{i.push(rr(e).get(o).next(s=>{if(s===null)throw U();H(s.userId===this.userId),r.push(qr(this.serializer,s))}))}),b.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return sT(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),b.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return b.resolve();let r=IDBKeyRange.lowerBound(function(s){return[s]}(this.userId)),i=[];return Xi(e).J({range:r},(o,s,a)=>{if(o[0]===this.userId){let c=un(o[1]);i.push(c)}else a.done()}).next(()=>{H(i.length===0)})})}containsKey(e,t){return aT(e,this.userId,t)}Nn(e){return uT(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function aT(n,e,t){let r=wc(e,t.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Xi(n).J({range:o,H:!0},(a,c,l)=>{let[h,p,m]=a;h===e&&p===i&&(s=!0),l.done()}).next(()=>s)}function rr(n){return We(n,"mutations")}function Xi(n){return We(n,"documentMutations")}function uT(n){return We(n,"mutationQueues")}var fo=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var Bp=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{let r=new fo(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>q.fromTimestamp(new Re(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Qn(e,i)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Ki(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(H(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let i=0,o=[];return Ki(e).J((s,a)=>{let c=Vs(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(i++,o.push(this.removeTargetData(e,c)))}).next(()=>b.waitFor(o)).next(()=>i)}forEachTarget(e,t){return Ki(e).J((r,i)=>{let o=Vs(i);t(o)})}qn(e){return jE(e).get("targetGlobalKey").next(t=>(H(t!==null),t))}Qn(e,t){return jE(e).put("targetGlobalKey",t)}Kn(e,t){return Ki(e).put(rT(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){let r=Jr(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return Ki(e).J({range:i,index:"queryTargetsIndex"},(s,a,c)=>{let l=Vs(a);ha(t,l.target)&&(o=l,c.done())}).next(()=>o)}addMatchingKeys(e,t,r){let i=[],o=ir(e);return t.forEach(s=>{let a=ht(s.path);i.push(o.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,s))}),b.waitFor(i)}removeMatchingKeys(e,t,r){let i=ir(e);return b.forEach(t,o=>{let s=ht(o.path);return b.waitFor([i.delete([r,s]),this.referenceDelegate.removeReference(e,r,o)])})}removeMatchingKeysForTargetId(e,t){let r=ir(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=ir(e),o=X();return i.J({range:r,H:!0},(s,a,c)=>{let l=un(s[1]),h=new j(l);o=o.add(h)}).next(()=>o)}containsKey(e,t){let r=ht(t.path),i=IDBKeyRange.bound([r],[aD(r)],!1,!0),o=0;return ir(e).J({index:"documentTargetsIndex",H:!0,range:i},([s,a],c,l)=>{s!==0&&(o++,l.done())}).next(()=>o>0)}ot(e,t){return Ki(e).get(t).next(r=>r?Vs(r):null)}};function Ki(n){return We(n,"targets")}function jE(n){return We(n,"targetGlobal")}function ir(n){return We(n,"targetDocuments")}function BE([n,e],[t,r]){let i=Z(n,t);return i===0?Z(e,r):i}var Up=class{constructor(e){this.Un=e,this.buffer=new Ee(BE),this.Wn=0}Gn(){return++this.Wn}zn(e){let t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();BE(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},$p=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){k("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>x(this,null,function*(){this.jn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){_r(t)?k("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield vr(t)}yield this.Hn(3e5)}))}},Hp=class{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return b.resolve(bt.oe);let r=new Up(t);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(k("LruGarbageCollector","Garbage collection skipped; disabled"),b.resolve(VE)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(k("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),VE):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,i,o,s,a,c,l,h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(k("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,s=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,t))).next(p=>(o=p,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(l=Date.now(),Qi()<=Xt.DEBUG&&k("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-h}ms
	Determined least recently used ${i} in `+(a-s)+`ms
	Removed ${o} targets in `+(c-a)+`ms
	Removed ${p} documents in `+(l-c)+`ms
Total Duration: ${l-h}ms`),b.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:p})))}};function UR(n,e){return new Hp(n,e)}var qp=class{constructor(e,t){this.db=e,this.garbageCollector=UR(this,t)}Yn(e){let t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,i)=>t(i))}addReference(e,t,r){return yc(e,r)}removeReference(e,t,r){return yc(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return yc(e,t)}nr(e,t){return function(i,o){let s=!1;return uT(i).Y(a=>aT(i,a,o).next(c=>(c&&(s=!0),b.resolve(!c)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.tr(e,(s,a)=>{if(a<=t){let c=this.nr(e,s).next(l=>{if(!l)return o++,r.getEntry(e,s).next(()=>(r.removeEntry(s,q.min()),ir(e).delete(function(p){return[0,ht(p.path)]}(s))))});i.push(c)}}).next(()=>b.waitFor(i)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return yc(e,t)}tr(e,t){let r=ir(e),i,o=bt.oe;return r.J({index:"documentTargetsIndex"},([s,a],{path:c,sequenceNumber:l})=>{s===0?(o!==bt.oe&&t(new j(un(i)),o),o=l,i=c):o=bt.oe}).next(()=>{o!==bt.oe&&t(new j(un(i)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function yc(n,e){return ir(n).put(function(r,i){return{targetId:0,path:ht(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var Wc=class{constructor(){this.changes=new gn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,qe.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?b.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var zp=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Ur(e).put(r)}removeEntry(e,t,r){return Ur(e).delete(function(o,s){let a=o.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Uc(s),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=qe.newInvalidDocument(t);return Ur(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Os(t))},(i,o)=>{r=this.ir(t,o)}).next(()=>r)}sr(e,t){let r={size:0,document:qe.newInvalidDocument(t)};return Ur(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Os(t))},(i,o)=>{r={document:this.ir(t,o),size:zc(o)}}).next(()=>r)}getEntries(e,t){let r=vt();return this._r(e,t,(i,o)=>{let s=this.ir(i,o);r=r.insert(i,s)}).next(()=>r)}ar(e,t){let r=vt(),i=new xe(j.comparator);return this._r(e,t,(o,s)=>{let a=this.ir(o,s);r=r.insert(o,a),i=i.insert(o,zc(s))}).next(()=>({documents:r,ur:i}))}_r(e,t,r){if(t.isEmpty())return b.resolve();let i=new Ee(HE);t.forEach(c=>i=i.add(c));let o=IDBKeyRange.bound(Os(i.first()),Os(i.last())),s=i.getIterator(),a=s.getNext();return Ur(e).J({index:"documentKeyIndex",range:o},(c,l,h)=>{let p=j.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&HE(a,p)<0;)r(a,null),a=s.getNext();a&&a.isEqual(p)&&(r(a,l),a=s.hasNext()?s.getNext():null),a?h.$(Os(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,o){let s=t.path,a=[s.popLast().toArray(),s.lastSegment(),Uc(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ur(e).U(IDBKeyRange.bound(a,c,!0)).next(l=>{o?.incrementDocumentReadCount(l.length);let h=vt();for(let p of l){let m=this.ir(j.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(pa(t,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,t,r,i){let o=vt(),s=$E(t,r),a=$E(t,Ot.max());return Ur(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,a,!0)},(c,l,h)=>{let p=this.ir(j.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);o=o.insert(p.key,p),o.size===i&&h.done()}).next(()=>o)}newChangeBuffer(e){return new Gp(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return UE(e).get("remoteDocumentGlobalKey").next(t=>(H(!!t),t))}rr(e,t){return UE(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){let r=VR(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(q.min())))return r}return qe.newInvalidDocument(e)}};function cT(n){return new zp(n)}var Gp=class extends Wc{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new gn(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new Ee((o,s)=>Z(o.canonicalString(),s.canonicalString()));return this.changes.forEach((o,s)=>{let a=this.lr.get(o);if(t.push(this.cr.removeEntry(e,o,a.readTime)),s.isValidDocument()){let c=AE(this.cr.serializer,s);i=i.add(o.path.popLast());let l=zc(c);r+=l-a.size,t.push(this.cr.addEntry(e,o,c))}else if(r-=a.size,this.trackRemovals){let c=AE(this.cr.serializer,s.convertToNoDocument(q.min()));t.push(this.cr.addEntry(e,o,c))}}),i.forEach(o=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,o))}),t.push(this.cr.updateMetadata(e,r)),b.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:i})=>(i.forEach((o,s)=>{this.lr.set(o,{size:s,readTime:r.get(o).readTime})}),r))}};function UE(n){return We(n,"remoteDocumentGlobal")}function Ur(n){return We(n,"remoteDocumentsV14")}function Os(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function $E(n,e){let t=e.documentKey.path.toArray();return[n,Uc(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function HE(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let o=0;o<t.length-2&&o<r.length-2;++o)if(i=Z(t[o],r[o]),i)return i;return i=Z(t.length,r.length),i||(i=Z(t[t.length-2],r[r.length-2]),i||Z(t[t.length-1],r[r.length-1]))}var Wp=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Kc=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Us(r.mutation,i,St.empty(),Re.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,X()).next(()=>r))}getLocalViewOfDocuments(e,t,r=X()){let i=cn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let s=Ls();return o.forEach((a,c)=>{s=s.insert(a,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let r=cn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,X()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,r,i){let o=vt(),s=Bs(),a=function(){return Bs()}();return t.forEach((c,l)=>{let h=r.get(l.key);i.has(l.key)&&(h===void 0||h.mutation instanceof Yt)?o=o.insert(l.key,l):h!==void 0?(s.set(l.key,h.mutation.getFieldMask()),Us(h.mutation,l,h.mutation.getFieldMask(),Re.now())):s.set(l.key,St.empty())}),this.recalculateAndSaveOverlays(e,o).next(c=>(c.forEach((l,h)=>s.set(l,h)),t.forEach((l,h)=>{var p;return a.set(l,new Wp(h,(p=s.get(l))!==null&&p!==void 0?p:null))}),a))}recalculateAndSaveOverlays(e,t){let r=Bs(),i=new xe((s,a)=>s-a),o=X();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let a of s)a.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let h=r.get(c)||St.empty();h=a.applyToLocalView(l,h),r.set(c,h);let p=(i.get(a.batchId)||X()).add(c);i=i.insert(a.batchId,p)})}).next(()=>{let s=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,h=c.value,p=PD();h.forEach(m=>{if(!o.has(m)){let v=BD(t.get(m),r.get(m));v!==null&&p.set(m,v),o=o.add(m)}}),s.push(this.documentOverlayCache.saveOverlays(e,l,p))}return b.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(s){return j.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Xg(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):b.resolve(cn()),a=-1,c=o;return s.next(l=>b.forEach(l,(h,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),o.get(h)?b.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{c=c.insert(h,m)}))).next(()=>this.populateOverlays(e,l,o)).next(()=>this.computeViews(e,c,l,X())).next(h=>({batchId:a,changes:RD(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new j(t)).next(r=>{let i=Ls();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,s=Ls();return this.indexManager.getCollectionParents(e,o).next(a=>b.forEach(a,c=>{let l=function(p,m){return new Qt(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(t,c.child(o));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(h=>{h.forEach((p,m)=>{s=s.insert(p,m)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(s=>{o.forEach((c,l)=>{let h=l.getKey();s.get(h)===null&&(s=s.insert(h,qe.newInvalidDocument(h)))});let a=Ls();return s.forEach((c,l)=>{let h=o.get(c);h!==void 0&&Us(h.mutation,l,St.empty(),Re.now()),pa(t,l)&&(a=a.insert(c,l))}),a})}};var Kp=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return b.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:je(i.createTime)}}(t)),b.resolve()}getNamedQuery(e,t){return b.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:rm(i.bundledQuery),readTime:je(i.readTime)}}(t)),b.resolve()}};var Qp=class{constructor(){this.overlays=new xe(j.comparator),this.Ir=new Map}getOverlay(e,t){return b.resolve(this.overlays.get(t))}getOverlays(e,t){let r=cn();return b.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.ht(e,t,o)}),b.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(r)),b.resolve()}getOverlaysForCollection(e,t,r){let i=cn(),o=t.length+1,s=new j(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===o&&c.largestBatchId>r&&i.set(c.getKey(),c)}return b.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new xe((l,h)=>l-h),s=this.overlays.getIterator();for(;s.hasNext();){let l=s.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let h=o.get(l.largestBatchId);h===null&&(h=cn(),o=o.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}let a=cn(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,h)=>a.set(l,h)),!(a.size()>=i)););return b.resolve(a)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let s=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new Js(t,r));let o=this.Ir.get(t);o===void 0&&(o=X(),this.Ir.set(t,o)),this.Ir.set(t,o.add(r.key))}};var Yp=class{constructor(){this.sessionToken=Be.EMPTY_BYTE_STRING}getSessionToken(e){return b.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,b.resolve()}};var ia=class{constructor(){this.Tr=new Ee($e.Er),this.dr=new Ee($e.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new $e(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new $e(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new j(new ce([])),r=new $e(t,e),i=new $e(t,e+1),o=[];return this.dr.forEachInRange([r,i],s=>{this.Vr(s),o.push(s.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new j(new ce([])),r=new $e(t,e),i=new $e(t,e+1),o=X();return this.dr.forEachInRange([r,i],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new $e(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},$e=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return j.comparator(e.key,t.key)||Z(e.wr,t.wr)}static Ar(e,t){return Z(e.wr,t.wr)||j.comparator(e.key,t.key)}};var Zp=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Ee($e.Er)}checkEmpty(e){return b.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new Zs(o,t,r,i);this.mutationQueue.push(s);for(let a of i)this.br=this.br.add(new $e(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return b.resolve(s)}lookupMutationBatch(e,t){return b.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),o=i<0?0:i;return b.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return b.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return b.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new $e(t,0),i=new $e(t,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,i],s=>{let a=this.Dr(s.wr);o.push(a)}),b.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ee(Z);return t.forEach(i=>{let o=new $e(i,0),s=new $e(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,s],a=>{r=r.add(a.wr)})}),b.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;j.isDocumentKey(o)||(o=o.child(""));let s=new $e(new j(o),0),a=new Ee(Z);return this.br.forEachWhile(c=>{let l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.wr)),!0)},s),b.resolve(this.Cr(a))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){H(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return b.forEach(t.mutations,i=>{let o=new $e(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new $e(t,0),i=this.br.firstAfterOrEqual(r);return b.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,b.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Jp=class{constructor(e){this.Mr=e,this.docs=function(){return new xe(j.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,s=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return b.resolve(r?r.document.mutableCopy():qe.newInvalidDocument(t))}getEntries(e,t){let r=vt();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():qe.newInvalidDocument(i))}),b.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=vt(),s=t.path,a=new j(s.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:h}}=c.getNext();if(!s.isPrefixOf(l.path))break;l.path.length>s.length+1||Kg(cD(h),r)<=0||(i.has(h.key)||pa(t,h))&&(o=o.insert(h.key,h.mutableCopy()))}return b.resolve(o)}getAllFromCollectionGroup(e,t,r,i){U()}Or(e,t){return b.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Xp(this)}getSize(e){return b.resolve(this.size)}},Xp=class extends Wc{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),b.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var eg=class{constructor(e){this.persistence=e,this.Nr=new gn(t=>Jr(t),ha),this.lastRemoteSnapshotVersion=q.min(),this.highestTargetId=0,this.Lr=0,this.Br=new ia,this.targetCount=0,this.kr=fo.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),b.resolve()}getLastRemoteSnapshotVersion(e){return b.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return b.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),b.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),b.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new fo(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,b.resolve()}updateTargetData(e,t){return this.Kn(t),b.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,b.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.Nr.forEach((s,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),b.waitFor(o).next(()=>i)}getTargetCount(e){return b.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return b.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),b.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),b.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),b.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return b.resolve(r)}containsKey(e,t){return b.resolve(this.Br.containsKey(t))}};var Qc=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new bt(0),this.Kr=!1,this.Kr=!0,this.$r=new Yp,this.referenceDelegate=e(this),this.Ur=new eg(this),this.indexManager=new Vp,this.remoteDocumentCache=function(i){return new Jp(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new Bc(t),this.Gr=new Kp(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Qp,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new Zp(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){k("MemoryPersistence","Starting transaction:",e);let i=new tg(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(o=>this.referenceDelegate.jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Hr(e,t){return b.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},tg=class extends Ac{constructor(e){super(),this.currentSequenceNumber=e}},Yc=class n{constructor(e){this.persistence=e,this.Jr=new ia,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw U()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),b.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),b.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),b.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.Xr.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return b.forEach(this.Xr,r=>{let i=j.fromPath(r);return this.ei(e,i).next(o=>{o||t.removeEntry(i,q.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return b.or([()=>b.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var ng=class{constructor(e){this.serializer=e}O(e,t,r,i){let o=new xc("createOrUpgrade",t);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",oE,{unique:!0}),c.createObjectStore("documentMutations")}(e),qE(e),function(c){c.createObjectStore("remoteDocuments")}(e));let s=b.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),qE(e)),s=s.next(()=>function(c){let l=c.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:q.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",h)}(o))),r<4&&i>=4&&(r!==0&&(s=s.next(()=>function(c,l){return l.store("mutations").U().next(h=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",oE,{unique:!0});let p=l.store("mutations"),m=h.map(v=>p.put(v));return b.waitFor(m)})}(e,o))),s=s.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(s=s.next(()=>this.ni(o))),r<6&&i>=6&&(s=s.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(o)))),r<7&&i>=7&&(s=s.next(()=>this.ii(o))),r<8&&i>=8&&(s=s.next(()=>this.si(e,o))),r<9&&i>=9&&(s=s.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(s=s.next(()=>this.oi(o))),r<11&&i>=11&&(s=s.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(s=s.next(()=>{(function(c){let l=c.createObjectStore("documentOverlays",{keyPath:iR});l.createIndex("collectionPathOverlayIndex",oR,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",sR,{unique:!1})})(e)})),r<13&&i>=13&&(s=s.next(()=>function(c){let l=c.createObjectStore("remoteDocumentsV14",{keyPath:WN});l.createIndex("documentKeyIndex",KN),l.createIndex("collectionGroupIndex",QN)}(e)).next(()=>this._i(e,o)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(s=s.next(()=>this.ai(e,o))),r<15&&i>=15&&(s=s.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:eR}).createIndex("sequenceNumberIndex",tR,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:nR}).createIndex("documentKeyIndex",rR,{unique:!1})}(e))),r<16&&i>=16&&(s=s.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&i>=17&&(s=s.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),s}ri(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=zc(i)}).next(()=>{let r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){let t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>b.forEach(i,o=>{let s=IDBKeyRange.bound([o.userId,-1],[o.userId,o.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",s).next(a=>b.forEach(a,c=>{H(c.userId===o.userId);let l=qr(this.serializer,c);return sT(e,o.userId,l).next(()=>{})}))}))}ii(e){let t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let o=[];return r.J((s,a)=>{let c=new ce(s),l=function(p){return[0,ht(p)]}(c);o.push(t.get(l).next(h=>h?b.resolve():(p=>t.put({targetId:0,path:ht(p),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>b.waitFor(o))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:XN});let r=t.store("collectionParents"),i=new ra,o=s=>{if(i.add(s)){let a=s.lastSegment(),c=s.popLast();return r.put({collectionId:a,parent:ht(c)})}};return t.store("remoteDocuments").J({H:!0},(s,a)=>{let c=new ce(s);return o(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([s,a,c],l)=>{let h=un(a);return o(h.popLast())}))}oi(e){let t=e.store("targets");return t.J((r,i)=>{let o=Vs(i),s=rT(this.serializer,o);return t.put(s)})}_i(e,t){let r=t.store("remoteDocuments"),i=[];return r.J((o,s)=>{let a=t.store("remoteDocumentsV14"),c=function(p){return p.document?new j(ce.fromString(p.document.name).popFirst(5)):p.noDocument?j.fromSegments(p.noDocument.path):p.unknownDocument?j.fromSegments(p.unknownDocument.path):U()}(s).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:s.readTime||[0,0],unknownDocument:s.unknownDocument,noDocument:s.noDocument,document:s.document,hasCommittedMutations:!!s.hasCommittedMutations};i.push(a.put(l))}).next(()=>b.waitFor(i))}ai(e,t){let r=t.store("mutations"),i=cT(this.serializer),o=new Qc(Yc.Zr,this.serializer.ct);return r.U().next(s=>{let a=new Map;return s.forEach(c=>{var l;let h=(l=a.get(c.userId))!==null&&l!==void 0?l:X();qr(this.serializer,c).keys().forEach(p=>h=h.add(p)),a.set(c.userId,h)}),b.forEach(a,(c,l)=>{let h=new He(l),p=$c.lt(this.serializer,h),m=o.getIndexManager(h),v=Gc.lt(h,this.serializer,m,o.referenceDelegate);return new Kc(i,v,p,m).recalculateAndSaveOverlaysForDocumentKeys(new Gs(t,bt.oe),c).next()})})}};function qE(n){n.createObjectStore("targetDocuments",{keyPath:ZN}).createIndex("documentTargetsIndex",JN,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",YN,{unique:!0}),n.createObjectStore("targetGlobal")}var qf="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",rg=class n{constructor(e,t,r,i,o,s,a,c,l,h,p=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=o,this.window=s,this.document=a,this.ci=l,this.li=h,this.hi=p,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=m=>Promise.resolve(),!n.D())throw new P(A.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new qp(this,i),this.Ai=t+"main",this.serializer=new Bc(c),this.Ri=new cr(this.Ai,this.hi,new ng(this.serializer)),this.$r=new Np,this.Ur=new Bp(this.referenceDelegate,this.serializer),this.remoteDocumentCache=cT(this.serializer),this.Gr=new Mp,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,h===!1&&Le("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new P(A.FAILED_PRECONDITION,qf);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new bt(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=t=>x(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(t=>x(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(()=>x(this,null,function*(){this.started&&(yield this.mi())})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>vc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(_r(e))return k("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return k("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Fs(e).get("owner").next(t=>b.resolve(this.vi(t)))}Ci(e){return vc(e).delete(this.clientId)}Fi(){return x(this,null,function*(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=We(t,"clientMetadata");return r.U().next(i=>{let o=this.xi(i,18e5),s=i.filter(a=>o.indexOf(a)===-1);return b.forEach(s,a=>r.delete(a.clientId)).next(()=>s)})}).catch(()=>[]);if(this.Vi)for(let t of e)this.Vi.removeItem(this.Oi(t.clientId))}})}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?b.resolve(!0):Fs(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new P(A.FAILED_PRECONDITION,qf);return!1}}return!(!this.networkEnabled||!this.inForeground)||vc(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let o=!this.networkEnabled&&i.networkEnabled,s=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(o||s&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&k("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return x(this,null,function*(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),yield this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new Gs(e,bt.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()})}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>vc(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return Gc.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new jp(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return $c.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){k("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",o=function(c){return c===17?cR:c===16?uR:c===15?Yg:c===14?mD:c===13?gD:c===12?aR:c===11?pD:void U()}(this.hi),s;return this.Ri.runTransaction(e,i,o,a=>(s=new Gs(a,this.Qr?this.Qr.next():bt.oe),t==="readwrite-primary"?this.wi(s).next(c=>!!c||this.Si(s)).next(c=>{if(!c)throw Le(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new P(A.FAILED_PRECONDITION,lD);return r(s)}).next(c=>this.Di(s).next(()=>c)):this.Ki(s).next(()=>r(s)))).then(a=>(s.raiseOnCommittedEvent(),a))}Ki(e){return Fs(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new P(A.FAILED_PRECONDITION,qf)})}Di(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Fs(e).put("owner",t)}static D(){return cr.D()}bi(e){let t=Fs(e);return t.get("owner").next(r=>this.vi(r)?(k("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):b.resolve())}Mi(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(Le(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();let t=/(?:Version|Mobile)\/1[456]/;dd()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{let r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return k("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Le("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Le("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Fs(n){return We(n,"owner")}function vc(n){return We(n,"clientMetadata")}function om(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var ig=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=X(),i=X();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var og=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Zc=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return dd()?8:dD(Zo())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.Yi(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.Zi(e,t,i,r).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new og;return this.Xi(e,t,s).next(a=>{if(o.result=a,this.zi)return this.es(e,t,s,a.size)})}).next(()=>o.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(Qi()<=Xt.DEBUG&&k("QueryEngine","SDK will not create cache indexes for query:",Yi(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),b.resolve()):(Qi()<=Xt.DEBUG&&k("QueryEngine","Query:",Yi(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Qi()<=Xt.DEBUG&&k("QueryEngine","The SDK decides to create cache indexes for query:",Yi(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ft(t))):b.resolve())}Yi(e,t){if(yE(t))return b.resolve(null);let r=ft(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Fc(t,null,"F"),r=ft(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let s=X(...o);return this.Ji.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.ts(t,a);return this.ns(t,l,s,c.readTime)?this.Yi(e,Fc(t,null,"F")):this.rs(e,l,t,c)}))})))}Zi(e,t,r,i){return yE(t)||i.isEqual(q.min())?b.resolve(null):this.Ji.getDocuments(e,r).next(o=>{let s=this.ts(t,o);return this.ns(t,s,r,i)?b.resolve(null):(Qi()<=Xt.DEBUG&&k("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Yi(t)),this.rs(e,s,t,uD(i,-1)).next(a=>a))})}ts(e,t){let r=new Ee(MD(e));return t.forEach((i,o)=>{pa(e,o)&&(r=r.add(o))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Xi(e,t,r){return Qi()<=Xt.DEBUG&&k("QueryEngine","Using full collection scan to execute query:",Yi(t)),this.Ji.getDocumentsMatchingQuery(e,t,Ot.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var sg=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new xe(Z),this._s=new gn(o=>Jr(o),ha),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Kc(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function lT(n,e,t,r){return new sg(n,e,t,r)}function dT(n,e){return x(this,null,function*(){let t=V(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let s=[],a=[],c=X();for(let l of i){s.push(l.batchId);for(let h of l.mutations)c=c.add(h.key)}for(let l of o){a.push(l.batchId);for(let h of l.mutations)c=c.add(h.key)}return t.localDocuments.getDocuments(r,c).next(l=>({hs:l,removedBatchIds:s,addedBatchIds:a}))})})})}function $R(n,e){let t=V(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,c,l,h){let p=l.batch,m=p.keys(),v=b.resolve();return m.forEach(M=>{v=v.next(()=>h.getEntry(c,M)).next(N=>{let R=l.docVersions.get(M);H(R!==null),N.version.compareTo(R)<0&&(p.applyToRemoteDocument(N,l),N.isValidDocument()&&(N.setReadTime(l.commitVersion),h.addEntry(N)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(c,p))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=X();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function hT(n){let e=V(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function HR(n,e){let t=V(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let a=[];e.targetChanges.forEach((h,p)=>{let m=i.get(p);if(!m)return;a.push(t.Ur.removeMatchingKeys(o,h.removedDocuments,p).next(()=>t.Ur.addMatchingKeys(o,h.addedDocuments,p)));let v=m.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(p)!==null?v=v.withResumeToken(Be.EMPTY_BYTE_STRING,q.min()).withLastLimboFreeSnapshotVersion(q.min()):h.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(h.resumeToken,r)),i=i.insert(p,v),function(N,R,B){return N.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-N.snapshotVersion.toMicroseconds()>=3e8?!0:B.addedDocuments.size+B.modifiedDocuments.size+B.removedDocuments.size>0}(m,v,h)&&a.push(t.Ur.updateTargetData(o,v))});let c=vt(),l=X();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,h))}),a.push(fT(o,s,e.documentUpdates).next(h=>{c=h.Ps,l=h.Is})),!r.isEqual(q.min())){let h=t.Ur.getLastRemoteSnapshotVersion(o).next(p=>t.Ur.setTargetsMetadata(o,o.currentSequenceNumber,r));a.push(h)}return b.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,c,l)).next(()=>c)}).then(o=>(t.os=i,o))}function fT(n,e,t){let r=X(),i=X();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let s=vt();return t.forEach((a,c)=>{let l=o.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(q.min())?(e.removeEntry(a,c.readTime),s=s.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),s=s.insert(a,c)):k("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{Ps:s,Is:i}})}function qR(n,e){let t=V(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function po(n,e){let t=V(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(o=>o?(i=o,b.resolve(i)):t.Ur.allocateTargetId(r).next(s=>(i=new ho(e,s,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function go(n,e,t){return x(this,null,function*(){let r=V(n),i=r.os.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,s=>r.persistence.referenceDelegate.removeTarget(s,i)))}catch(s){if(!_r(s))throw s;k("LocalStore",`Failed to update sequence numbers for target ${e}: ${s}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function Jc(n,e,t){let r=V(n),i=q.min(),o=X();return r.persistence.runTransaction("Execute query","readwrite",s=>function(c,l,h){let p=V(c),m=p._s.get(h);return m!==void 0?b.resolve(p.os.get(m)):p.Ur.getTargetData(l,h)}(r,s,ft(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(s,a.targetId).next(c=>{o=c})}).next(()=>r.ss.getDocumentsMatchingQuery(s,e,t?i:q.min(),t?o:X())).next(a=>(mT(r,xD(e),a),{documents:a,Ts:o})))}function pT(n,e){let t=V(n),r=V(t.Ur),i=t.os.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",o=>r.ot(o,e).next(s=>s?s.target:null))}function gT(n,e){let t=V(n),r=t.us.get(e)||q.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.cs.getAllFromCollectionGroup(i,e,uD(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(mT(t,e,i),i))}function mT(n,e,t){let r=n.us.get(e)||q.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.us.set(e,r)}function zR(n,e,t,r){return x(this,null,function*(){let i=V(n),o=X(),s=vt();for(let l of t){let h=e.Es(l.metadata.name);l.document&&(o=o.add(h));let p=e.ds(l);p.setReadTime(e.As(l.metadata.readTime)),s=s.insert(h,p)}let a=i.cs.newChangeBuffer({trackRemovals:!0}),c=yield po(i,function(h){return ft(Do(ce.fromString(`__bundle__/docs/${h}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>fT(l,a,s).next(h=>(a.apply(l),h)).next(h=>i.Ur.removeMatchingKeysForTargetId(l,c.targetId).next(()=>i.Ur.addMatchingKeys(l,o,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,h.Ps,h.Is)).next(()=>h.Ps)))})}function GR(r,i){return x(this,arguments,function*(n,e,t=X()){let o=yield po(n,ft(rm(e.bundledQuery))),s=V(n);return s.persistence.runTransaction("Save named query","readwrite",a=>{let c=je(e.readTime);if(o.snapshotVersion.compareTo(c)>=0)return s.Gr.saveNamedQuery(a,e);let l=o.withResumeToken(Be.EMPTY_BYTE_STRING,c);return s.os=s.os.insert(l.targetId,l),s.Ur.updateTargetData(a,l).next(()=>s.Ur.removeMatchingKeysForTargetId(a,o.targetId)).next(()=>s.Ur.addMatchingKeys(a,t,o.targetId)).next(()=>s.Gr.saveNamedQuery(a,e))})})}function zE(n,e){return`firestore_clients_${n}_${e}`}function GE(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function zf(n,e){return`firestore_targets_${n}_${e}`}var Xc=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Rs(e,t,r){let i=JSON.parse(r),o,s=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return s&&i.error&&(s=typeof i.error.message=="string"&&typeof i.error.code=="string",s&&(o=new P(i.error.code,i.error.message))),s?new n(e,t,i.state,o):(Le("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},$s=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){let r=JSON.parse(t),i,o=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(i=new P(r.error.code,r.error.message))),o?new n(e,r.state,i):(Le("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},el=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,o=em();for(let s=0;i&&s<r.activeTargetIds.length;++s)i=hD(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new n(e,o):(Le("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},ag=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(Le("SharedClientState",`Failed to parse online state: ${e}`),null)}},oa=class{constructor(){this.activeTargetIds=em()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Hs=class{constructor(e,t,r,i,o){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new xe(Z),this.started=!1,this.bs=[];let s=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Ds=zE(this.persistenceKey,this.ps),this.vs=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new oa),this.Cs=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.xs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Os=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}start(){return x(this,null,function*(){let e=yield this.syncEngine.Qi();for(let r of e){if(r===this.ps)continue;let i=this.getItem(zE(this.persistenceKey,r));if(i){let o=el.Rs(r,i);o&&(this.Ss=this.Ss.insert(o.clientId,o))}}this.Ns();let t=this.storage.getItem(this.xs);if(t){let r=this.Ls(t);r&&this.Bs(r)}for(let r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){let i=this.storage.getItem(zf(this.persistenceKey,e));if(i){let o=$s.Rs(e,i);o&&(r=o.state)}}return t&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(zf(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return k("SharedClientState","READ",e,t),t}setItem(e,t){k("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){k("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){let t=e;if(t.storageArea===this.storage){if(k("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void Le("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(()=>x(this,null,function*(){if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){let r=this.Gs(t.key);return this.zs(r,null)}{let r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){let r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){let r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){let r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){let r=function(o){let s=bt.oe;if(o!=null)try{let a=JSON.parse(o);H(typeof a=="number"),s=a}catch(a){Le("SharedClientState","Failed to read sequence number from WebStorage",a)}return s}(t.newValue);r!==bt.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){let r=this.Xs(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(t)}))}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){let i=new Xc(this.currentUser,e,t,r),o=GE(this.persistenceKey,this.currentUser,e);this.setItem(o,i.Vs())}Qs(e){let t=GE(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){let t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){let i=zf(this.persistenceKey,e),o=new $s(e,t,r);this.setItem(i,o.Vs())}Ws(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){let t=this.Cs.exec(e);return t?t[1]:null}js(e,t){let r=this.Gs(e);return el.Rs(r,t)}Hs(e,t){let r=this.Fs.exec(e),i=Number(r[1]),o=r[2]!==void 0?r[2]:null;return Xc.Rs(new He(o),i,t)}Ys(e,t){let r=this.Ms.exec(e),i=Number(r[1]);return $s.Rs(i,t)}Ls(e){return ag.Rs(e)}Xs(e){return JSON.parse(e)}Js(e){return x(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);k("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){let r=t?this.Ss.insert(e,t):this.Ss.remove(e),i=this.ks(this.Ss),o=this.ks(r),s=[],a=[];return o.forEach(c=>{i.has(c)||s.push(c)}),i.forEach(c=>{o.has(c)||a.push(c)}),this.syncEngine.io(s,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=em();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},tl=class{constructor(){this.so=new oa,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new oa,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var ug=class{_o(e){}shutdown(){}};var nl=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){k("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){k("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var _c=null;function Gf(){return _c===null?_c=function(){return 268435456+Math.round(2147483648*Math.random())}():_c++,"0x"+_c.toString(16)}var WR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var cg=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var ot="WebChannelConnection",lg=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get Fo(){return!1}Mo(t,r,i,o,s){let a=Gf(),c=this.xo(t,r.toUriEncodedString());k("RestConnection",`Sending RPC '${t}' ${a}:`,c,i);let l={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(l,o,s),this.No(t,c,l,i).then(h=>(k("RestConnection",`Received RPC '${t}' ${a}: `,h),h),h=>{throw Kt("RestConnection",`RPC '${t}' ${a} failed with error: `,h,"url: ",c,"request:",i),h})}Lo(t,r,i,o,s,a){return this.Mo(t,r,i,o,s)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Eo}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,s)=>t[s]=o),i&&i.headers.forEach((o,s)=>t[s]=o)}xo(t,r){let i=WR[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let o=Gf();return new Promise((s,a)=>{let c=new Vf;c.setWithCredentials(!0),c.listenOnce(jf.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Rs.NO_ERROR:let h=c.getResponseJson();k(ot,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),s(h);break;case Rs.TIMEOUT:k(ot,`RPC '${e}' ${o} timed out`),a(new P(A.DEADLINE_EXCEEDED,"Request time out"));break;case Rs.HTTP_ERROR:let p=c.getStatus();if(k(ot,`RPC '${e}' ${o} failed with status:`,p,"response text:",c.getResponseText()),p>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);let v=m?.error;if(v&&v.status&&v.message){let M=function(R){let B=R.toLowerCase().replace(/_/g,"-");return Object.values(A).indexOf(B)>=0?B:A.UNKNOWN}(v.status);a(new P(M,v.message))}else a(new P(A.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new P(A.UNAVAILABLE,"Connection failed."));break;default:U()}}finally{k(ot,`RPC '${e}' ${o} completed.`)}});let l=JSON.stringify(i);k(ot,`RPC '${e}' ${o} sending request:`,i),c.send(t,"POST",l,r,15)})}Bo(e,t,r){let i=Gf(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=$f(),a=Uf(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let h=o.join("");k(ot,`Creating RPC '${e}' stream ${i}: ${h}`,c);let p=s.createWebChannel(h,c),m=!1,v=!1,M=new cg({Io:R=>{v?k(ot,`Not sending because RPC '${e}' stream ${i} is closed:`,R):(m||(k(ot,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),k(ot,`RPC '${e}' stream ${i} sending:`,R),p.send(R))},To:()=>p.close()}),N=(R,B,$)=>{R.listen(B,L=>{try{$(L)}catch(z){setTimeout(()=>{throw z},0)}})};return N(p,qi.EventType.OPEN,()=>{v||(k(ot,`RPC '${e}' stream ${i} transport opened.`),M.yo())}),N(p,qi.EventType.CLOSE,()=>{v||(v=!0,k(ot,`RPC '${e}' stream ${i} transport closed`),M.So())}),N(p,qi.EventType.ERROR,R=>{v||(v=!0,Kt(ot,`RPC '${e}' stream ${i} transport errored:`,R),M.So(new P(A.UNAVAILABLE,"The operation could not be completed")))}),N(p,qi.EventType.MESSAGE,R=>{var B;if(!v){let $=R.data[0];H(!!$);let L=$,z=L.error||((B=L[0])===null||B===void 0?void 0:B.error);if(z){k(ot,`RPC '${e}' stream ${i} received error:`,z);let W=z.status,G=function(w){let E=Ue[w];if(E!==void 0)return HD(E)}(W),I=z.message;G===void 0&&(G=A.INTERNAL,I="Unknown error status: "+W+" with message "+z.message),v=!0,M.So(new P(G,I)),p.close()}else k(ot,`RPC '${e}' stream ${i} received:`,$),M.bo($)}}),N(a,Bf.STAT_EVENT,R=>{R.stat===gc.PROXY?k(ot,`RPC '${e}' stream ${i} detected buffering proxy`):R.stat===gc.NOPROXY&&k(ot,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{M.wo()},0),M}};function yT(){return typeof window<"u"?window:null}function Tc(){return typeof document<"u"?document:null}function ga(n){return new Cp(n,!0)}var sa=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&k("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var rl=class{constructor(e,t,r,i,o,s,a,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new sa(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return x(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return x(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return x(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===A.RESOURCE_EXHAUSTED?(Le(t.toString()),Le("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===A.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new P(A.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>x(this,null,function*(){this.state=0,this.start()}))}I_(e){return k("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(k("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},dg=class extends rl{constructor(e,t,r,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=NR(this.serializer,e),r=function(o){if(!("targetChange"in o))return q.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?q.min():s.readTime?je(s.readTime):q.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=Ap(this.serializer),t.addTarget=function(o,s){let a,c=s.target;if(a=kc(c)?{documents:ZD(o,c)}:{query:JD(o,c)._t},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=zD(o,s.resumeToken);let l=bp(o,s.expectedCount);l!==null&&(a.expectedCount=l)}else if(s.snapshotVersion.compareTo(q.min())>0){a.readTime=lo(o,s.snapshotVersion.toTimestamp());let l=bp(o,s.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=PR(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=Ap(this.serializer),t.removeTarget=e,this.a_(t)}},hg=class extends rl{constructor(e,t,r,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return H(!!e.streamToken),this.lastStreamToken=e.streamToken,H(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){H(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=RR(e.writeResults,e.commitTime),r=je(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=Ap(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>na(this.serializer,r))};this.a_(t)}};var fg=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new P(A.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Mo(e,Sp(t,r),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===A.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new P(A.UNKNOWN,o.toString())})}Lo(e,t,r,i,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Lo(e,Sp(t,r),i,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===A.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new P(A.UNKNOWN,s.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},pg=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Le(t),this.D_=!1):k("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var gg=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(s=>{r.enqueueAndForget(()=>x(this,null,function*(){wr(this)&&(k("RemoteStore","Restarting streams for network reachability change."),yield function(c){return x(this,null,function*(){let l=V(c);l.L_.add(4),yield To(l),l.q_.set("Unknown"),l.L_.delete(4),yield ma(l)})}(this))}))}),this.q_=new pg(r,i)}};function ma(n){return x(this,null,function*(){if(wr(n))for(let e of n.B_)yield e(!0)})}function To(n){return x(this,null,function*(){for(let e of n.B_)yield e(!1)})}function Tl(n,e){let t=V(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),um(t)?am(t):bo(t).r_()&&sm(t,e))}function mo(n,e){let t=V(n),r=bo(t);t.N_.delete(e),r.r_()&&vT(t,e),t.N_.size===0&&(r.r_()?r.o_():wr(t)&&t.q_.set("Unknown"))}function sm(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(q.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}bo(n).A_(e)}function vT(n,e){n.Q_.xe(e),bo(n).R_(e)}function am(n){n.Q_=new Tp({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),bo(n).start(),n.q_.v_()}function um(n){return wr(n)&&!bo(n).n_()&&n.N_.size>0}function wr(n){return V(n).L_.size===0}function _T(n){n.Q_=void 0}function KR(n){return x(this,null,function*(){n.q_.set("Online")})}function QR(n){return x(this,null,function*(){n.N_.forEach((e,t)=>{sm(n,e)})})}function YR(n,e){return x(this,null,function*(){_T(n),um(n)?(n.q_.M_(e),am(n)):n.q_.set("Unknown")})}function ZR(n,e,t){return x(this,null,function*(){if(n.q_.set("Online"),e instanceof Vc&&e.state===2&&e.cause)try{yield function(i,o){return x(this,null,function*(){let s=o.cause;for(let a of o.targetIds)i.N_.has(a)&&(yield i.remoteSyncer.rejectListen(a,s),i.N_.delete(a),i.Q_.removeTarget(a))})}(n,e)}catch(r){k("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield il(n,r)}else if(e instanceof ro?n.Q_.Ke(e):e instanceof Lc?n.Q_.He(e):n.Q_.We(e),!t.isEqual(q.min()))try{let r=yield hT(n.localStore);t.compareTo(r)>=0&&(yield function(o,s){let a=o.Q_.rt(s);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let h=o.N_.get(l);h&&o.N_.set(l,h.withResumeToken(c.resumeToken,s))}}),a.targetMismatches.forEach((c,l)=>{let h=o.N_.get(c);if(!h)return;o.N_.set(c,h.withResumeToken(Be.EMPTY_BYTE_STRING,h.snapshotVersion)),vT(o,c);let p=new ho(h.target,c,l,h.sequenceNumber);sm(o,p)}),o.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){k("RemoteStore","Failed to raise snapshot:",r),yield il(n,r)}})}function il(n,e,t){return x(this,null,function*(){if(!_r(e))throw e;n.L_.add(1),yield To(n),n.q_.set("Offline"),t||(t=()=>hT(n.localStore)),n.asyncQueue.enqueueRetryable(()=>x(this,null,function*(){k("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield ma(n)}))})}function wT(n,e){return e().catch(t=>il(n,t,e))}function Co(n){return x(this,null,function*(){let e=V(n),t=yr(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;JR(e);)try{let i=yield qR(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,XR(e,i)}catch(i){yield il(e,i)}IT(e)&&ET(e)})}function JR(n){return wr(n)&&n.O_.length<10}function XR(n,e){n.O_.push(e);let t=yr(n);t.r_()&&t.V_&&t.m_(e.mutations)}function IT(n){return wr(n)&&!yr(n).n_()&&n.O_.length>0}function ET(n){yr(n).start()}function eP(n){return x(this,null,function*(){yr(n).p_()})}function tP(n){return x(this,null,function*(){let e=yr(n);for(let t of n.O_)e.m_(t.mutations)})}function nP(n,e,t){return x(this,null,function*(){let r=n.O_.shift(),i=Ip.from(r,e,t);yield wT(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Co(n)})}function rP(n,e){return x(this,null,function*(){e&&yr(n).V_&&(yield function(r,i){return x(this,null,function*(){if(function(s){return $D(s)&&s!==A.ABORTED}(i.code)){let o=r.O_.shift();yr(r).s_(),yield wT(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield Co(r)}})}(n,e)),IT(n)&&ET(n)})}function WE(n,e){return x(this,null,function*(){let t=V(n);t.asyncQueue.verifyOperationInProgress(),k("RemoteStore","RemoteStore received new credentials");let r=wr(t);t.L_.add(3),yield To(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield ma(t)})}function mg(n,e){return x(this,null,function*(){let t=V(n);e?(t.L_.delete(2),yield ma(t)):e||(t.L_.add(2),yield To(t),t.q_.set("Unknown"))})}function bo(n){return n.K_||(n.K_=function(t,r,i){let o=V(t);return o.w_(),new dg(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:KR.bind(null,n),Ro:QR.bind(null,n),mo:YR.bind(null,n),d_:ZR.bind(null,n)}),n.B_.push(e=>x(this,null,function*(){e?(n.K_.s_(),um(n)?am(n):n.q_.set("Unknown")):(yield n.K_.stop(),_T(n))}))),n.K_}function yr(n){return n.U_||(n.U_=function(t,r,i){let o=V(t);return o.w_(),new hg(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:eP.bind(null,n),mo:rP.bind(null,n),f_:tP.bind(null,n),g_:nP.bind(null,n)}),n.B_.push(e=>x(this,null,function*(){e?(n.U_.s_(),yield Co(n)):(yield n.U_.stop(),n.O_.length>0&&(k("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var yg=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new Ge,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let s=Date.now()+r,a=new n(e,t,s,i,o);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new P(A.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function So(n,e){if(Le("AsyncQueue",`${e}: ${n}`),_r(n))return new P(A.UNAVAILABLE,`${e}: ${n}`);throw n}var ol=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||j.comparator(t.key,r.key):(t,r)=>j.comparator(t.key,r.key),this.keyedMap=Ls(),this.sortedSet=new xe(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var sl=class{constructor(){this.W_=new xe(j.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):U():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},yo=class n{constructor(e,t,r,i,o,s,a,c,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,o){let s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new n(e,t,ol.emptySet(t),s,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&fa(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var vg=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},_g=class{constructor(){this.queries=KE(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=V(t),o=i.queries;i.queries=KE(),o.forEach((s,a)=>{for(let c of a.j_)c.onError(r)})})(this,new P(A.ABORTED,"Firestore shutting down"))}};function KE(){return new gn(n=>AD(n),fa)}function cm(n,e){return x(this,null,function*(){let t=V(n),r=3,i=e.query,o=t.queries.get(i);o?!o.H_()&&e.J_()&&(r=2):(o=new vg,r=e.J_()?0:1);try{switch(r){case 0:o.z_=yield t.onListen(i,!0);break;case 1:o.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(s){let a=So(s,`Initialization of query '${Yi(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,o),o.j_.push(e),e.Z_(t.onlineState),o.z_&&e.X_(o.z_)&&dm(t)})}function lm(n,e){return x(this,null,function*(){let t=V(n),r=e.query,i=3,o=t.queries.get(r);if(o){let s=o.j_.indexOf(e);s>=0&&(o.j_.splice(s,1),o.j_.length===0?i=e.J_()?0:1:!o.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function iP(n,e){let t=V(n),r=!1;for(let i of e){let o=i.query,s=t.queries.get(o);if(s){for(let a of s.j_)a.X_(i)&&(r=!0);s.z_=i}}r&&dm(t)}function oP(n,e,t){let r=V(n),i=r.queries.get(e);if(i)for(let o of i.j_)o.onError(t);r.queries.delete(e)}function dm(n){n.Y_.forEach(e=>{e.next()})}var wg,QE;(QE=wg||(wg={})).ea="default",QE.Cache="cache";var aa=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new yo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=yo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==wg.Cache}};var Ig=class{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}};var al=class{constructor(e){this.serializer=e}Es(e){return dn(this.serializer,e)}ds(e){return e.metadata.exists?YD(this.serializer,e.document,!1):qe.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return je(e)}},Eg=class{constructor(e,t,r){this.ca=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=DT(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;let r=ce.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){let t=new Map,r=new al(this.serializer);for(let i of e)if(i.metadata.queries){let o=r.Es(i.metadata.name);for(let s of i.metadata.queries){let a=(t.get(s)||X()).add(o);t.set(s,a)}}return t}complete(){return x(this,null,function*(){let e=yield zR(this.localStore,new al(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(let r of this.queries)yield GR(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}})}};function DT(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var ul=class{constructor(e){this.key=e}},cl=class{constructor(e){this.key=e}},ll=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=X(),this.mutatedKeys=X(),this.Aa=MD(e),this.Ra=new ol(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new sl,i=t?t.Ra:this.Ra,o=t?t.mutatedKeys:this.mutatedKeys,s=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,p)=>{let m=i.get(h),v=pa(this.query,p)?p:null,M=!!m&&this.mutatedKeys.has(m.key),N=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations),R=!1;m&&v?m.data.isEqual(v.data)?M!==N&&(r.track({type:3,doc:v}),R=!0):this.ga(m,v)||(r.track({type:2,doc:v}),R=!0,(c&&this.Aa(v,c)>0||l&&this.Aa(v,l)<0)&&(a=!0)):!m&&v?(r.track({type:0,doc:v}),R=!0):m&&!v&&(r.track({type:1,doc:m}),R=!0,(c||l)&&(a=!0)),R&&(v?(s=s.add(v),o=N?o.add(h):o.delete(h)):(s=s.delete(h),o=o.delete(h)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let h=this.query.limitType==="F"?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{Ra:s,fa:r,ns:a,mutatedKeys:o}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let s=e.fa.G_();s.sort((h,p)=>function(v,M){let N=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return U()}};return N(v)-N(M)}(h.type,p.type)||this.Aa(h.doc,p.doc)),this.pa(r),i=i!=null&&i;let a=t&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,l=c!==this.Ea;return this.Ea=c,s.length!==0||l?{snapshot:new yo(this.query,e.Ra,o,s,e.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new sl,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=X(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new cl(r))}),this.da.forEach(r=>{e.has(r)||t.push(new ul(r))}),t}ba(e){this.Ta=e.Ts,this.da=X();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return yo.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},Dg=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},Tg=class{constructor(e){this.key=e,this.va=!1}},Cg=class{constructor(e,t,r,i,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Ca={},this.Fa=new gn(a=>AD(a),fa),this.Ma=new Map,this.xa=new Set,this.Oa=new xe(j.comparator),this.Na=new Map,this.La=new ia,this.Ba={},this.ka=new Map,this.qa=fo.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function sP(n,e,t=!0){return x(this,null,function*(){let r=Cl(n),i,o=r.Fa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Da()):i=yield TT(r,e,t,!0),i})}function aP(n,e){return x(this,null,function*(){let t=Cl(n);yield TT(t,e,!0,!1)})}function TT(n,e,t,r){return x(this,null,function*(){let i=yield po(n.localStore,ft(e)),o=i.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t),a;return r&&(a=yield hm(n,e,o,s==="current",i.resumeToken)),n.isPrimaryClient&&t&&Tl(n.remoteStore,i),a})}function hm(n,e,t,r,i){return x(this,null,function*(){n.Ka=(p,m,v)=>function(N,R,B,$){return x(this,null,function*(){let L=R.view.ma(B);L.ns&&(L=yield Jc(N.localStore,R.query,!1).then(({documents:I})=>R.view.ma(I,L)));let z=$&&$.targetChanges.get(R.targetId),W=$&&$.targetMismatches.get(R.targetId)!=null,G=R.view.applyChanges(L,N.isPrimaryClient,z,W);return bg(N,R.targetId,G.wa),G.snapshot})}(n,p,m,v);let o=yield Jc(n.localStore,e,!0),s=new ll(e,o.Ts),a=s.ma(o.documents),c=ea.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=s.applyChanges(a,n.isPrimaryClient,c);bg(n,t,l.wa);let h=new Dg(e,t,s);return n.Fa.set(e,h),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),l.snapshot})}function uP(n,e,t){return x(this,null,function*(){let r=V(n),i=r.Fa.get(e),o=r.Ma.get(i.targetId);if(o.length>1)return r.Ma.set(i.targetId,o.filter(s=>!fa(s,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield go(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&mo(r.remoteStore,i.targetId),vo(r,i.targetId)}).catch(vr))):(vo(r,i.targetId),yield go(r.localStore,i.targetId,!0))})}function cP(n,e){return x(this,null,function*(){let t=V(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),mo(t.remoteStore,r.targetId))})}function lP(n,e,t){return x(this,null,function*(){let r=mm(n);try{let i=yield function(s,a){let c=V(s),l=Re.now(),h=a.reduce((v,M)=>v.add(M.key),X()),p,m;return c.persistence.runTransaction("Locally write mutations","readwrite",v=>{let M=vt(),N=X();return c.cs.getEntries(v,h).next(R=>{M=R,M.forEach((B,$)=>{$.isValidDocument()||(N=N.add(B))})}).next(()=>c.localDocuments.getOverlayedDocuments(v,M)).next(R=>{p=R;let B=[];for(let $ of a){let L=TR($,p.get($.key).overlayedDocument);L!=null&&B.push(new Yt($.key,L,ID(L.value.mapValue),Fe.exists(!0)))}return c.mutationQueue.addMutationBatch(v,l,B,a)}).next(R=>{m=R;let B=R.applyToLocalDocumentSet(p,N);return c.documentOverlayCache.saveOverlays(v,R.batchId,B)})}).then(()=>({batchId:m.batchId,changes:RD(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,a,c){let l=s.Ba[s.currentUser.toKey()];l||(l=new xe(Z)),l=l.insert(a,c),s.Ba[s.currentUser.toKey()]=l}(r,i.batchId,t),yield jn(r,i.changes),yield Co(r.remoteStore)}catch(i){let o=So(i,"Failed to persist write");t.reject(o)}})}function CT(n,e){return x(this,null,function*(){let t=V(n);try{let r=yield HR(t.localStore,e);e.targetChanges.forEach((i,o)=>{let s=t.Na.get(o);s&&(H(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?s.va=!0:i.modifiedDocuments.size>0?H(s.va):i.removedDocuments.size>0&&(H(s.va),s.va=!1))}),yield jn(t,r,e)}catch(r){yield vr(r)}})}function YE(n,e,t){let r=V(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((o,s)=>{let a=s.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(s,a){let c=V(s);c.onlineState=a;let l=!1;c.queries.forEach((h,p)=>{for(let m of p.j_)m.Z_(a)&&(l=!0)}),l&&dm(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function dP(n,e,t){return x(this,null,function*(){let r=V(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),o=i&&i.key;if(o){let s=new xe(j.comparator);s=s.insert(o,qe.newNoDocument(o,q.min()));let a=X().add(o),c=new Xs(q.min(),new Map,new xe(Z),s,a);yield CT(r,c),r.Oa=r.Oa.remove(o),r.Na.delete(e),gm(r)}else yield go(r.localStore,e,!1).then(()=>vo(r,e,t)).catch(vr)})}function hP(n,e){return x(this,null,function*(){let t=V(n),r=e.batch.batchId;try{let i=yield $R(t.localStore,e);pm(t,r,null),fm(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield jn(t,i)}catch(i){yield vr(i)}})}function fP(n,e,t){return x(this,null,function*(){let r=V(n);try{let i=yield function(s,a){let c=V(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let h;return c.mutationQueue.lookupMutationBatch(l,a).next(p=>(H(p!==null),h=p.keys(),c.mutationQueue.removeMutationBatch(l,p))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,h,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,h)).next(()=>c.localDocuments.getDocuments(l,h))})}(r.localStore,e);pm(r,e,t),fm(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield jn(r,i)}catch(i){yield vr(i)}})}function pP(n,e){return x(this,null,function*(){let t=V(n);wr(t.remoteStore)||k("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(s){let a=V(s);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(r===-1)return void e.resolve();let i=t.ka.get(r)||[];i.push(e),t.ka.set(r,i)}catch(r){let i=So(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function fm(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function pm(n,e,t){let r=V(n),i=r.Ba[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function vo(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||bT(n,r)})}function bT(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(mo(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),gm(n))}function bg(n,e,t){for(let r of t)r instanceof ul?(n.La.addReference(r.key,e),gP(n,r)):r instanceof cl?(k("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||bT(n,r.key)):U()}function gP(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(k("SyncEngine","New document in limbo: "+t),n.xa.add(r),gm(n))}function gm(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new j(ce.fromString(e)),r=n.qa.next();n.Na.set(r,new Tg(t)),n.Oa=n.Oa.insert(t,r),Tl(n.remoteStore,new ho(ft(Do(t.path)),r,"TargetPurposeLimboResolution",bt.oe))}}function jn(n,e,t){return x(this,null,function*(){let r=V(n),i=[],o=[],s=[];r.Fa.isEmpty()||(r.Fa.forEach((a,c)=>{s.push(r.Ka(c,e,t).then(l=>{var h;if((l||t)&&r.isPrimaryClient){let p=l?!l.fromCache:(h=t?.targetChanges.get(c.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(c.targetId,p?"current":"not-current")}if(l){i.push(l);let p=ig.Wi(c.targetId,l);o.push(p)}}))}),yield Promise.all(s),r.Ca.d_(i),yield function(c,l){return x(this,null,function*(){let h=V(c);try{yield h.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>b.forEach(l,m=>b.forEach(m.$i,v=>h.persistence.referenceDelegate.addReference(p,m.targetId,v)).next(()=>b.forEach(m.Ui,v=>h.persistence.referenceDelegate.removeReference(p,m.targetId,v)))))}catch(p){if(!_r(p))throw p;k("LocalStore","Failed to update sequence numbers: "+p)}for(let p of l){let m=p.targetId;if(!p.fromCache){let v=h.os.get(m),M=v.snapshotVersion,N=v.withLastLimboFreeSnapshotVersion(M);h.os=h.os.insert(m,N)}}})}(r.localStore,o))})}function mP(n,e){return x(this,null,function*(){let t=V(n);if(!t.currentUser.isEqual(e)){k("SyncEngine","User change. New user:",e.toKey());let r=yield dT(t.localStore,e);t.currentUser=e,function(o,s){o.ka.forEach(a=>{a.forEach(c=>{c.reject(new P(A.CANCELLED,s))})}),o.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield jn(t,r.hs)}})}function yP(n,e){let t=V(n),r=t.Na.get(e);if(r&&r.va)return X().add(r.key);{let i=X(),o=t.Ma.get(e);if(!o)return i;for(let s of o){let a=t.Fa.get(s);i=i.unionWith(a.view.Va)}return i}}function vP(n,e){return x(this,null,function*(){let t=V(n),r=yield Jc(t.localStore,e.query,!0),i=e.view.ba(r);return t.isPrimaryClient&&bg(t,e.targetId,i.wa),i})}function _P(n,e){return x(this,null,function*(){let t=V(n);return gT(t.localStore,e).then(r=>jn(t,r))})}function wP(n,e,t,r){return x(this,null,function*(){let i=V(n),o=yield function(a,c){let l=V(a),h=V(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",p=>h.Mn(p,c).next(m=>m?l.localDocuments.getDocuments(p,m):b.resolve(null)))}(i.localStore,e);o!==null?(t==="pending"?yield Co(i.remoteStore):t==="acknowledged"||t==="rejected"?(pm(i,e,r||null),fm(i,e),function(a,c){V(V(a).mutationQueue).On(c)}(i.localStore,e)):U(),yield jn(i,o)):k("SyncEngine","Cannot apply mutation batch with id: "+e)})}function IP(n,e){return x(this,null,function*(){let t=V(n);if(Cl(t),mm(t),e===!0&&t.Qa!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield ZE(t,r.toArray());t.Qa=!0,yield mg(t.remoteStore,!0);for(let o of i)Tl(t.remoteStore,o)}else if(e===!1&&t.Qa!==!1){let r=[],i=Promise.resolve();t.Ma.forEach((o,s)=>{t.sharedClientState.isLocalQueryTarget(s)?r.push(s):i=i.then(()=>(vo(t,s),go(t.localStore,s,!0))),mo(t.remoteStore,s)}),yield i,yield ZE(t,r),function(s){let a=V(s);a.Na.forEach((c,l)=>{mo(a.remoteStore,l)}),a.La.pr(),a.Na=new Map,a.Oa=new xe(j.comparator)}(t),t.Qa=!1,yield mg(t.remoteStore,!1)}})}function ZE(n,e,t){return x(this,null,function*(){let r=V(n),i=[],o=[];for(let s of e){let a,c=r.Ma.get(s);if(c&&c.length!==0){a=yield po(r.localStore,ft(c[0]));for(let l of c){let h=r.Fa.get(l),p=yield vP(r,h);p.snapshot&&o.push(p.snapshot)}}else{let l=yield pT(r.localStore,s);a=yield po(r.localStore,l),yield hm(r,ST(l),s,!1,a.resumeToken)}i.push(a)}return r.Ca.d_(o),i})}function ST(n){return SD(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function EP(n){return function(t){return V(V(t).persistence).Qi()}(V(n).localStore)}function DP(n,e,t,r){return x(this,null,function*(){let i=V(n);if(i.Qa)return void k("SyncEngine","Ignoring unexpected query state notification.");let o=i.Ma.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{let s=yield gT(i.localStore,xD(o[0])),a=Xs.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Be.EMPTY_BYTE_STRING);yield jn(i,s,a);break}case"rejected":yield go(i.localStore,e,!0),vo(i,e,r);break;default:U()}})}function TP(n,e,t){return x(this,null,function*(){let r=Cl(n);if(r.Qa){for(let i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){k("SyncEngine","Adding an already active target "+i);continue}let o=yield pT(r.localStore,i),s=yield po(r.localStore,o);yield hm(r,ST(o),s.targetId,!1,s.resumeToken),Tl(r.remoteStore,s)}for(let i of t)r.Ma.has(i)&&(yield go(r.localStore,i,!1).then(()=>{mo(r.remoteStore,i),vo(r,i)}).catch(vr))}})}function Cl(n){let e=V(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=CT.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=yP.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=dP.bind(null,e),e.Ca.d_=iP.bind(null,e.eventManager),e.Ca.$a=oP.bind(null,e.eventManager),e}function mm(n){let e=V(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=hP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=fP.bind(null,e),e}function CP(n,e,t){let r=V(n);(function(o,s,a){return x(this,null,function*(){try{let c=yield s.getMetadata();if(yield function(v,M){let N=V(v),R=je(M.createTime);return N.persistence.runTransaction("hasNewerBundle","readonly",B=>N.Gr.getBundleMetadata(B,M.id)).then(B=>!!B&&B.createTime.compareTo(R)>=0)}(o.localStore,c))return yield s.close(),a._completeWith(function(v){return{taskState:"Success",documentsLoaded:v.totalDocuments,bytesLoaded:v.totalBytes,totalDocuments:v.totalDocuments,totalBytes:v.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(DT(c));let l=new Eg(c,o.localStore,s.serializer),h=yield s.Ua();for(;h;){let m=yield l.la(h);m&&a._updateProgress(m),h=yield s.Ua()}let p=yield l.complete();return yield jn(o,p.Ia,void 0),yield function(v,M){let N=V(v);return N.persistence.runTransaction("Save bundle","readwrite",R=>N.Gr.saveBundleMetadata(R,M))}(o.localStore,c),a._completeWith(p.progress),Promise.resolve(p.Pa)}catch(c){return Kt("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var Sg=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return x(this,null,function*(){this.serializer=ga(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),yield this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)})}ja(t,r){return null}Ha(t,r){return null}za(t){return lT(this.persistence,new Zc,t.initialUser,this.serializer)}Ga(t){return new Qc(Yc.Zr,this.serializer)}Wa(t){return new tl}terminate(){return x(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var dl=class n extends Sg{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}initialize(e){return x(this,null,function*(){yield cd(n.prototype,this,"initialize").call(this,e),yield this.Ja.initialize(this,e),yield mm(this.Ja.syncEngine),yield Co(this.Ja.remoteStore),yield this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}za(e){return lT(this.persistence,new Zc,e.initialUser,this.serializer)}ja(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new $p(r,e.asyncQueue,t)}Ha(e,t){let r=new op(t,this.persistence);return new ip(e.asyncQueue,r)}Ga(e){let t=om(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?kt.withCacheSize(this.cacheSizeBytes):kt.DEFAULT;return new rg(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,yT(),Tc(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new tl}},Ag=class n extends dl{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return x(this,null,function*(){yield cd(n.prototype,this,"initialize").call(this,e);let t=this.Ja.syncEngine;this.sharedClientState instanceof Hs&&(this.sharedClientState.syncEngine={no:wP.bind(null,t),ro:DP.bind(null,t),io:TP.bind(null,t),Qi:EP.bind(null,t),eo:_P.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.yi(r=>x(this,null,function*(){yield IP(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}Wa(e){let t=yT();if(!Hs.D(t))throw new P(A.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=om(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Hs(t,e.asyncQueue,r,e.clientId,e.initialUser)}},ym=(()=>{class n{initialize(t,r){return x(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>YE(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=mP.bind(null,this.syncEngine),yield mg(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new _g}()}createDatastore(t){let r=ga(t.databaseInfo.databaseId),i=function(s){return new lg(s)}(t.databaseInfo);return function(s,a,c,l){return new fg(s,a,c,l)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,o,s,a,c){return new gg(i,o,s,a,c)}(this.localStore,this.datastore,t.asyncQueue,r=>YE(this.syncEngine,r,0),function(){return nl.D()?new nl:new ug}())}createSyncEngine(t,r){return function(o,s,a,c,l,h,p){let m=new Cg(o,s,a,c,l,h);return p&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return x(this,null,function*(){var t,r;yield function(o){return x(this,null,function*(){let s=V(o);k("RemoteStore","RemoteStore shutting down."),s.L_.add(5),yield To(s),s.k_.shutdown(),s.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();function JE(n,e=10240){let t=0;return{read(){return x(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return x(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var _o=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Le("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var xg=class{constructor(e,t){this.Xa=e,this.serializer=t,this.metadata=new Ge,this.buffer=new Uint8Array,this.eu=function(){return new TextDecoder("utf-8")}(),this.tu().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.aa)}`))},r=>this.metadata.reject(r))}close(){return this.Xa.cancel()}getMetadata(){return x(this,null,function*(){return this.metadata.promise})}Ua(){return x(this,null,function*(){return yield this.getMetadata(),this.tu()})}tu(){return x(this,null,function*(){let e=yield this.nu();if(e===null)return null;let t=this.eu.decode(e),r=Number(t);isNaN(r)&&this.ru(`length string (${t}) is not valid number`);let i=yield this.iu(r);return new Ig(JSON.parse(i),e.length+r)})}su(){return this.buffer.findIndex(e=>e===123)}nu(){return x(this,null,function*(){for(;this.su()<0&&!(yield this.ou()););if(this.buffer.length===0)return null;let e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}iu(e){return x(this,null,function*(){for(;this.buffer.length<e;)(yield this.ou())&&this.ru("Reached the end of bundle when more is expected.");let t=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}ou(){return x(this,null,function*(){let e=yield this.Xa.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var Mg=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return x(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new P(A.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,o){return x(this,null,function*(){let s=V(i),a={documents:o.map(p=>ta(s.serializer,p))},c=yield s.Lo("BatchGetDocuments",s.serializer.databaseId,ce.emptyPath(),a,o.length),l=new Map;c.forEach(p=>{let m=MR(s.serializer,p);l.set(m.key.toString(),m)});let h=[];return o.forEach(p=>{let m=l.get(p.toString());H(!!m),h.push(m)}),h})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new mr(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return x(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=j.fromPath(r);this.mutations.push(new Ys(i,this.precondition(i)))}),yield function(r,i){return x(this,null,function*(){let o=V(r),s={writes:i.map(a=>na(o.serializer,a))};yield o.Mo("Commit",o.serializer.databaseId,ce.emptyPath(),s)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw U();t=q.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new P(A.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(q.min())?Fe.exists(!1):Fe.updateTime(t):Fe.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(q.min()))throw new P(A.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Fe.updateTime(t)}return Fe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var Ng=class{constructor(e,t,r,i,o){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=o,this._u=r.maxAttempts,this.t_=new sa(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(()=>x(this,null,function*(){let e=new Mg(this.datastore),t=this.cu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.lu(i)}))}).catch(r=>{this.lu(r)})}))}cu(e){try{let t=this.updateFunction(e);return!da(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!$D(t)}return!1}};var Rg=class{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=He.UNAUTHENTICATED,this.clientId=bc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,s=>x(this,null,function*(){k("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(k("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Ge;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>x(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=So(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Wf(n,e){return x(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),k("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>x(this,null,function*(){r.isEqual(i)||(yield dT(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function XE(n,e){return x(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield vm(n);k("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>WE(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>WE(e.remoteStore,i)),n._onlineComponents=e})}function vm(n){return x(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){k("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Wf(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===A.FAILED_PRECONDITION||i.code===A.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Kt("Error using user provided cache. Falling back to memory cache: "+t),yield Wf(n,new Sg)}}else k("FirestoreClient","Using default OfflineComponentProvider"),yield Wf(n,new Sg);return n._offlineComponents})}function bl(n){return x(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(k("FirestoreClient","Using user provided OnlineComponentProvider"),yield XE(n,n._uninitializedComponentsProvider._online)):(k("FirestoreClient","Using default OnlineComponentProvider"),yield XE(n,new ym))),n._onlineComponents})}function AT(n){return vm(n).then(e=>e.persistence)}function _m(n){return vm(n).then(e=>e.localStore)}function xT(n){return bl(n).then(e=>e.remoteStore)}function wm(n){return bl(n).then(e=>e.syncEngine)}function bP(n){return bl(n).then(e=>e.datastore)}function wo(n){return x(this,null,function*(){let e=yield bl(n),t=e.eventManager;return t.onListen=sP.bind(null,e.syncEngine),t.onUnlisten=uP.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=aP.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=cP.bind(null,e.syncEngine),t})}function SP(n){return n.asyncQueue.enqueue(()=>x(this,null,function*(){let e=yield AT(n),t=yield xT(n);return e.setNetworkEnabled(!0),function(i){let o=V(i);return o.L_.delete(0),ma(o)}(t)}))}function AP(n){return n.asyncQueue.enqueue(()=>x(this,null,function*(){let e=yield AT(n),t=yield xT(n);return e.setNetworkEnabled(!1),function(i){return x(this,null,function*(){let o=V(i);o.L_.add(0),yield To(o),o.q_.set("Offline")})}(t)}))}function xP(n,e){let t=new Ge;return n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(i,o,s){return x(this,null,function*(){try{let a=yield function(l,h){let p=V(l);return p.persistence.runTransaction("read document","readonly",m=>p.localDocuments.getDocument(m,h))}(i,o);a.isFoundDocument()?s.resolve(a):a.isNoDocument()?s.resolve(null):s.reject(new P(A.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=So(a,`Failed to get document '${o} from cache`);s.reject(c)}})}(yield _m(n),e,t)})),t.promise}function MT(n,e,t={}){let r=new Ge;return n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(o,s,a,c,l){let h=new _o({next:m=>{h.Za(),s.enqueueAndForget(()=>lm(o,p));let v=m.docs.has(a);!v&&m.fromCache?l.reject(new P(A.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&m.fromCache&&c&&c.source==="server"?l.reject(new P(A.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new aa(Do(a.path),h,{includeMetadataChanges:!0,_a:!0});return cm(o,p)}(yield wo(n),n.asyncQueue,e,t,r)})),r.promise}function MP(n,e){let t=new Ge;return n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(i,o,s){return x(this,null,function*(){try{let a=yield Jc(i,o,!0),c=new ll(o,a.Ts),l=c.ma(a.documents),h=c.applyChanges(l,!1);s.resolve(h.snapshot)}catch(a){let c=So(a,`Failed to execute query '${o} against cache`);s.reject(c)}})}(yield _m(n),e,t)})),t.promise}function NT(n,e,t={}){let r=new Ge;return n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(o,s,a,c,l){let h=new _o({next:m=>{h.Za(),s.enqueueAndForget(()=>lm(o,p)),m.fromCache&&c.source==="server"?l.reject(new P(A.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new aa(a,h,{includeMetadataChanges:!0,_a:!0});return cm(o,p)}(yield wo(n),n.asyncQueue,e,t,r)})),r.promise}function NP(n,e){let t=new _o(e);return n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(i,o){V(i).Y_.add(o),o.next()}(yield wo(n),t)})),()=>{t.Za(),n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(i,o){V(i).Y_.delete(o)}(yield wo(n),t)}))}}function RP(n,e,t,r){let i=function(s,a){let c;return c=typeof s=="string"?qD().encode(s):s,function(h,p){return new xg(h,p)}(function(h,p){if(h instanceof Uint8Array)return JE(h,p);if(h instanceof ArrayBuffer)return JE(new Uint8Array(h),p);if(h instanceof ReadableStream)return h.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(t,ga(e));n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){CP(yield wm(n),i,r)}))}function PP(n,e){return n.asyncQueue.enqueue(()=>x(this,null,function*(){return function(r,i){let o=V(r);return o.persistence.runTransaction("Get named query","readonly",s=>o.Gr.getNamedQuery(s,i))}(yield _m(n),e)}))}function RT(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var eD=new Map;function Im(n,e,t){if(!t)throw new P(A.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Em(n,e,t,r){if(e===!0&&r===!0)throw new P(A.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function tD(n){if(!j.isDocumentKey(n))throw new P(A.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function nD(n){if(j.isDocumentKey(n))throw new P(A.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Sl(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":U()}function le(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new P(A.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Sl(n);throw new P(A.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function PT(n,e){if(e<=0)throw new P(A.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var hl=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new P(A.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new P(A.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Em("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=RT((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new P(A.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new P(A.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new P(A.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},ni=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new hl({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new P(A.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new P(A.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new hl(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Kf;switch(r.type){case"firstParty":return new Jf(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new P(A.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return x(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=eD.get(t);r&&(k("ComponentProvider","Removing Datastore"),eD.delete(t),r.terminate())}(this),Promise.resolve()}};function kT(n,e,t,r={}){var i;let o=(n=le(n,ni))._getSettings(),s=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==s&&Kt("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:s,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=He.MOCK_USER;else{a=Qy(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new P(A.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new He(l)}n._authCredentials=new Qf(new Cc(a,c))}}var Je=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},be=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new hn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},hn=class n extends Je{constructor(e,t,r){super(e,t,Do(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new be(this.firestore,null,new j(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Dm(n,e,...t){if(n=Ne(n),Im("collection","path",e),n instanceof ni){let r=ce.fromString(e,...t);return nD(r),new hn(n,null,r)}{if(!(n instanceof be||n instanceof hn))throw new P(A.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ce.fromString(e,...t));return nD(r),new hn(n.firestore,null,r)}}function OT(n,e){if(n=le(n,ni),Im("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new P(A.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Je(n,null,function(r){return new Qt(ce.emptyPath(),r)}(e))}function ya(n,e,...t){if(n=Ne(n),arguments.length===1&&(e=bc.newId()),Im("doc","path",e),n instanceof ni){let r=ce.fromString(e,...t);return tD(r),new be(n,null,new j(r))}{if(!(n instanceof be||n instanceof hn))throw new P(A.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ce.fromString(e,...t));return tD(r),new be(n.firestore,n instanceof hn?n.converter:null,new j(r))}}function Tm(n,e){return n=Ne(n),e=Ne(e),(n instanceof be||n instanceof hn)&&(e instanceof be||e instanceof hn)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function Cm(n,e){return n=Ne(n),e=Ne(e),n instanceof Je&&e instanceof Je&&n.firestore===e.firestore&&fa(n._query,e._query)&&n.converter===e.converter}var fl=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new sa(this,"async_queue_retry"),this.Vu=()=>{let r=Tc();r&&k("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;let t=Tc();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let t=Tc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let t=new Ge;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return x(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!_r(e))throw e;k("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;let i=function(s){let a=s.message||"";return s.stack&&(a=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),a}(r);throw Le("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);let i=yg.createAndSchedule(this,e,t,r,o=>this.yu(o));return this.Tu.push(i),i}fu(){this.Eu&&U()}verifyOperationInProgress(){}wu(){return x(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let t=this.Tu.indexOf(e);this.Tu.splice(t,1)}};function Pg(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(n,["next","error","complete"])}var kg=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new Ge,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var FT=-1,Pe=class extends ni{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new fl,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return x(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new fl(e),this._firestoreClient=void 0,yield e}})}};function Xe(n){if(n._terminated)throw new P(A.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||LT(n),n._firestoreClient}function LT(n){var e,t,r;let i=n._freezeSettings(),o=function(a,c,l,h){return new sp(a,c,l,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,RT(h.experimentalLongPollingOptions),h.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new Rg(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&function(a){let c=a?._online.build();return{_offline:a?._offline.build(c),_online:c}}(n._componentsProvider))}function VT(n,e){Kt("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings();return BT(n,ym.provider,{build:r=>new dl(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function jT(n){return x(this,null,function*(){Kt("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let e=n._freezeSettings();BT(n,ym.provider,{build:t=>new Ag(t,e.cacheSizeBytes)})})}function BT(n,e,t){if((n=le(n,Pe))._firestoreClient||n._terminated)throw new P(A.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new P(A.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},LT(n)}function UT(n){if(n._initialized&&!n._terminated)throw new P(A.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new Ge;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>x(this,null,function*(){try{yield function(r){return x(this,null,function*(){if(!cr.D())return Promise.resolve();let i=r+"main";yield cr.delete(i)})}(om(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function $T(n){return function(t){let r=new Ge;return t.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return pP(yield wm(t),r)})),r.promise}(Xe(n=le(n,Pe)))}function HT(n){return SP(Xe(n=le(n,Pe)))}function qT(n){return AP(Xe(n=le(n,Pe)))}function zT(n,e){let t=Xe(n=le(n,Pe)),r=new kg;return RP(t,n._databaseId,e,r),r}function GT(n,e){return PP(Xe(n=le(n,Pe)),e).then(t=>t?new Je(n,null,t.query):null)}var mn=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Be.fromBase64String(e))}catch(t){throw new P(A.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Be.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Zt=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new P(A.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ve(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Ln=class{constructor(e){this._methodName=e}};var ri=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new P(A.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new P(A.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Z(this._lat,e._lat)||Z(this._long,e._long)}};var ua=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}};var kP=/^__.*__$/,Og=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Yt(e,this.data,this.fieldMask,t,this.fieldTransforms):new gr(e,this.data,t,this.fieldTransforms)}},pl=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Yt(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function WT(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw U()}}var gl=class n{constructor(e,t,r,i,o,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.vu(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return ml(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(WT(this.Cu)&&kP.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},Fg=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||ga(e)}Qu(e,t,r,i=!1){return new gl({Cu:e,methodName:t,qu:r,path:Ve.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function ai(n){let e=n._freezeSettings(),t=ga(n._databaseId);return new Fg(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Al(n,e,t,r,i,o={}){let s=n.Qu(o.merge||o.mergeFields?2:0,e,t,i);Am("Data must be an object, but it was:",s,r);let a=YT(r,s),c,l;if(o.merge)c=new St(s.fieldMask),l=s.fieldTransforms;else if(o.mergeFields){let h=[];for(let p of o.mergeFields){let m=Ug(e,p,t);if(!s.contains(m))throw new P(A.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);JT(h,m)||h.push(m)}c=new St(h),l=s.fieldTransforms.filter(p=>c.covers(p.field))}else c=null,l=s.fieldTransforms;return new Og(new st(a),c,l)}var ca=class n extends Ln{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function KT(n,e,t){return new gl({Cu:3,qu:e.settings.qu,methodName:n._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var Lg=class n extends Ln{_toFieldTransform(e){return new Xr(e.path,new fr)}isEqual(e){return e instanceof n}},Vg=class n extends Ln{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){let t=KT(this,e,!0),r=this.Ku.map(o=>ui(o,t)),i=new On(r);return new Xr(e.path,i)}isEqual(e){return e instanceof n&&hd(this.Ku,e.Ku)}},jg=class n extends Ln{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){let t=KT(this,e,!0),r=this.Ku.map(o=>ui(o,t)),i=new Fn(r);return new Xr(e.path,i)}isEqual(e){return e instanceof n&&hd(this.Ku,e.Ku)}},Bg=class n extends Ln{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){let t=new pr(e.serializer,OD(e.serializer,this.$u));return new Xr(e.path,t)}isEqual(e){return e instanceof n&&this.$u===e.$u}};function bm(n,e,t,r){let i=n.Qu(1,e,t);Am("Data must be an object, but it was:",i,r);let o=[],s=st.empty();si(r,(c,l)=>{let h=xm(e,c,t);l=Ne(l);let p=i.Nu(h);if(l instanceof ca)o.push(h);else{let m=ui(l,p);m!=null&&(o.push(h),s.set(h,m))}});let a=new St(o);return new pl(s,a,i.fieldTransforms)}function Sm(n,e,t,r,i,o){let s=n.Qu(1,e,t),a=[Ug(e,r,t)],c=[i];if(o.length%2!=0)throw new P(A.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<o.length;m+=2)a.push(Ug(e,o[m])),c.push(o[m+1]);let l=[],h=st.empty();for(let m=a.length-1;m>=0;--m)if(!JT(l,a[m])){let v=a[m],M=c[m];M=Ne(M);let N=s.Nu(v);if(M instanceof ca)l.push(v);else{let R=ui(M,N);R!=null&&(l.push(v),h.set(v,R))}}let p=new St(l);return new pl(h,p,s.fieldTransforms)}function QT(n,e,t,r=!1){return ui(t,n.Qu(r?4:3,e))}function ui(n,e){if(ZT(n=Ne(n)))return Am("Unsupported field value:",e,n),YT(n,e);if(n instanceof Ln)return function(r,i){if(!WT(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){let o=[],s=0;for(let a of r){let c=ui(a,i.Lu(s));c==null&&(c={nullValue:"NULL_VALUE"}),o.push(c),s++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=Ne(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return OD(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=Re.fromDate(r);return{timestampValue:lo(i.serializer,o)}}if(r instanceof Re){let o=new Re(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:lo(i.serializer,o)}}if(r instanceof ri)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof mn)return{bytesValue:zD(i.serializer,r._byteString)};if(r instanceof be){let o=i.databaseId,s=r.firestore._databaseId;if(!s.isEqual(o))throw i.Bu(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:nm(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof ua)return function(s,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:s.toArray().map(c=>{if(typeof c!="number")throw a.Bu("VectorValues must only contain numeric values.");return tm(a.serializer,c)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${Sl(r)}`)}(n,e)}function YT(n,e){let t={};return yD(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):si(n,(r,i)=>{let o=ui(i,e.Mu(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function ZT(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Re||n instanceof ri||n instanceof mn||n instanceof be||n instanceof Ln||n instanceof ua)}function Am(n,e,t){if(!ZT(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Sl(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function Ug(n,e,t){if((e=Ne(e))instanceof Zt)return e._internalPath;if(typeof e=="string")return xm(n,e);throw ml("Field path arguments must be of type string or ",n,!1,void 0,t)}var OP=new RegExp("[~\\*/\\[\\]]");function xm(n,e,t){if(e.search(OP)>=0)throw ml(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Zt(...e.split("."))._internalPath}catch{throw ml(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function ml(n,e,t,r,i){let o=r&&!r.isEmpty(),s=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=` in field ${r}`),s&&(c+=` in document ${i}`),c+=")"),new P(A.INVALID_ARGUMENT,a+n+c)}function JT(n,e){return n.some(t=>t.isEqual(e))}var ii=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new be(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new $g(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(xl("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},$g=class extends ii{data(){return super.data()}};function xl(n,e){return typeof e=="string"?xm(n,e):e instanceof Zt?e._internalPath:e._delegate._internalPath}function XT(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new P(A.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var la=class{},oi=class extends la{};function Bn(n,e,...t){let r=[];e instanceof la&&r.push(e),r=r.concat(t),function(o){let s=o.filter(c=>c instanceof Hg).length,a=o.filter(c=>c instanceof yl).length;if(s>1||s>0&&a>0)throw new P(A.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var yl=class n extends oi{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return c0(e._query,t),new Je(e.firestore,e.converter,_p(e._query,t))}_parse(e){let t=ai(e.firestore);return function(o,s,a,c,l,h,p){let m;if(l.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new P(A.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){iD(p,h);let v=[];for(let M of p)v.push(rD(c,o,M));m={arrayValue:{values:v}}}else m=rD(c,o,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||iD(p,h),m=QT(a,s,p,h==="in"||h==="not-in");return se.create(l,h,m)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function e0(n,e,t){let r=e,i=xl("where",n);return yl._create(i,r,t)}var Hg=class n extends la{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:ve.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,o){let s=i,a=o.getFlattenedFilters();for(let c of a)c0(s,c),s=_p(s,c)}(e._query,t),new Je(e.firestore,e.converter,_p(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var qg=class n extends oi{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,o,s){if(i.startAt!==null)throw new P(A.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new P(A.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Zr(o,s)}(e._query,this._field,this._direction);return new Je(e.firestore,e.converter,function(i,o){let s=i.explicitOrderBy.concat([o]);return new Qt(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function t0(n,e="asc"){let t=e,r=xl("orderBy",n);return qg._create(r,t)}var vl=class n extends oi{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new Je(e.firestore,e.converter,Fc(e._query,this._limit,this._limitType))}};function n0(n){return PT("limit",n),vl._create("limit",n,"F")}function r0(n){return PT("limitToLast",n),vl._create("limitToLast",n,"L")}var _l=class n extends oi{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=u0(e,this.type,this._docOrFields,this._inclusive);return new Je(e.firestore,e.converter,function(i,o){return new Qt(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,o,i.endAt)}(e._query,t))}};function i0(...n){return _l._create("startAt",n,!0)}function o0(...n){return _l._create("startAfter",n,!1)}var wl=class n extends oi{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=u0(e,this.type,this._docOrFields,this._inclusive);return new Je(e.firestore,e.converter,function(i,o){return new Qt(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,o)}(e._query,t))}};function s0(...n){return wl._create("endBefore",n,!1)}function a0(...n){return wl._create("endAt",n,!0)}function u0(n,e,t,r){if(t[0]=Ne(t[0]),t[0]instanceof ii)return function(o,s,a,c,l){if(!c)throw new P(A.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let h=[];for(let p of no(o))if(p.field.isKeyField())h.push(Yr(s,c.key));else{let m=c.data.field(p.field);if(El(m))throw new P(A.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){let v=p.field.canonicalString();throw new P(A.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${v}' (used as the orderBy) does not exist.`)}h.push(m)}return new pn(h,l)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=ai(n.firestore);return function(s,a,c,l,h,p){let m=s.explicitOrderBy;if(h.length>m.length)throw new P(A.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let v=[];for(let M=0;M<h.length;M++){let N=h[M];if(m[M].field.isKeyField()){if(typeof N!="string")throw new P(A.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof N}`);if(!Xg(s)&&N.indexOf("/")!==-1)throw new P(A.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${N}' contains a slash.`);let R=s.path.child(ce.fromString(N));if(!j.isDocumentKey(R))throw new P(A.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${R}' is not because it contains an odd number of segments.`);let B=new j(R);v.push(Yr(a,B))}else{let R=QT(c,l,N);v.push(R)}}return new pn(v,p)}(n._query,n.firestore._databaseId,i,e,t,r)}}function rD(n,e,t){if(typeof(t=Ne(t))=="string"){if(t==="")throw new P(A.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Xg(e)&&t.indexOf("/")!==-1)throw new P(A.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(ce.fromString(t));if(!j.isDocumentKey(r))throw new P(A.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Yr(n,new j(r))}if(t instanceof be)return Yr(n,t._key);throw new P(A.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Sl(t)}.`)}function iD(n,e){if(!Array.isArray(n)||n.length===0)throw new P(A.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function c0(n,e){let t=function(i,o){for(let s of i)for(let a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new P(A.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new P(A.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Io=class{convertValue(e,t="none"){switch(Qr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Me(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(lr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw U()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return si(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;let o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(s=>Me(s.doubleValue));return new ua(o)}convertGeoPoint(e){return new ri(Me(e.latitude),Me(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Zg(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Ws(e));default:return null}}convertTimestamp(e){let t=kn(e);return new Re(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=ce.fromString(e);H(nT(r));let i=new dr(r.get(1),r.get(3)),o=new j(r.popFirst(5));return i.isEqual(t)||Le(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function Ml(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var zg=class extends Io{constructor(e){super(),this.firestore=e}convertBytes(e){return new mn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new be(this.firestore,null,t)}};var Pn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Ft=class extends ii{constructor(e,t,r,i,o,s){super(e,t,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new ar(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(xl("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},ar=class extends Ft{data(e={}){return super.data(e)}},Jt=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Pn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new ar(this._firestore,this._userDataWriter,r.key,r,new Pn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new P(A.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(a=>{let c=new ar(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Pn(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{let c=new ar(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Pn(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,h=-1;return a.type!==0&&(l=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),h=s.indexOf(a.doc.key)),{type:FP(a.type),doc:c,oldIndex:l,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function FP(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return U()}}function Mm(n,e){return n instanceof Ft&&e instanceof Ft?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Jt&&e instanceof Jt&&n._firestore===e._firestore&&Cm(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function l0(n){n=le(n,be);let e=le(n.firestore,Pe);return MT(Xe(e),n._key).then(t=>km(e,n,t))}var Vn=class extends Io{constructor(e){super(),this.firestore=e}convertBytes(e){return new mn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new be(this.firestore,null,t)}};function d0(n){n=le(n,be);let e=le(n.firestore,Pe),t=Xe(e),r=new Vn(e);return xP(t,n._key).then(i=>new Ft(e,r,n._key,i,new Pn(i!==null&&i.hasLocalMutations,!0),n.converter))}function h0(n){n=le(n,be);let e=le(n.firestore,Pe);return MT(Xe(e),n._key,{source:"server"}).then(t=>km(e,n,t))}function f0(n){n=le(n,Je);let e=le(n.firestore,Pe),t=Xe(e),r=new Vn(e);return XT(n._query),NT(t,n._query).then(i=>new Jt(e,r,n,i))}function p0(n){n=le(n,Je);let e=le(n.firestore,Pe),t=Xe(e),r=new Vn(e);return MP(t,n._query).then(i=>new Jt(e,r,n,i))}function g0(n){n=le(n,Je);let e=le(n.firestore,Pe),t=Xe(e),r=new Vn(e);return NT(t,n._query,{source:"server"}).then(i=>new Jt(e,r,n,i))}function Nm(n,e,t){n=le(n,be);let r=le(n.firestore,Pe),i=Ml(n.converter,e,t);return Ao(r,[Al(ai(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Fe.none())])}function Rm(n,e,t,...r){n=le(n,be);let i=le(n.firestore,Pe),o=ai(i),s;return s=typeof(e=Ne(e))=="string"||e instanceof Zt?Sm(o,"updateDoc",n._key,e,t,r):bm(o,"updateDoc",n._key,e),Ao(i,[s.toMutation(n._key,Fe.exists(!0))])}function m0(n){return Ao(le(n.firestore,Pe),[new mr(n._key,Fe.none())])}function y0(n,e){let t=le(n.firestore,Pe),r=ya(n),i=Ml(n.converter,e);return Ao(t,[Al(ai(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Fe.exists(!1))]).then(()=>r)}function Pm(n,...e){var t,r,i;n=Ne(n);let o={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||Pg(e[s])||(o=e[s],s++);let a={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(Pg(e[s])){let p=e[s];e[s]=(t=p.next)===null||t===void 0?void 0:t.bind(p),e[s+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[s+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let c,l,h;if(n instanceof be)l=le(n.firestore,Pe),h=Do(n._key.path),c={next:p=>{e[s]&&e[s](km(l,n,p))},error:e[s+1],complete:e[s+2]};else{let p=le(n,Je);l=le(p.firestore,Pe),h=p._query;let m=new Vn(l);c={next:v=>{e[s]&&e[s](new Jt(l,m,p,v))},error:e[s+1],complete:e[s+2]},XT(n._query)}return function(m,v,M,N){let R=new _o(N),B=new aa(v,R,M);return m.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return cm(yield wo(m),B)})),()=>{R.Za(),m.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return lm(yield wo(m),B)}))}}(Xe(l),h,a,c)}function v0(n,e){return NP(Xe(n=le(n,Pe)),Pg(e)?e:{next:e})}function Ao(n,e){return function(r,i){let o=new Ge;return r.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return lP(yield wm(r),i,o)})),o.promise}(Xe(n),e)}function km(n,e,t){let r=t.docs.get(e._key),i=new Vn(n);return new Ft(n,i,e._key,r,new Pn(t.hasPendingWrites,t.fromCache),e.converter)}var LP={maxAttempts:5};var Il=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=ai(e)}set(e,t,r){this._verifyNotCommitted();let i=or(e,this._firestore),o=Ml(i.converter,t,r),s=Al(this._dataReader,"WriteBatch.set",i._key,o,i.converter!==null,r);return this._mutations.push(s.toMutation(i._key,Fe.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let o=or(e,this._firestore),s;return s=typeof(t=Ne(t))=="string"||t instanceof Zt?Sm(this._dataReader,"WriteBatch.update",o._key,t,r,i):bm(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(s.toMutation(o._key,Fe.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=or(e,this._firestore);return this._mutations=this._mutations.concat(new mr(t._key,Fe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new P(A.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function or(n,e){if((n=Ne(n)).firestore!==e)throw new P(A.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var Gg=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=ai(t)}get(t){let r=or(t,this._firestore),i=new zg(this._firestore);return this._transaction.lookup([r._key]).then(o=>{if(!o||o.length!==1)return U();let s=o[0];if(s.isFoundDocument())return new ii(this._firestore,i,s.key,s,r.converter);if(s.isNoDocument())return new ii(this._firestore,i,r._key,null,r.converter);throw U()})}set(t,r,i){let o=or(t,this._firestore),s=Ml(o.converter,r,i),a=Al(this._dataReader,"Transaction.set",o._key,s,o.converter!==null,i);return this._transaction.set(o._key,a),this}update(t,r,i,...o){let s=or(t,this._firestore),a;return a=typeof(r=Ne(r))=="string"||r instanceof Zt?Sm(this._dataReader,"Transaction.update",s._key,r,i,o):bm(this._dataReader,"Transaction.update",s._key,r),this._transaction.update(s._key,a),this}delete(t){let r=or(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=or(e,this._firestore),r=new Vn(this._firestore);return super.get(e).then(i=>new Ft(this._firestore,r,t._key,i._document,new Pn(!1,!1),t.converter))}};function _0(n,e,t){n=le(n,Pe);let r=Object.assign(Object.assign({},LP),t);return function(o){if(o.maxAttempts<1)throw new P(A.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(o,s,a){let c=new Ge;return o.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){let l=yield bP(o);new Ng(o.asyncQueue,l,a,s,c).au()})),c.promise}(Xe(n),i=>e(new Gg(n,i)),r)}function w0(){return new ca("deleteField")}function I0(){return new Lg("serverTimestamp")}function E0(...n){return new Vg("arrayUnion",n)}function D0(...n){return new jg("arrayRemove",n)}function T0(n){return new Bg("increment",n)}(function(e,t=!0){(function(i){Eo=i})(Jy),Jo(new Cr("firestore",(r,{instanceIdentifier:i,options:o})=>{let s=r.getProvider("app").getImmediate(),a=new Pe(new Yf(r.getProvider("auth-internal")),new ep(r.getProvider("app-check-internal")),function(l,h){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new P(A.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new dr(l.options.projectId,h)}(s,i),s);return o=Object.assign({useFetchStreams:t},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),zn(nE,"4.7.3",e),zn(nE,"4.7.3","esm2017")})();var VP="@firebase/firestore-compat",jP="0.3.38";function Bm(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new P("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function C0(){if(typeof Uint8Array>"u")throw new P("unimplemented","Uint8Arrays are not available in this environment.")}function b0(){if(!vD())throw new P("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Nl=class n{constructor(e){this._delegate=e}static fromBase64String(e){return b0(),new n(mn.fromBase64String(e))}static fromUint8Array(e){return C0(),new n(mn.fromUint8Array(e))}toBase64(){return b0(),this._delegate.toBase64()}toUint8Array(){return C0(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function Om(n){return BP(n,["next","error","complete"])}function BP(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var Fm=class{enableIndexedDbPersistence(e,t){return VT(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return jT(e._delegate)}clearIndexedDbPersistence(e){return UT(e._delegate)}},Rl=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof dr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Kt("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){kT(this._delegate,e,t,r)}enableNetwork(){return HT(this._delegate)}disableNetwork(){return qT(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,Em("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return $T(this._delegate)}onSnapshotsInSync(e){return v0(this._delegate,e)}get app(){if(!this._appCompat)throw new P("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new No(this,Dm(this._delegate,e))}catch(t){throw pt(t,"collection()","Firestore.collection()")}}doc(e){try{return new yn(this,ya(this._delegate,e))}catch(t){throw pt(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new hi(this,OT(this._delegate,e))}catch(t){throw pt(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return _0(this._delegate,t=>e(new Pl(this,t)))}batch(){return Xe(this._delegate),new kl(new Il(this._delegate,e=>Ao(this._delegate,e)))}loadBundle(e){return zT(this._delegate,e)}namedQuery(e){return GT(this._delegate,e).then(t=>t?new hi(this,t):null)}},xo=class extends Io{constructor(e){super(),this.firestore=e}convertBytes(e){return new Nl(new mn(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return yn.forKey(t,this.firestore,null)}};function UP(n){oD(n)}var Pl=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new xo(e)}get(e){let t=ci(e);return this._delegate.get(t).then(r=>new li(this._firestore,new Ft(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=ci(e);return r?(Bm("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let o=ci(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,r,...i),this}delete(e){let t=ci(e);return this._delegate.delete(t),this}},kl=class{constructor(e){this._delegate=e}set(e,t,r){let i=ci(e);return r?(Bm("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let o=ci(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,r,...i),this}delete(e){let t=ci(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},Mo=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new ar(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new di(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let o=i.get(t);return o||(o=new n(e,new xo(e),t),i.set(t,o)),o}};Mo.INSTANCES=new WeakMap;var yn=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new xo(e)}static forPath(e,t,r){if(e.length%2!==0)throw new P("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new be(t._delegate,r,new j(e)))}static forKey(e,t,r){return new n(t,new be(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new No(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new No(this.firestore,Dm(this._delegate,e))}catch(t){throw pt(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Ne(e),e instanceof be?Tm(this._delegate,e):!1}set(e,t){t=Bm("DocumentReference.set",t);try{return t?Nm(this._delegate,e,t):Nm(this._delegate,e)}catch(r){throw pt(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?Rm(this._delegate,e):Rm(this._delegate,e,t,...r)}catch(i){throw pt(i,"updateDoc()","DocumentReference.update()")}}delete(){return m0(this._delegate)}onSnapshot(...e){let t=S0(e),r=A0(e,i=>new li(this.firestore,new Ft(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return Pm(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=d0(this._delegate):e?.source==="server"?t=h0(this._delegate):t=l0(this._delegate),t.then(r=>new li(this.firestore,new Ft(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Mo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function pt(n,e,t){return n.message=n.message.replace(e,t),n}function S0(n){for(let e of n)if(typeof e=="object"&&!Om(e))return e;return{}}function A0(n,e){var t,r;let i;return Om(n[0])?i=n[0]:Om(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:o=>{i.next&&i.next(e(o))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var li=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new yn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Mm(this._delegate,e._delegate)}},di=class extends li{data(e){let t=this._delegate.data(e);return this._delegate._converter||sD(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},hi=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new xo(e)}where(e,t,r){try{return new n(this.firestore,Bn(this._delegate,e0(e,t,r)))}catch(i){throw pt(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,Bn(this._delegate,t0(e,t)))}catch(r){throw pt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,Bn(this._delegate,n0(e)))}catch(t){throw pt(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,Bn(this._delegate,r0(e)))}catch(t){throw pt(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,Bn(this._delegate,i0(...e)))}catch(t){throw pt(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,Bn(this._delegate,o0(...e)))}catch(t){throw pt(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,Bn(this._delegate,s0(...e)))}catch(t){throw pt(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,Bn(this._delegate,a0(...e)))}catch(t){throw pt(t,"endAt()","Query.endAt()")}}isEqual(e){return Cm(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=p0(this._delegate):e?.source==="server"?t=g0(this._delegate):t=f0(this._delegate),t.then(r=>new va(this.firestore,new Jt(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=S0(e),r=A0(e,i=>new va(this.firestore,new Jt(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return Pm(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Mo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},Lm=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new di(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},va=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new hi(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new di(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new Lm(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new di(this._firestore,r))})}isEqual(e){return Mm(this._delegate,e._delegate)}},No=class n extends hi{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new yn(this.firestore,e):null}doc(e){try{return e===void 0?new yn(this.firestore,ya(this._delegate)):new yn(this.firestore,ya(this._delegate,e))}catch(t){throw pt(t,"doc()","CollectionReference.doc()")}}add(e){return y0(this._delegate,e).then(t=>new yn(this.firestore,t))}isEqual(e){return Tm(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Mo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function ci(n){return le(n,be)}var Vm=class n{constructor(...e){this._delegate=new Zt(...e)}static documentId(){return new n(Ve.keyField().canonicalString())}isEqual(e){return e=Ne(e),e instanceof Zt?this._delegate._internalPath.isEqual(e._internalPath):!1}};var jm=class n{constructor(e){this._delegate=e}static serverTimestamp(){let e=I0();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=w0();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=E0(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=D0(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=T0(e);return t._methodName="FieldValue.increment",new n(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var $P={Firestore:Rl,GeoPoint:ri,Timestamp:Re,Blob:Nl,Transaction:Pl,WriteBatch:kl,DocumentReference:yn,DocumentSnapshot:li,Query:hi,QueryDocumentSnapshot:di,QuerySnapshot:va,CollectionReference:No,FieldPath:Vm,FieldValue:jm,setLogLevel:UP,CACHE_SIZE_UNLIMITED:FT};function HP(n,e){n.INTERNAL.registerComponent(new Cr("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},$P)))}function qP(n){HP(n,(e,t)=>new Rl(e,t,new Fm)),n.registerVersion(VP,jP)}qP(Et);function zP(n,e=ns){return new Ae(t=>{let r;return e!=null?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}function x0(n,e){return zP(n,e)}function GP(n,e){return x0(n,e).pipe(os(void 0),rs(),Ce(t=>{let[r,i]=t;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function Hm(n,e){return x0(n,e).pipe(Ce(t=>({payload:t,type:"query"})))}var Ol=class{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let r=this.ref.collection(e),{ref:i,query:o}=R0(r,t);return new Ll(i,o,this.afs)}snapshotChanges(){return GP(this.ref,this.afs.schedulers.outsideAngular).pipe(yt)}valueChanges(e={}){return this.snapshotChanges().pipe(Ce(({payload:t})=>e.idField?It(De({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return ct(this.ref.get(e)).pipe(yt)}};function Fl(n,e){return Hm(n,e).pipe(os(void 0),rs(),Ce(t=>{let[r,i]=t,o=i.payload.docChanges(),s=o.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,c)=>{let l=o.find(p=>p.doc.ref.isEqual(a.ref)),h=r?.payload.docs.find(p=>p.ref.isEqual(a.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(a.metadata)||!l&&h&&JSON.stringify(h.metadata)===JSON.stringify(a.metadata)||s.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:a}})}),s}))}function M0(n,e,t){return Fl(n,t).pipe(is((r,i)=>WP(r,i.map(o=>o.payload),e),[]),Pd(),Ce(r=>r.map(i=>({type:i.type,payload:i}))))}function WP(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=KP(n,r))}),n}function Um(n,e,t,...r){let i=n.slice();return i.splice(e,t,...r),i}function KP(n,e){switch(e.type){case"added":if(!(n[e.newIndex]&&n[e.newIndex].doc.ref.isEqual(e.doc.ref)))return Um(n,e.newIndex,0,e);break;case"modified":if(n[e.oldIndex]==null||n[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return Um(n,e.newIndex,1,e);break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Um(n,e.oldIndex,1);break}return n}function N0(n){return(!n||n.length===0)&&(n=["added","removed","modified"]),n}var Ll=class{ref;query;afs;constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=Fl(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(Ce(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(os(void 0),rs(),Wn(([r,i])=>i.length>0||!r),Ce(([,r])=>r),yt)}auditTrail(e){return this.stateChanges(e).pipe(is((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=N0(e);return M0(this.query,t,this.afs.schedulers.outsideAngular).pipe(yt)}valueChanges(e={}){return Hm(this.query,this.afs.schedulers.outsideAngular).pipe(Ce(t=>t.payload.docs.map(r=>e.idField?It(De({},r.data()),{[e.idField]:r.id}):r.data())),yt)}get(e){return ct(this.query.get(e)).pipe(yt)}add(e){return this.ref.add(e)}doc(e){return new Ol(this.ref.doc(e),this.afs)}},$m=class{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?Fl(this.query,this.afs.schedulers.outsideAngular).pipe(yt):Fl(this.query,this.afs.schedulers.outsideAngular).pipe(Ce(t=>t.filter(r=>e.indexOf(r.type)>-1)),Wn(t=>t.length>0),yt)}auditTrail(e){return this.stateChanges(e).pipe(is((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=N0(e);return M0(this.query,t,this.afs.schedulers.outsideAngular).pipe(yt)}valueChanges(e={}){return Hm(this.query,this.afs.schedulers.outsideAngular).pipe(Ce(r=>r.payload.docs.map(i=>e.idField?De({[e.idField]:i.id},i.data()):i.data())),yt)}get(e){return ct(this.query.get(e)).pipe(yt)}},QP=new K("angularfire2.enableFirestorePersistence"),YP=new K("angularfire2.firestore.persistenceSettings"),ZP=new K("angularfire2.firestore.settings"),JP=new K("angularfire2.firestore.use-emulator");function R0(n,e=t=>t){return{query:e(n),ref:n}}var _t=(()=>{class n{schedulers;firestore;persistenceEnabled$;constructor(t,r,i,o,s,a,c,l,h,p,m,v,M,N,R,B,$){this.schedulers=c;let L=Ns(t,a,r),z=h;p&&Ff(L,a,m,M,N,R,v,B),[this.firestore,this.persistenceEnabled$]=fc(`${L.name}.firestore`,"AngularFirestore",L.name,()=>{let W=a.runOutsideAngular(()=>L.firestore());if(o&&W.settings(o),z&&W.useEmulator(...z),i&&!jr(s)){let G=()=>{try{return ct(W.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(I){return typeof console<"u"&&console.warn(I),En(!1)}};return[W,a.runOutsideAngular(G)]}else return[W,En(!1)]},[o,z,i])}collection(t,r){let i;typeof t=="string"?i=this.firestore.collection(t):i=t;let{ref:o,query:s}=R0(i,r),a=this.schedulers.ngZone.run(()=>o);return new Ll(a,s,this)}collectionGroup(t,r){let i=r||(s=>s),o=this.firestore.collectionGroup(t);return new $m(i(o),this)}doc(t){let r;typeof t=="string"?r=this.firestore.doc(t):r=t;let i=this.schedulers.ngZone.run(()=>r);return new Ol(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||n)(F($i),F(Hi,8),F(QP,8),F(ZP,8),F(Rt),F(fe),F(lc),F(YP,8),F(JP,8),F(XI,8),F(Mf,8),F(Nf,8),F(Rf,8),F(Pf,8),F(kf,8),F(Of,8),F(Br,8))};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();var P0=(()=>{class n{constructor(t){this.db=t,this.dbPath="/header",this.headerRef=t.collection(this.dbPath)}getHeader(){return this.headerRef}static{this.\u0275fac=function(r){return new(r||n)(F(_t))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var k0=(()=>{class n{constructor(t){this.headerService=t,this.header=null}ngOnInit(){this.headerService.getHeader().snapshotChanges().pipe(Ce(t=>t.map(r=>De({id:r.payload.doc.id},r.payload.doc.data())))).subscribe(t=>{this.header=t[0]||null,console.log("Header data:",this.header)})}static{this.\u0275fac=function(r){return new(r||n)(ze(P0))}}static{this.\u0275cmp=it({type:n,selectors:[["app-header"]],decls:15,vars:7,consts:[["width","200","height","200","alt","Mi Foto",3,"src"]],template:function(r,i){r&1&&(pe(0,"tr")(1,"td"),ne(2),J(3,"br"),ne(4),oe(),pe(5,"td"),J(6,"img",0)(7,"br"),ne(8),J(9,"br"),ne(10),J(11,"br"),ne(12),J(13,"br"),ne(14),oe()()),r&2&&(ee(2),_e(" ",i.header==null?null:i.header.name," "),ee(2),_e(" ",i.header==null?null:i.header.goalLife," "),ee(2),dt("src",i.header==null?null:i.header.photoUrl,Nw),ee(2),_e(" ",i.header==null?null:i.header.email,""),ee(2),_e(" ",i.header==null?null:i.header.phoneNumber,""),ee(2),_e(" ",i.header==null?null:i.header.location,""),ee(2),_e(" ",i.header==null?null:i.header.socialNetwork," "))}})}}return n})();var O0=(()=>{class n{constructor(t){this.db=t,this.accesoWorkExperience="work experience running...",this.dbPath="/work-experience",this.workExperienceRef=t.collection(this.dbPath)}getWorkExperience(){return this.workExperienceRef}static{this.\u0275fac=function(r){return new(r||n)(F(_t))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function n1(n,e){if(n&1&&(pe(0,"ul")(1,"li"),ne(2),pe(3,"i"),ne(4),oe(),J(5,"br"),pe(6,"b"),ne(7),oe(),J(8,"br"),ne(9),J(10,"br"),ne(11," Logros: "),J(12,"br"),ne(13),J(14,"br"),oe()()),n&2){let t=e.$implicit;ee(2),Ts(" ",t.startDate," - ",t.endDate," "),ee(2),mt(t.location),ee(3),mt(t.position),ee(2),_e(" ",t.company," "),ee(4),_e(" ",t.accomplishments," ")}}var F0=(()=>{class n{constructor(t){this.workExperienceService=t,this.workExperience=[],console.log(this.workExperienceService),this.workExperienceService.getWorkExperience().snapshotChanges().pipe(Ce(r=>r.map(i=>De({id:i.payload.doc.id},i.payload.doc.data())))).subscribe(r=>{this.workExperience=r,console.log(this.workExperience)})}static{this.\u0275fac=function(r){return new(r||n)(ze(O0))}}static{this.\u0275cmp=it({type:n,selectors:[["app-work-experience"]],decls:1,vars:1,consts:[[4,"ngFor","ngForOf"]],template:function(r,i){r&1&&Ct(0,n1,15,6,"ul",0),r&2&&dt("ngForOf",i.workExperience)},dependencies:[Pt]})}}return n})();var L0=(()=>{class n{constructor(t){this.db=t,this.dbPath="/skills",this.skillsRef=t.collection(this.dbPath)}getSkills(){return this.skillsRef}static{this.\u0275fac=function(r){return new(r||n)(F(_t))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function o1(n,e){if(n&1&&(pe(0,"li")(1,"strong"),ne(2),oe(),J(3,"br"),ne(4),J(5,"br"),ne(6),oe()),n&2){let t=e.$implicit;ee(2),mt(t.skillName),ee(2),_e(" Nivel: ",t.proficiency," "),ee(2),_e(" ",t.description," ")}}var V0=(()=>{class n{constructor(t){this.skillsService=t,this.skills=[],this.skillsService.getSkills().snapshotChanges().pipe(Ce(r=>r.map(i=>De({id:i.payload.doc.id},i.payload.doc.data())))).subscribe(r=>{this.skills=r,console.log("Skills:",this.skills)})}static{this.\u0275fac=function(r){return new(r||n)(ze(L0))}}static{this.\u0275cmp=it({type:n,selectors:[["app-skills"]],decls:2,vars:1,consts:[[4,"ngFor","ngForOf"]],template:function(r,i){r&1&&(pe(0,"ul"),Ct(1,o1,7,3,"li",0),oe()),r&2&&(ee(),dt("ngForOf",i.skills))},dependencies:[Pt]})}}return n})();var j0=(()=>{class n{constructor(t){this.db=t,this.dbPath="/education",this.educationRef=t.collection(this.dbPath)}getEducation(){return this.educationRef}static{this.\u0275fac=function(r){return new(r||n)(F(_t))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function u1(n,e){if(n&1&&(pe(0,"ul")(1,"li")(2,"strong"),ne(3),oe(),J(4,"br"),ne(5),J(6,"br"),ne(7),J(8,"br"),ne(9),J(10,"br"),pe(11,"b"),ne(12,"Logros:"),oe(),J(13,"br"),ne(14),J(15,"br"),oe()()),n&2){let t=e.$implicit;ee(3),mt(t.degree),ee(2),_e(" ",t.fieldOfStudy,""),ee(2),_e(" ",t.institution,""),ee(2),Ts(" ",t.startDate," - ",t.endDate,""),ee(5),_e(" ",t.accomplishments,"")}}var B0=(()=>{class n{constructor(t){this.educationService=t,this.education=[]}ngOnInit(){this.educationService.getEducation().snapshotChanges().subscribe(t=>{this.education=t.map(r=>De({id:r.payload.doc.id},r.payload.doc.data()))})}static{this.\u0275fac=function(r){return new(r||n)(ze(j0))}}static{this.\u0275cmp=it({type:n,selectors:[["app-education"]],decls:1,vars:1,consts:[[4,"ngFor","ngForOf"]],template:function(r,i){r&1&&Ct(0,u1,16,6,"ul",0),r&2&&dt("ngForOf",i.education)},dependencies:[Pt]})}}return n})();var U0=(()=>{class n{constructor(t){this.db=t,this.dbPath="/certificates",this.certificatesRef=t.collection(this.dbPath)}getCertificates(){return this.certificatesRef}static{this.\u0275fac=function(r){return new(r||n)(F(_t))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function d1(n,e){if(n&1&&(pe(0,"ul")(1,"li")(2,"strong"),ne(3),oe(),J(4,"br"),ne(5),J(6,"br"),ne(7),J(8,"br"),ne(9),J(10,"br"),oe()()),n&2){let t=e.$implicit;ee(3),mt(t.name),ee(2),_e(" ",t.issuingOrganization," "),ee(2),_e(" Fecha de emisi\xF3n: ",t.issueDate," "),ee(2),_e(" Fecha de vencimiento: ",t.expirationDate," ")}}var $0=(()=>{class n{constructor(t){this.certificatesService=t,this.certificates=[],this.certificatesService.getCertificates().snapshotChanges().subscribe(r=>{this.certificates=r.map(i=>De({id:i.payload.doc.id},i.payload.doc.data()))})}static{this.\u0275fac=function(r){return new(r||n)(ze(U0))}}static{this.\u0275cmp=it({type:n,selectors:[["app-certificates"]],decls:1,vars:1,consts:[[4,"ngFor","ngForOf"]],template:function(r,i){r&1&&Ct(0,d1,11,4,"ul",0),r&2&&dt("ngForOf",i.certificates)},dependencies:[Pt]})}}return n})();var H0=(()=>{class n{constructor(t){this.db=t,this.dbPath="/languages",this.languagesRef=t.collection(this.dbPath)}getLanguages(){return this.languagesRef}static{this.\u0275fac=function(r){return new(r||n)(F(_t))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function p1(n,e){if(n&1&&(pe(0,"li")(1,"strong"),ne(2),oe(),J(3,"br"),ne(4),J(5,"br"),ne(6),J(7,"br"),oe()),n&2){let t=e.$implicit;ee(2),mt(t.name),ee(2),_e(" Nivel: ",t.proficiency,""),ee(2),_e(" Certificaci\xF3n: ",t.certification,"")}}var q0=(()=>{class n{constructor(t){this.languagesService=t,this.languages=[]}ngOnInit(){this.languagesService.getLanguages().valueChanges().subscribe(t=>{this.languages=t,console.log("Languages:",this.languages)})}static{this.\u0275fac=function(r){return new(r||n)(ze(H0))}}static{this.\u0275cmp=it({type:n,selectors:[["app-languages"]],decls:2,vars:1,consts:[[4,"ngFor","ngForOf"]],template:function(r,i){r&1&&(pe(0,"ul"),Ct(1,p1,8,3,"li",0),oe()),r&2&&(ee(),dt("ngForOf",i.languages))},dependencies:[Pt]})}}return n})();var z0=(()=>{class n{constructor(t){this.db=t,this.dbPath="/interests",this.interestsRef=t.collection(this.dbPath)}getInterests(){return this.interestsRef}static{this.\u0275fac=function(r){return new(r||n)(F(_t))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function y1(n,e){if(n&1&&(pe(0,"li")(1,"strong"),ne(2),oe(),J(3,"br"),ne(4),J(5,"br"),oe()),n&2){let t=e.$implicit;ee(2),mt(t.interestName),ee(2),_e(" ",t.description,"")}}var G0=(()=>{class n{constructor(t){this.interestsService=t,this.interests=[]}ngOnInit(){this.interestsService.getInterests().valueChanges().subscribe(t=>{this.interests=t,console.log("Interests:",this.interests)})}static{this.\u0275fac=function(r){return new(r||n)(ze(z0))}}static{this.\u0275cmp=it({type:n,selectors:[["app-interests"]],decls:2,vars:1,consts:[[4,"ngFor","ngForOf"]],template:function(r,i){r&1&&(pe(0,"ul"),Ct(1,y1,6,2,"li",0),oe()),r&2&&(ee(),dt("ngForOf",i.interests))},dependencies:[Pt]})}}return n})();var W0=(()=>{class n{constructor(){this.title="mycv"}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=it({type:n,selectors:[["app-root"]],decls:19,vars:0,consts:[["border","1"],["colspan","2"]],template:function(r,i){r&1&&(pe(0,"table",0)(1,"tr")(2,"td",1),J(3,"app-header"),oe()(),pe(4,"tr")(5,"td"),J(6,"app-work-experience"),oe(),pe(7,"td"),J(8,"app-skills"),oe()(),pe(9,"tr")(10,"td"),J(11,"app-education"),oe(),pe(12,"td"),J(13,"app-certificates"),oe()(),pe(14,"tr")(15,"td"),J(16,"app-languages"),oe(),pe(17,"td"),J(18,"app-interests"),oe()()())},dependencies:[k0,F0,V0,B0,$0,q0,G0]})}}return n})();var K0={production:!1,firebaseConfig:{apiKey:"AIzaSyDuXr618frg_kQanKLZTnvT28gP-1iHhO4",authDomain:"my-cv-8a9a4.firebaseapp.com",projectId:"my-cv-8a9a4",storageBucket:"my-cv-8a9a4.firebasestorage.app",messagingSenderId:"459014610067",appId:"1:459014610067:web:5d5f8e1af9fdfdfcfb4166"}};var Q0=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=zt({type:n,bootstrap:[W0]})}static{this.\u0275inj=qt({imports:[FI,JI.initializeApp(K0.firebaseConfig)]})}}return n})();OI().bootstrapModule(Q0,{ngZoneEventCoalescing:!0}).catch(n=>console.error(n));
